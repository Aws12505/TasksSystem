import{g as Y,w as De,x as h,ay as hs,R as _,j as e,C as R,c as ee,d as se,U as Ne,B as v,$ as Pe,f as z,K as Le,M as Te,N as Ie,O as Me,P as G,I as ce,a2 as xe,G as Ee,H as ps,J as Fe,at as le,az as de,_ as D,aA as gs,aB as fs,aC as Ue,aD as js,aE as bs,aF as Re,aG as Ns,aH as vs,aI as ze,aJ as ys,aK as Cs,aL as ws,a8 as he,af as Oe,a as ks,b as Ss,o as $e,a7 as me,ax as _s,L as As,ao as Ds,aM as Ve,s as $,aN as Ps,y as Be,ab as ve,E as He,V as Ls,W as Ts,X as Is,Y as ye,aO as Z,v as re,aP as Ms,Q as Es,a0 as Fs,ai as ne,Z as J,S as Ce,z as Us}from"./index-ClQ2iEwo.js";import{B as P}from"./badge-Dke9IkX-.js";import{u as Rs}from"./useTask-BZrgEtIK.js";import{s as O}from"./subtaskService-C6ryjw2F.js";import{a as qe,T as zs}from"./TaskPriorityBadge-CPQEWMl0.js";import{C as we}from"./circle-alert-CWaFpwDu.js";import{C as Ke}from"./checkbox-BpTaUg3p.js";import{P as Os,a as $s,b as ie,c as Vs,d as Bs,e as Hs,f as qs}from"./pagination-D7wuWZvp.js";import{A as We,a as Ge,b as Ye,c as Je,d as Xe,e as Ze,f as Qe,g as es}from"./alert-dialog-BIQUiZYv.js";import{F as Ks,a as H,b as q,c as K,d as W,e as X}from"./form-BWu5y93Z.js";import{E as Ws}from"./ellipsis-B8Lcp3WX.js";import{S as pe}from"./square-pen-DXwq6A3D.js";import{T as ss}from"./trash-2-CmUMwomX.js";import{A as ke}from"./arrow-left-DvYlbdyI.js";import{C as Se}from"./circle-check-CmMcYAKI.js";import{W as Gs}from"./weight-LrrhWAzP.js";import"./label-Bnk25rqI.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ys=[["path",{d:"M4 20h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.93a2 2 0 0 1-1.66-.9l-.82-1.2A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13c0 1.1.9 2 2 2Z",key:"1fr9dc"}],["path",{d:"M8 10v4",key:"tgpxqk"}],["path",{d:"M12 10v2",key:"hh53o1"}],["path",{d:"M16 10v6",key:"1d6xys"}]],Js=Y("folder-kanban",Ys);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xs=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],Zs=Y("info",Xs);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qs=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],_e=Y("layers",Qs);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ea=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],sa=Y("message-square",ea);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aa=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],ta=Y("pen",aa),ra=De((s,r)=>({subtasks:[],currentSubtask:null,pagination:null,taskPagination:{},currentTaskId:null,isLoading:!1,error:null,fetchSubtasksByTask:async(a,t=1)=>{s({isLoading:!0,error:null,currentTaskId:a});try{const n=await O.getSubtasksByTask(a,t);n.success?s(i=>({subtasks:n.data,taskPagination:{...i.taskPagination,[a]:n.pagination||{current_page:1,total:n.data.length,per_page:15,last_page:1,from:n.data.length>0?1:null,to:n.data.length}},pagination:n.pagination||{current_page:1,total:n.data.length,per_page:15,last_page:1,from:n.data.length>0?1:null,to:n.data.length},isLoading:!1})):(s({error:n.message,isLoading:!1}),h.error(n.message))}catch(n){const i=n.message||"Failed to fetch subtasks";s({error:i,isLoading:!1}),h.error(i)}},fetchSubtask:async a=>{s({isLoading:!0,error:null});try{const t=await O.getSubtask(a);t.success?s({currentSubtask:t.data,isLoading:!1}):(s({error:t.message,isLoading:!1}),h.error(t.message))}catch(t){const n=t.message||"Failed to fetch subtask";s({error:n,isLoading:!1}),h.error(n)}},createSubtask:async a=>{s({isLoading:!0,error:null});try{const t=await O.createSubtask(a);return t.success?(s({isLoading:!1}),h.success("Subtask created successfully"),r().fetchSubtasksByTask(a.task_id),t.data):(s({error:t.message,isLoading:!1}),h.error(t.message),null)}catch(t){const n=t.message||"Failed to create subtask";return s({error:n,isLoading:!1}),h.error(n),null}},updateSubtask:async(a,t)=>{s({isLoading:!0,error:null});try{const n=await O.updateSubtask(a,t);return n.success?(s({currentSubtask:n.data,isLoading:!1}),h.success("Subtask updated successfully"),t.task_id&&r().fetchSubtasksByTask(t.task_id),n.data):(s({error:n.message,isLoading:!1}),h.error(n.message),null)}catch(n){const i=n.message||"Failed to update subtask";return s({error:i,isLoading:!1}),h.error(i),null}},updateTaskStatus:async(a,t)=>{try{const n=await hs.updateTaskStatus(a,t);return n.success?(h.success("Task status updated"),n.data):(h.error(n.message),null)}catch(n){return h.error(n.message||"Failed to update task status"),null}},deleteSubtask:async a=>{s({isLoading:!0,error:null});try{const t=await O.deleteSubtask(a);return t.success?(s({isLoading:!1}),h.success("Subtask deleted successfully"),!0):(s({error:t.message,isLoading:!1}),h.error(t.message),!1)}catch(t){const n=t.message||"Failed to delete subtask";return s({error:n,isLoading:!1}),h.error(n),!1}},toggleSubtaskCompletion:async a=>{try{const t=await O.toggleSubtaskCompletion(a);return t.success?(h.success("Subtask completion toggled"),s(n=>({subtasks:n.subtasks.map(i=>i.id===a?t.data:i)})),t.data):(h.error(t.message),null)}catch(t){return h.error(t.message||"Failed to toggle subtask completion"),null}},clearCurrentSubtask:()=>s({currentSubtask:null,error:null})})),as=s=>{const{subtasks:r,pagination:a,taskPagination:t,currentTaskId:n,isLoading:i,error:u,fetchSubtasksByTask:l,createSubtask:c,updateSubtask:f,updateTaskStatus:x,deleteSubtask:N,toggleSubtaskCompletion:y}=ra();_.useEffect(()=>{s&&n!==s&&l(s,1)},[s,n,l]);const p=s?t[s]||null:a,g=A=>{s&&l(s,A)};return{subtasks:r,pagination:p,isLoading:i,error:u,fetchSubtasks:A=>l(A),createSubtask:c,updateSubtask:f,updateTaskStatus:x,deleteSubtask:N,toggleCompletion:y,goToPage:g,nextPage:()=>{p&&p.current_page<p.last_page&&g(p.current_page+1)},prevPage:()=>{p&&p.current_page>1&&g(p.current_page-1)}}},na=({taskWithAssignments:s,availableUsers:r,onAddUser:a,onUpdateAssignment:t,onRemoveUser:n,isLoading:i=!1})=>{const[u,l]=_.useState(!1),[c,f]=_.useState(""),[x,N]=_.useState(10),[y,p]=_.useState(null),[g,j]=_.useState(0);if(!s)return null;const b=s.assigned_users||[],A=b.map(m=>m.id),w=r.filter(m=>!A.includes(m.id)),C=b.reduce((m,F)=>m+(Number(F.pivot?.percentage)||0),0),I=C>=100,k=100-C,M=async()=>{if(!c||x<=0)return;await a(Number(c),x)&&(f(""),N(10),l(!1))},U=(m,F)=>{p(m),j(F)},d=async m=>{g<=0||g>100||(await t(m,g),p(null))},E=()=>{p(null)};return e.jsxs(R,{className:"bg-card border-border w-full",children:[e.jsx(ee,{className:"p-4 pb-3",children:e.jsxs("div",{className:"space-y-2.5",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs(se,{className:"text-foreground flex items-center gap-1.5 text-base",children:[e.jsx(Ne,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:"Assignments"})]}),e.jsx(P,{variant:"secondary",className:"text-xs font-semibold flex-shrink-0",children:b.length})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("span",{className:"text-muted-foreground",children:[C,"%"]}),e.jsxs(P,{variant:C===100?"default":C>100?"destructive":"outline",className:"text-xs h-5",children:[k,"% left"]})]}),e.jsx("div",{className:"w-full bg-muted rounded-full h-1.5 overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full transition-all duration-500 ${C>100?"bg-destructive":C===100?"bg-chart-3":"bg-primary"}`,style:{width:`${Math.min(C,100)}%`}})})]}),w.length>0&&!u&&e.jsxs(v,{size:"sm",onClick:()=>l(!0),className:"w-full h-8 bg-primary text-primary-foreground hover:bg-primary/90",disabled:k<=0,children:[e.jsx(Pe,{className:"w-3.5 h-3.5 mr-1.5"}),"Assign User"]})]})}),e.jsxs(z,{className:"p-4 pt-0 space-y-2.5",children:[u&&e.jsxs("div",{className:"p-3 border border-primary/30 rounded-md bg-primary/5 space-y-2.5",children:[e.jsxs(Le,{value:c,onValueChange:f,children:[e.jsx(Te,{className:"h-8 text-xs bg-background",children:e.jsx(Ie,{placeholder:"Select user"})}),e.jsx(Me,{children:w.map(m=>e.jsx(G,{value:m.id.toString(),className:"text-xs",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium",children:m.name}),e.jsx("span",{className:"text-xs text-muted-foreground truncate",children:m.email})]})},m.id))})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ce,{type:"number",value:x,onChange:m=>N(Number(m.target.value)),min:"1",max:k,className:"h-8 text-xs flex-1",placeholder:"%"}),e.jsx("span",{className:"text-xs text-muted-foreground font-medium",children:"%"})]}),x>k&&k>0&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-destructive",children:[e.jsx(we,{className:"w-3 h-3 flex-shrink-0"}),e.jsxs("span",{children:["Max ",k,"%"]})]}),e.jsxs("div",{className:"flex gap-1.5",children:[e.jsx(v,{size:"sm",onClick:M,disabled:!c||x<=0||x>k,className:"flex-1 h-7 text-xs",children:"Add"}),e.jsx(v,{size:"sm",variant:"outline",onClick:()=>{l(!1),f(""),N(10)},className:"flex-1 h-7 text-xs",children:"Cancel"})]})]}),i?e.jsx("div",{className:"space-y-1.5",children:Array.from({length:2}).map((m,F)=>e.jsx("div",{className:"h-14 bg-muted/50 animate-pulse rounded-md"},F))}):b.length===0?e.jsxs("div",{className:"text-center py-8 px-2",children:[e.jsx("div",{className:"mx-auto w-10 h-10 rounded-full bg-muted flex items-center justify-center mb-2",children:e.jsx(Ne,{className:"w-5 h-5 text-muted-foreground"})}),e.jsx("p",{className:"text-xs font-medium text-foreground",children:"No users assigned"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-0.5",children:"Click above to assign"})]}):e.jsx(xe,{className:"max-h-[350px] pr-2",children:e.jsx("div",{className:"space-y-1.5",children:b.map(m=>e.jsxs("div",{className:"flex items-center gap-2 p-2.5 border border-border rounded-md hover:border-primary/40 hover:bg-accent/20 transition-colors group",children:[e.jsxs(Ee,{className:"w-7 h-7 flex-shrink-0",children:[typeof m.avatar_url=="string"&&m.avatar_url.trim()!==""&&e.jsx(ps,{src:m.avatar_url,alt:m.name||"User"}),e.jsx(Fe,{className:"bg-primary text-primary-foreground text-xs font-semibold",children:m.name?.charAt(0).toUpperCase()||"U"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs font-medium text-foreground truncate leading-tight",children:m.name}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:y===m.id?e.jsx("span",{className:"text-primary",children:"Editing..."}):`${m.pivot.percentage}%`})]}),e.jsx("div",{className:"flex items-center gap-0.5 flex-shrink-0",children:y===m.id?e.jsxs(e.Fragment,{children:[e.jsx(ce,{type:"number",value:g,onChange:F=>j(Number(F.target.value)),min:"1",max:"100",className:"w-12 h-6 text-xs p-1 text-center",autoFocus:!0}),e.jsx(v,{size:"sm",variant:"ghost",onClick:()=>d(m.id),className:"h-6 w-6 p-0 text-chart-3",title:"Save",children:e.jsx(le,{className:"h-3.5 w-3.5"})}),e.jsx(v,{size:"sm",variant:"ghost",onClick:E,className:"h-6 w-6 p-0",title:"Cancel",children:e.jsx(de,{className:"h-3.5 w-3.5"})})]}):e.jsxs(e.Fragment,{children:[e.jsx(v,{size:"sm",variant:"ghost",onClick:()=>U(m.id,m.pivot.percentage),className:"h-6 w-6 p-0 opacity-0 group-hover:opacity-100",title:"Edit percentage",children:e.jsx(ta,{className:"h-3 w-3"})}),e.jsx(v,{size:"sm",variant:"ghost",onClick:()=>n(m.id),className:"h-6 w-6 p-0 text-muted-foreground hover:text-destructive opacity-0 group-hover:opacity-100",title:"Remove",children:e.jsx(de,{className:"h-3.5 w-3.5"})})]})})]},m.id))})}),b.length>0&&e.jsxs("div",{className:"pt-2 space-y-1.5",children:[C>100&&e.jsxs("div",{className:"flex items-start gap-1.5 p-2 bg-destructive/10 border border-destructive/20 rounded-md",children:[e.jsx(we,{className:"w-3.5 h-3.5 text-destructive flex-shrink-0 mt-0.5"}),e.jsxs("p",{className:"text-xs text-destructive leading-tight",children:["Over by ",C-100,"%"]})]}),I&&e.jsxs("div",{className:"flex items-center gap-1.5 p-2 bg-chart-3/10 border border-chart-3/20 rounded-md",children:[e.jsx(le,{className:"w-3.5 h-3.5 text-chart-3 flex-shrink-0"}),e.jsx("p",{className:"text-xs text-chart-3 font-medium",children:"Fully assigned"})]})]})]})]})};var L="Accordion",ia=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[ge,oa,ca]=gs(L),[ae,Ya]=fs(L,[ca,Ue]),fe=Ue(),ts=D.forwardRef((s,r)=>{const{type:a,...t}=s,n=t,i=t;return e.jsx(ge.Provider,{scope:s.__scopeAccordion,children:a==="multiple"?e.jsx(ua,{...i,ref:r}):e.jsx(ma,{...n,ref:r})})});ts.displayName=L;var[rs,la]=ae(L),[ns,da]=ae(L,{collapsible:!1}),ma=D.forwardRef((s,r)=>{const{value:a,defaultValue:t,onValueChange:n=()=>{},collapsible:i=!1,...u}=s,[l,c]=ze({prop:a,defaultProp:t??"",onChange:n,caller:L});return e.jsx(rs,{scope:s.__scopeAccordion,value:D.useMemo(()=>l?[l]:[],[l]),onItemOpen:c,onItemClose:D.useCallback(()=>i&&c(""),[i,c]),children:e.jsx(ns,{scope:s.__scopeAccordion,collapsible:i,children:e.jsx(is,{...u,ref:r})})})}),ua=D.forwardRef((s,r)=>{const{value:a,defaultValue:t,onValueChange:n=()=>{},...i}=s,[u,l]=ze({prop:a,defaultProp:t??[],onChange:n,caller:L}),c=D.useCallback(x=>l((N=[])=>[...N,x]),[l]),f=D.useCallback(x=>l((N=[])=>N.filter(y=>y!==x)),[l]);return e.jsx(rs,{scope:s.__scopeAccordion,value:u,onItemOpen:c,onItemClose:f,children:e.jsx(ns,{scope:s.__scopeAccordion,collapsible:!0,children:e.jsx(is,{...i,ref:r})})})}),[xa,te]=ae(L),is=D.forwardRef((s,r)=>{const{__scopeAccordion:a,disabled:t,dir:n,orientation:i="vertical",...u}=s,l=D.useRef(null),c=ys(l,r),f=oa(a),N=Cs(n)==="ltr",y=ws(s.onKeyDown,p=>{if(!ia.includes(p.key))return;const g=p.target,j=f().filter(d=>!d.ref.current?.disabled),b=j.findIndex(d=>d.ref.current===g),A=j.length;if(b===-1)return;p.preventDefault();let w=b;const C=0,I=A-1,k=()=>{w=b+1,w>I&&(w=C)},M=()=>{w=b-1,w<C&&(w=I)};switch(p.key){case"Home":w=C;break;case"End":w=I;break;case"ArrowRight":i==="horizontal"&&(N?k():M());break;case"ArrowDown":i==="vertical"&&k();break;case"ArrowLeft":i==="horizontal"&&(N?M():k());break;case"ArrowUp":i==="vertical"&&M();break}const U=w%A;j[U].ref.current?.focus()});return e.jsx(xa,{scope:a,disabled:t,direction:n,orientation:i,children:e.jsx(ge.Slot,{scope:a,children:e.jsx(Re.div,{...u,"data-orientation":i,ref:c,onKeyDown:t?void 0:y})})})}),Q="AccordionItem",[ha,je]=ae(Q),os=D.forwardRef((s,r)=>{const{__scopeAccordion:a,value:t,...n}=s,i=te(Q,a),u=la(Q,a),l=fe(a),c=js(),f=t&&u.value.includes(t)||!1,x=i.disabled||s.disabled;return e.jsx(ha,{scope:a,open:f,disabled:x,triggerId:c,children:e.jsx(bs,{"data-orientation":i.orientation,"data-state":xs(f),...l,...n,ref:r,disabled:x,open:f,onOpenChange:N=>{N?u.onItemOpen(t):u.onItemClose(t)}})})});os.displayName=Q;var cs="AccordionHeader",ls=D.forwardRef((s,r)=>{const{__scopeAccordion:a,...t}=s,n=te(L,a),i=je(cs,a);return e.jsx(Re.h3,{"data-orientation":n.orientation,"data-state":xs(i.open),"data-disabled":i.disabled?"":void 0,...t,ref:r})});ls.displayName=cs;var ue="AccordionTrigger",ds=D.forwardRef((s,r)=>{const{__scopeAccordion:a,...t}=s,n=te(L,a),i=je(ue,a),u=da(ue,a),l=fe(a);return e.jsx(ge.ItemSlot,{scope:a,children:e.jsx(Ns,{"aria-disabled":i.open&&!u.collapsible||void 0,"data-orientation":n.orientation,id:i.triggerId,...l,...t,ref:r})})});ds.displayName=ue;var ms="AccordionContent",us=D.forwardRef((s,r)=>{const{__scopeAccordion:a,...t}=s,n=te(L,a),i=je(ms,a),u=fe(a);return e.jsx(vs,{role:"region","aria-labelledby":i.triggerId,"data-orientation":n.orientation,...u,...t,ref:r,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...s.style}})});us.displayName=ms;function xs(s){return s?"open":"closed"}var pa=ts,ga=os,fa=ls,ja=ds,ba=us;function Na({...s}){return e.jsx(pa,{"data-slot":"accordion",...s})}function va({className:s,...r}){return e.jsx(ga,{"data-slot":"accordion-item",className:he("border-b last:border-b-0",s),...r})}function ya({className:s,children:r,...a}){return e.jsx(fa,{className:"flex",children:e.jsxs(ja,{"data-slot":"accordion-trigger",className:he("focus-visible:border-ring focus-visible:ring-ring/50 flex flex-1 items-start justify-between gap-4 rounded-md py-4 text-left text-sm font-medium transition-all outline-none hover:underline focus-visible:ring-[3px] disabled:pointer-events-none disabled:opacity-50 [&[data-state=open]>svg]:rotate-180",s),...a,children:[r,e.jsx(Oe,{className:"text-muted-foreground pointer-events-none size-4 shrink-0 translate-y-0.5 transition-transform duration-200"})]})})}function Ca({className:s,children:r,...a}){return e.jsx(ba,{"data-slot":"accordion-content",className:"data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down overflow-hidden text-sm",...a,children:e.jsx("div",{className:he("pt-0 pb-4",s),children:r})})}const wa=$e({name:$().min(1,"Subtask name is required").max(255),description:$().optional(),due_date:$().min(1,"Due date is required"),priority:Ve(["low","medium","high","critical"]),task_id:Ps()}),ka=$e({name:$().min(1,"Subtask name is required").max(255),description:$().optional(),due_date:$().min(1,"Due date is required"),priority:Ve(["low","medium","high","critical"]),is_complete:Ds().optional()}),Ae=({subtask:s,taskId:r,onSubmit:a,onCancel:t,isLoading:n})=>{const i=!!s,u=ks({resolver:Ss(i?ka:wa),defaultValues:{name:s?.name||"",description:s?.description||"",due_date:s?.due_date?new Date(s.due_date).toISOString().split("T")[0]:"",priority:s?.priority||"medium",is_complete:s?.is_complete||!1,task_id:r}}),l=async c=>{const f={...c,...r&&{task_id:r}};await a(f)};return e.jsx(Ks,{...u,children:e.jsxs("form",{onSubmit:u.handleSubmit(l),className:"space-y-4",children:[e.jsx(H,{control:u.control,name:"name",render:({field:c})=>e.jsxs(q,{children:[e.jsx(K,{className:"text-foreground",children:"Subtask Name"}),e.jsx(W,{children:e.jsx(ce,{placeholder:"Enter subtask name",...c,disabled:n,className:"bg-background border-input text-foreground"})}),e.jsx(X,{className:"text-destructive"})]})}),e.jsx(H,{control:u.control,name:"description",render:({field:c})=>e.jsxs(q,{children:[e.jsx(K,{className:"text-foreground",children:"Description"}),e.jsx(W,{children:e.jsx(me,{placeholder:"Enter subtask description (optional)",...c,disabled:n,className:"bg-background border-input text-foreground",rows:2})}),e.jsx(X,{className:"text-destructive"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(H,{control:u.control,name:"due_date",render:({field:c})=>e.jsxs(q,{children:[e.jsx(K,{className:"text-foreground",children:"Due Date"}),e.jsx(W,{children:e.jsx(_s,{id:"due_date",name:"due_date",value:c.value,onChange:c.onChange,disabled:n,className:"border-input text-foreground",required:!0})}),e.jsx(X,{className:"text-destructive"})]})}),e.jsx(H,{control:u.control,name:"priority",render:({field:c})=>e.jsxs(q,{children:[e.jsx(K,{className:"text-foreground",children:"Priority"}),e.jsxs(Le,{onValueChange:c.onChange,defaultValue:c.value,disabled:n,children:[e.jsx(W,{children:e.jsx(Te,{className:"bg-background border-input text-foreground",children:e.jsx(Ie,{placeholder:"Select priority"})})}),e.jsxs(Me,{children:[e.jsx(G,{value:"low",children:"Low"}),e.jsx(G,{value:"medium",children:"Medium"}),e.jsx(G,{value:"high",children:"High"}),e.jsx(G,{value:"critical",children:"Critical"})]})]}),e.jsx(X,{className:"text-destructive"})]})})]}),i&&e.jsx(H,{control:u.control,name:"is_complete",render:({field:c})=>e.jsxs(q,{className:"flex flex-row items-start space-x-3 space-y-0",children:[e.jsx(W,{children:e.jsx(Ke,{checked:c.value,onCheckedChange:c.onChange,disabled:n})}),e.jsxs("div",{className:"space-y-1 leading-none",children:[e.jsx(K,{className:"text-foreground",children:"Mark as completed"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Check this box if the subtask is completed"})]})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(v,{type:"submit",size:"sm",disabled:n,className:"bg-primary text-primary-foreground hover:bg-primary/90",children:[n&&e.jsx(As,{className:"mr-2 h-3 w-3 animate-spin"}),i?"Update":"Create"]}),e.jsx(v,{type:"button",variant:"outline",size:"sm",onClick:t,disabled:n,children:"Cancel"})]})]})})},Sa=120,_a=({taskId:s})=>{const{subtasks:r,pagination:a,isLoading:t,createSubtask:n,updateSubtask:i,deleteSubtask:u,toggleCompletion:l,goToPage:c,nextPage:f,prevPage:x}=as(s),[N,y]=_.useState(!1),[p,g]=_.useState(null),[j,b]=_.useState(null),{hasPermission:A,hasAnyPermission:w}=Be(),C=async o=>{await n({...o,task_id:s}),y(!1)},I=async o=>{p&&(await i(p.id,o),g(null))},k=async o=>{b(o)},M=async()=>{j!=null&&(await u(j),b(null))},U=async o=>{await l(o)},d=r.filter(o=>o.is_complete).length,E=r.length>0?Math.round(d/r.length*100):0,m=()=>{if(!a)return[];const o=[],{current_page:S,last_page:T}=a;S>3&&(o.push(1),S>4&&o.push("ellipsis-start"));for(let V=Math.max(1,S-2);V<=Math.min(T,S+2);V++)o.push(V);return S<T-2&&(S<T-3&&o.push("ellipsis-end"),o.push(T)),o},F=_.useMemo(()=>{const o=new Map;for(const S of r){const T=(S.description||"").trim().length;o.set(S.id,T>Sa)}return o},[r]),be=a?.total||r.length;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs(R,{className:"bg-card border-border",children:[e.jsxs(ee,{className:"pb-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(se,{className:"text-foreground flex items-center gap-2 text-lg",children:[e.jsx(ve,{className:"w-5 h-5"}),"Subtasks (",be,")"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(P,{variant:"outline",className:"text-xs",children:[d,"/",be," completed"]}),e.jsxs(P,{variant:"secondary",className:"text-xs",children:[E,"%"]}),A("create subtasks")&&e.jsxs(v,{size:"sm",onClick:()=>y(!0),className:"bg-primary text-primary-foreground hover:bg-primary/90",children:[e.jsx(Pe,{className:"w-4 h-4 mr-2"}),"Add Subtask"]})]})]}),r.length>0&&e.jsx("div",{className:"w-full bg-muted rounded-full h-2 mt-2",children:e.jsx("div",{className:"bg-chart-3 h-2 rounded-full transition-all duration-300",style:{width:`${E}%`}})})]}),e.jsxs(z,{className:"p-0",children:[N&&e.jsxs("div",{className:"p-4 border-b border-border bg-accent/20",children:[e.jsx("h4",{className:"text-sm font-medium text-foreground mb-3",children:"Create New Subtask"}),e.jsx(Ae,{taskId:s,onSubmit:C,onCancel:()=>y(!1),isLoading:t})]}),e.jsx(xe,{className:"h-[400px]",children:e.jsx("div",{className:"p-4 space-y-3",children:t?e.jsx("div",{className:"space-y-3",children:Array.from({length:3}).map((o,S)=>e.jsx("div",{className:"h-20 bg-muted animate-pulse rounded-lg"},S))}):r.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ve,{className:"w-12 h-12 text-muted-foreground mx-auto mb-3 opacity-50"}),e.jsx("p",{className:"text-muted-foreground",children:"No subtasks yet."}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Create your first subtask to break down this task."})]}):e.jsx(Na,{type:"single",collapsible:!0,className:"space-y-3",children:r.map(o=>{const S=p?.id===o.id,T=!!F.get(o.id),V=!!(o.description||"").trim();return e.jsx("div",{children:S?e.jsxs("div",{className:"p-4 border border-border rounded-lg bg-accent/20",children:[e.jsx("h4",{className:"text-sm font-medium text-foreground mb-3",children:"Edit Subtask"}),e.jsx(Ae,{subtask:p,taskId:s,onSubmit:I,onCancel:()=>g(null),isLoading:t})]}):e.jsxs(va,{value:String(o.id),className:"border-none",children:[e.jsxs("div",{className:"flex items-start justify-between p-3 border border-border rounded-lg hover:bg-accent/30 transition-colors group",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1 min-w-0",children:[e.jsx(Ke,{checked:o.is_complete,onCheckedChange:()=>U(o.id),className:"mt-1 flex-shrink-0",onClick:B=>B.stopPropagation()}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("h4",{className:`font-medium text-foreground truncate ${o.is_complete?"line-through text-muted-foreground":""}`,children:o.name}),e.jsx(qe,{priority:o.priority})]}),V&&e.jsx("p",{className:`text-sm mt-1 line-clamp-2 ${o.is_complete?"line-through text-muted-foreground":"text-muted-foreground"}`,children:o.description}),e.jsxs("div",{className:"flex items-center gap-3 mt-2 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[e.jsx(He,{className:"w-3 h-3"}),new Date(o.due_date).toLocaleDateString()]}),o.is_complete&&e.jsx(P,{variant:"outline",className:"text-xs text-chart-3",children:"Completed"}),T&&e.jsx("span",{className:"text-xs text-muted-foreground hidden sm:inline",children:"View details"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[T?e.jsxs(ya,{className:`h-8 px-2 rounded-md hover:bg-accent focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring\r
                                               inline-flex items-center gap-1 text-xs text-muted-foreground\r
                                               [&>svg]:hidden`,onClick:B=>B.stopPropagation(),children:[e.jsx("span",{className:"hidden sm:inline",children:"Details"}),e.jsx(Oe,{className:"h-4 w-4"})]}):e.jsx("div",{className:"h-8 w-2"}),w(["edit subtasks","delete subtasks"])&&e.jsxs(Ls,{children:[e.jsx(Ts,{asChild:!0,children:e.jsx(v,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 opacity-0 group-hover:opacity-100 transition-opacity flex-shrink-0",onClick:B=>B.stopPropagation(),children:e.jsx(Ws,{className:"h-4 w-4"})})}),e.jsxs(Is,{align:"end",className:"bg-popover border-border",children:[A("edit subtasks")&&e.jsxs(ye,{onClick:()=>g(o),className:"hover:bg-accent hover:text-accent-foreground",children:[e.jsx(pe,{className:"mr-2 h-4 w-4"}),"Edit"]}),A("delete subtasks")&&e.jsxs(ye,{onClick:()=>k(o.id),className:"text-destructive hover:bg-destructive hover:text-destructive-foreground",children:[e.jsx(ss,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})]})]}),T&&e.jsx(Ca,{className:"pt-2",children:e.jsxs("div",{className:"border border-border rounded-lg bg-accent/20 p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-foreground mb-2",children:[e.jsx(Zs,{className:"w-4 h-4 text-primary"}),"Details"]}),e.jsx("p",{className:"text-sm text-foreground leading-relaxed whitespace-pre-wrap",children:o.description}),e.jsx(Z,{className:"my-3"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(P,{variant:"outline",className:"text-xs",children:["Due:"," ",new Date(o.due_date).toLocaleDateString()]}),e.jsxs(P,{variant:"secondary",className:"text-xs",children:["Priority: ",o.priority]}),e.jsxs(P,{variant:"outline",className:"text-xs",children:["Status:"," ",o.is_complete?"Complete":"Open"]})]})]})})]})},o.id)})})})})]})]}),a&&a.last_page>1&&e.jsx(R,{className:"bg-card border-border",children:e.jsx(z,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",a.from||0," to ",a.to||0," of"," ",a.total," results"]}),e.jsx(Os,{children:e.jsxs($s,{children:[e.jsx(ie,{children:e.jsx(Vs,{onClick:x,className:a.current_page===1?"pointer-events-none opacity-50":"cursor-pointer"})}),m().map((o,S)=>e.jsx(ie,{children:o==="ellipsis-start"||o==="ellipsis-end"?e.jsx(Bs,{}):e.jsx(Hs,{onClick:()=>c(o),isActive:a.current_page===o,className:"cursor-pointer",children:o})},S)),e.jsx(ie,{children:e.jsx(qs,{onClick:f,className:a.current_page===a.last_page?"pointer-events-none opacity-50":"cursor-pointer"})})]})})]})})}),e.jsx(We,{open:j!==null,onOpenChange:o=>!o&&b(null),children:e.jsxs(Ge,{className:"sm:max-w-[480px]",children:[e.jsxs(Ye,{children:[e.jsx(Je,{children:"Delete subtask"}),e.jsx(Xe,{children:"Are you sure you want to delete this subtask? This action cannot be undone."})]}),e.jsxs(Ze,{children:[e.jsx(Qe,{onClick:()=>b(null),children:"Cancel"}),e.jsx(es,{onClick:M,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete"})]})]})})]})};class Aa{async createComment(r,a){return re.post(`tasks/${r}/comments`,a)}async updateComment(r,a){return re.put(`comments/${r}`,a)}async deleteComment(r){return re.delete(`comments/${r}`)}}const oe=new Aa,Da=De(s=>({isLoading:!1,error:null,createComment:async(r,a)=>{s({isLoading:!0,error:null});try{const t=await oe.createComment(r,a);return t.success&&t.data?(s({isLoading:!1}),h.success("Comment added successfully"),t.data):(s({error:t.message||"Failed to create comment",isLoading:!1}),h.error(t.message||"Failed to create comment"),null)}catch(t){const n=t.message||"Failed to create comment";return s({error:n,isLoading:!1}),h.error(n),null}},updateComment:async(r,a)=>{s({isLoading:!0,error:null});try{const t=await oe.updateComment(r,a);return t.success&&t.data?(s({isLoading:!1}),h.success("Comment updated successfully"),t.data):(s({error:t.message||"Failed to update comment",isLoading:!1}),h.error(t.message||"Failed to update comment"),null)}catch(t){const n=t.message||"Failed to update comment";return s({error:n,isLoading:!1}),h.error(n),null}},deleteComment:async r=>{s({isLoading:!0,error:null});try{const a=await oe.deleteComment(r);return a.success?(s({isLoading:!1}),h.success("Comment deleted successfully"),!0):(s({error:a.message||"Failed to delete comment",isLoading:!1}),h.error(a.message||"Failed to delete comment"),!1)}catch(a){const t=a.message||"Failed to delete comment";return s({error:t,isLoading:!1}),h.error(t),!1}}})),Pa=s=>{const{isLoading:r,error:a,createComment:t,updateComment:n,deleteComment:i}=Da(),{currentTask:u,fetchTask:l}=Ms(),{user:c}=Es();return{comments:u?.comments||[],isLoading:r,error:a,createComment:async g=>{const j=await t(s,{content:g});return j&&await l(s),j},updateComment:async(g,j)=>{const b=await n(g,{content:j});return b&&await l(s),b},deleteComment:async g=>{const j=await i(g);return j&&await l(s),j},canModifyComment:g=>c?!!(g.user_id===c.id||c.permissions?.some(j=>j.name==="create tasks")):!1}},La=({taskId:s})=>{const{comments:r,isLoading:a,createComment:t,updateComment:n,deleteComment:i,canModifyComment:u}=Pa(s),[l,c]=_.useState(""),[f,x]=_.useState(null),[N,y]=_.useState(""),[p,g]=_.useState(!1),[j,b]=_.useState(null),A=async()=>{if(!l.trim())return;await t(l)&&c("")},w=d=>{x(d.id),y(d.content)},C=async d=>{if(!N.trim())return;await n(d,N)&&(x(null),y(""))},I=()=>{x(null),y("")},k=d=>{b(d),g(!0)},M=async()=>{j!==null&&(await i(j),g(!1),b(null))},U=()=>{g(!1),b(null)};return e.jsxs(e.Fragment,{children:[e.jsxs(R,{className:"bg-card border-border",children:[e.jsx(ee,{children:e.jsxs(se,{className:"text-foreground flex items-center gap-2",children:[e.jsx(sa,{className:"w-5 h-5"}),"Comments",e.jsx(P,{variant:"secondary",className:"text-xs",children:r.length})]})}),e.jsxs(z,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(me,{placeholder:"Add a comment...",value:l,onChange:d=>c(d.target.value),disabled:a,rows:3,className:"bg-background border-input text-foreground"}),e.jsx("div",{className:"flex justify-end",children:e.jsx(v,{onClick:A,disabled:a||!l.trim(),className:"bg-primary text-primary-foreground hover:bg-primary/90",children:"Add Comment"})})]}),e.jsx(xe,{className:"h-[400px]",children:e.jsx("div",{className:"space-y-4 pr-4",children:a&&r.length===0?e.jsx("div",{className:"space-y-3",children:Array.from({length:2}).map((d,E)=>e.jsx("div",{className:"h-24 bg-muted animate-pulse rounded-lg"},E))}):r.length===0?e.jsx("p",{className:"text-muted-foreground text-center py-8",children:"No comments yet. Be the first to comment!"}):r.map(d=>e.jsx("div",{className:"p-4 border border-border rounded-lg bg-accent/20",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Ee,{className:"w-8 h-8 flex-shrink-0",children:e.jsx(Fe,{className:"bg-primary text-primary-foreground text-xs",children:d.user?.name?.charAt(0).toUpperCase()||"U"})}),e.jsxs("div",{className:"flex-1 space-y-2 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"font-medium text-foreground text-sm",children:d.user?.name||"Unknown"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:new Date(d.created_at).toLocaleString()})]}),u(d)&&e.jsx("div",{className:"flex items-center gap-1",children:f===d.id?e.jsxs(e.Fragment,{children:[e.jsx(v,{size:"sm",variant:"ghost",onClick:()=>C(d.id),className:"h-8 w-8 p-0",title:"Save",children:e.jsx(le,{className:"h-4 w-4"})}),e.jsx(v,{size:"sm",variant:"ghost",onClick:I,className:"h-8 w-8 p-0",title:"Cancel",children:e.jsx(de,{className:"h-4 w-4"})})]}):e.jsxs(e.Fragment,{children:[e.jsx(v,{size:"sm",variant:"ghost",onClick:()=>w(d),className:"h-8 w-8 p-0",title:"Edit",children:e.jsx(pe,{className:"h-4 w-4"})}),e.jsx(v,{size:"sm",variant:"ghost",onClick:()=>k(d.id),className:"h-8 w-8 p-0 text-destructive hover:bg-destructive hover:text-destructive-foreground",title:"Delete",children:e.jsx(ss,{className:"h-4 w-4"})})]})})]}),f===d.id?e.jsx(me,{value:N,onChange:E=>y(E.target.value),rows:3,className:"bg-background border-input text-foreground"}):e.jsx("p",{className:"text-foreground whitespace-pre-wrap break-words",children:d.content}),d.updated_at!==d.created_at&&f!==d.id&&e.jsxs("p",{className:"text-xs text-muted-foreground italic",children:["Edited ",new Date(d.updated_at).toLocaleString()]})]})]})},d.id))})})]})]}),e.jsx(We,{open:p,onOpenChange:g,children:e.jsxs(Ge,{className:"sm:max-w-[425px]",children:[e.jsxs(Ye,{children:[e.jsx(Je,{children:"Delete Comment"}),e.jsx(Xe,{children:"Are you sure you want to delete this comment? This action cannot be undone."})]}),e.jsxs(Ze,{children:[e.jsx(Qe,{onClick:U,children:"Cancel"}),e.jsx(es,{onClick:M,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete"})]})]})})]})},Ja=()=>{const{id:s}=Fs(),{task:r,taskWithAssignments:a,availableUsers:t,isLoading:n,error:i,addUser:u,updateAssignment:l,removeUser:c}=Rs(s),{updateTaskStatus:f}=as(),{hasPermission:x,hasAnyPermission:N}=Be(),y=async p=>{!r||!x("edit tasks")||await f(r.id,{status:p})};return n?e.jsx("div",{className:"min-h-screen bg-background",children:e.jsxs("div",{className:"container mx-auto max-w-[1600px] p-4 md:p-6 lg:p-8 space-y-6",children:[e.jsx("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4 bg-card/50 backdrop-blur-sm border border-border rounded-xl p-4 lg:p-6",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-3 bg-primary/10 rounded-xl animate-pulse",children:e.jsx("div",{className:"w-7 h-7 bg-primary/20 rounded"})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"h-8 bg-muted animate-pulse rounded w-64"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"h-6 bg-muted animate-pulse rounded w-20"}),e.jsx("div",{className:"h-6 bg-muted animate-pulse rounded w-20"})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"xl:col-span-1 space-y-4",children:[e.jsx("div",{className:"h-96 bg-card/50 border border-border animate-pulse rounded-xl"}),e.jsx("div",{className:"h-64 bg-card/50 border border-border animate-pulse rounded-xl"})]}),e.jsxs("div",{className:"xl:col-span-3 space-y-4",children:[e.jsx("div",{className:"h-[500px] bg-card/50 border border-border animate-pulse rounded-xl"}),e.jsx("div",{className:"h-96 bg-card/50 border border-border animate-pulse rounded-xl"})]})]})]})}):i||!r?e.jsx("div",{className:"min-h-screen bg-background",children:e.jsx("div",{className:"container mx-auto max-w-[1600px] p-4 md:p-6 lg:p-8",children:e.jsx(R,{className:"bg-card border-border",children:e.jsxs(z,{className:"p-12 text-center",children:[e.jsx("div",{className:"mx-auto w-16 h-16 rounded-full bg-destructive/10 flex items-center justify-center mb-4",children:e.jsx(ne,{className:"w-8 h-8 text-destructive"})}),e.jsx("h2",{className:"text-xl font-semibold text-foreground mb-2",children:"Task Not Found"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:i||"The task you are looking for does not exist."}),e.jsx(v,{asChild:!0,variant:"outline",children:e.jsxs(J,{to:"/tasks",children:[e.jsx(ke,{className:"mr-2 h-4 w-4"}),"Back to Tasks"]})})]})})})}):e.jsx("div",{className:"min-h-screen bg-background",children:e.jsxs("div",{className:"container mx-auto max-w-[1600px] p-4 md:p-6 lg:p-8 space-y-6",children:[e.jsx("div",{className:"bg-card/50 backdrop-blur-sm border border-border rounded-xl p-4 lg:p-6 shadow-sm",children:e.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-3 bg-primary/10 rounded-xl flex-shrink-0",children:e.jsx(ne,{className:"w-7 h-7 text-primary"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h1",{className:"text-2xl lg:text-3xl font-bold text-foreground leading-tight",children:r.name}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx(zs,{status:r.status}),e.jsx(qe,{priority:r.priority}),r.latest_final_rating&&e.jsxs(P,{variant:"outline",className:"bg-amber-500/10 text-amber-600 border-amber-500/20",children:[e.jsx(Ce,{className:"w-3 h-3 mr-1 fill-current"}),r.latest_final_rating]})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[x("view tasks")&&e.jsxs(e.Fragment,{children:[e.jsxs(v,{variant:"outline",size:"sm",onClick:()=>y("in_progress"),disabled:r.status==="in_progress"||r.status==="rated",className:"hover:bg-primary/10 hover:text-primary",children:[e.jsx(Us,{className:"mr-2 h-4 w-4"}),"In Progress"]}),e.jsxs(v,{variant:"outline",size:"sm",onClick:()=>y("done"),disabled:r.status==="done"||r.status==="rated",className:"hover:bg-chart-3/10 hover:text-chart-3",children:[e.jsx(Se,{className:"mr-2 h-4 w-4"}),"Complete"]})]}),x("edit tasks")&&e.jsx(v,{asChild:!0,size:"sm",className:"bg-primary text-primary-foreground hover:bg-primary/90",children:e.jsxs(J,{to:`/tasks/${r.id}/edit`,children:[e.jsx(pe,{className:"mr-2 h-4 w-4"}),"Edit"]})}),N(["create task ratings","edit task ratings"])&&e.jsx(v,{asChild:!0,variant:"outline",size:"sm",children:e.jsxs(J,{to:`/ratings/tasks/${r.id}`,children:[e.jsx(Ce,{className:"mr-2 h-4 w-4"}),"Rate"]})}),e.jsx(v,{variant:"outline",size:"sm",asChild:!0,children:e.jsxs(J,{to:"/tasks",children:[e.jsx(ke,{className:"mr-2 h-4 w-4"}),"Back"]})})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"xl:col-span-1 space-y-4",children:[e.jsxs(R,{className:"bg-card border-border shadow-sm hover:shadow-md transition-shadow",children:[e.jsx(ee,{className:"pb-3",children:e.jsxs(se,{className:"text-foreground flex items-center gap-2 text-base",children:[e.jsx(ne,{className:"w-4 h-4 text-primary"}),"Task Information"]})}),e.jsxs(z,{className:"space-y-4 text-sm",children:[r.description&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wide mb-2",children:"Description"}),e.jsx("p",{className:"text-foreground leading-relaxed",children:r.description})]}),e.jsx(Z,{})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wide mb-2",children:"Location"}),e.jsx("div",{className:"space-y-2",children:e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-accent/50 rounded-lg",children:[e.jsx(Js,{className:"w-4 h-4 text-primary flex-shrink-0"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"font-medium text-foreground truncate",children:r.section?.project?.name||"Unknown Project"}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:r.section?.name||"Unknown Section"})]})]})})]}),e.jsx(Z,{}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"p-3 bg-accent/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Gs,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("p",{className:"text-xs font-medium text-muted-foreground",children:"Weight"})]}),e.jsx(P,{variant:"outline",className:"text-sm font-semibold",children:r.weight})]}),e.jsxs("div",{className:"p-3 bg-accent/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(_e,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("p",{className:"text-xs font-medium text-muted-foreground",children:"Subtasks"})]}),e.jsx(P,{variant:"secondary",className:"text-sm font-semibold",children:r.subtasks?.length||0})]})]}),e.jsx(Z,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-3 p-2 bg-accent/50 rounded-lg",children:[e.jsx(He,{className:"w-4 h-4 text-primary flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground mb-0.5",children:"Due Date"}),e.jsx("p",{className:"text-sm font-medium text-foreground",children:new Date(r.due_date).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})]})]}),r.completed_at&&e.jsxs("div",{className:"flex items-start gap-3 p-2 bg-chart-3/10 border border-chart-3/20 rounded-lg",children:[e.jsx(Se,{className:"w-4 h-4 text-chart-3 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground mb-0.5",children:"Completed"}),e.jsx("p",{className:"text-sm font-medium text-chart-3",children:new Date(r.completed_at).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})]})]})]})]})]}),x("edit tasks")&&e.jsx(na,{taskWithAssignments:a,availableUsers:t,onAddUser:u,onUpdateAssignment:l,onRemoveUser:c,isLoading:n})]}),e.jsxs("div",{className:"xl:col-span-3 space-y-4",children:[x("view subtasks")?e.jsx(_a,{taskId:r.id}):e.jsx(R,{className:"bg-card border-border shadow-sm",children:e.jsxs(z,{className:"p-12 text-center",children:[e.jsx("div",{className:"mx-auto w-12 h-12 rounded-full bg-muted flex items-center justify-center mb-3",children:e.jsx(_e,{className:"w-6 h-6 text-muted-foreground"})}),e.jsx("p",{className:"text-sm font-medium text-foreground mb-1",children:"Subtasks Hidden"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"You don't have permission to view subtasks"})]})}),e.jsx(La,{taskId:r.id})]})]})]})})};export{Ja as default};
