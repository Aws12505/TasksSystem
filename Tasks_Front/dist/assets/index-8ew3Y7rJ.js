import{q as T,j as e,D as E,v as I,B as _,w as F,x as m,y as j,K as L,m as h,p as V,I as B,M as K,N as $,O as H,P as Q,Q as u}from"./index-DbgasQnk.js";import{C as o,d as i,a as b,b as v}from"./card-Xp-DmDqu.js";import{P as R,a as U,b as C,c as q,d as O,e as z,f as G}from"./pagination-BbxA-L1o.js";import{u as J}from"./useProjects-BGfS-DVw.js";import{u as W}from"./filtersStore-BL-xP6lG.js";import{T as X,a as Y,b as A,c as d,d as Z,e as x}from"./table-Bcm549Kx.js";import{A as ee,a as se}from"./avatar-B3hMhWxO.js";import{P as re}from"./progress-Bu9cm17y.js";import{P as ae,K as te}from"./ProjectStatusBadge-ClZT-63P.js";import{E as ne}from"./ellipsis-8eW3OsYh.js";import{E as le}from"./eye-Bh3t4P3-.js";import{S as ce}from"./square-pen-DTaksrQb.js";import{T as oe}from"./trash-2-DizQIRMl.js";import{P as ie}from"./plus-Lx9ZfKYP.js";import"./index-Boy86C_w.js";import"./badge-CldAO_QU.js";const de=({projects:t,isLoading:a,onDelete:w})=>{const{hasPermission:c}=T();return a?e.jsx("div",{className:"space-y-4",children:Array.from({length:5}).map((r,l)=>e.jsx("div",{className:"h-16 bg-muted animate-pulse rounded-lg"},l))}):t.length===0?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-muted-foreground",children:"No projects found"})}):e.jsx("div",{className:"border border-border rounded-lg bg-card",children:e.jsxs(X,{children:[e.jsx(Y,{children:e.jsxs(A,{className:"border-border",children:[e.jsx(d,{className:"text-foreground",children:"Project"}),e.jsx(d,{className:"text-foreground",children:"Stakeholder"}),e.jsx(d,{className:"text-foreground",children:"Status"}),e.jsx(d,{className:"text-foreground",children:"Progress"}),e.jsx(d,{className:"text-foreground",children:"Created"}),e.jsx(d,{className:"text-foreground w-[50px]",children:"Actions"})]})}),e.jsx(Z,{children:t.map(r=>{const l=c("view projects"),g=c("edit projects"),p=c("delete projects"),f=c("view analytics"),y=l||g||p||f;return e.jsxs(A,{className:"border-border hover:bg-accent/50",children:[e.jsx(x,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:r.name}),r.description&&e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-1",children:r.description})]})}),e.jsx(x,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ee,{className:"w-6 h-6",children:e.jsx(se,{className:"bg-primary text-primary-foreground text-xs",children:r.stakeholder?.name?.charAt(0).toUpperCase()||"U"})}),e.jsx("span",{className:"text-sm text-foreground",children:r.stakeholder?.name||"Unassigned"})]})}),e.jsx(x,{children:e.jsx(ae,{status:r.status})}),e.jsx(x,{className:"w-32",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(re,{value:r.progress_percentage,className:"flex-1"}),e.jsxs("span",{className:"text-xs text-muted-foreground min-w-[3ch]",children:[r.progress_percentage,"%"]})]})}),e.jsx(x,{className:"text-muted-foreground",children:new Date(r.created_at).toLocaleDateString()}),e.jsx(x,{children:y?e.jsxs(E,{children:[e.jsx(I,{asChild:!0,children:e.jsx(_,{variant:"ghost",className:"h-8 w-8 p-0 hover:bg-accent",children:e.jsx(ne,{className:"h-4 w-4"})})}),e.jsxs(F,{align:"end",className:"bg-popover border-border",children:[l&&e.jsx(m,{asChild:!0,className:"hover:bg-accent hover:text-accent-foreground",children:e.jsxs(j,{to:`/projects/${r.id}`,className:"flex items-center",children:[e.jsx(le,{className:"mr-2 h-4 w-4"}),"View"]})}),f&&e.jsx(m,{asChild:!0,className:"hover:bg-accent hover:text-accent-foreground",children:e.jsxs(j,{to:`/analytics/projects/${r.id}`,className:"flex items-center",children:[e.jsx(L,{className:"mr-2 h-4 w-4"}),"Analytics"]})}),l&&e.jsx(m,{asChild:!0,className:"hover:bg-accent hover:text-accent-foreground",children:e.jsxs(j,{to:`/projects/${r.id}/kanban`,className:"flex items-center",children:[e.jsx(te,{className:"mr-2 h-4 w-4"}),"Kanban"]})}),g&&e.jsx(m,{asChild:!0,className:"hover:bg-accent hover:text-accent-foreground",children:e.jsxs(j,{to:`/projects/${r.id}/edit`,className:"flex items-center",children:[e.jsx(ce,{className:"mr-2 h-4 w-4"}),"Edit"]})}),p&&e.jsxs(m,{onClick:()=>w(r.id),className:"text-destructive hover:bg-destructive hover:text-destructive-foreground",children:[e.jsx(oe,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]}):e.jsx("span",{className:"text-muted-foreground text-xs",children:"No actions"})})]},r.id)})})]})})},Ae=()=>{const{projects:t,pagination:a,isLoading:w,deleteProject:c,goToPage:r,nextPage:l,prevPage:g}=J(),{searchQuery:p,statusFilter:f,setSearchQuery:y,setStatusFilter:k}=W(),{hasPermission:S}=T(),D=async s=>{S("delete projects")&&window.confirm("Are you sure you want to delete this project?")&&await c(s)},M=()=>{if(!a)return[];const s=[],{current_page:n,last_page:N}=a;n>3&&(s.push(1),n>4&&s.push("ellipsis-start"));for(let P=Math.max(1,n-2);P<=Math.min(N,n+2);P++)s.push(P);return n<N-2&&(n<N-3&&s.push("ellipsis-end"),s.push(N)),s};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(h,{className:"w-6 h-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground font-sans",children:"Projects"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your projects and track progress"})]})]}),S("create projects")&&e.jsx(_,{asChild:!0,className:"bg-primary text-primary-foreground hover:bg-primary/90",children:e.jsxs(j,{to:"/projects/create",children:[e.jsx(ie,{className:"mr-2 h-4 w-4"}),"New Project"]})})]}),e.jsx(o,{className:"bg-card border-border",children:e.jsx(i,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1 max-w-sm",children:[e.jsx(V,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(B,{placeholder:"Search projects...",value:p,onChange:s=>y(s.target.value),className:"pl-10 bg-background border-input text-foreground"})]}),e.jsxs(K,{value:f,onValueChange:k,children:[e.jsx($,{className:"w-48",children:e.jsx(H,{placeholder:"Filter by status"})}),e.jsxs(Q,{children:[e.jsx(u,{value:"all",children:"All Status"}),e.jsx(u,{value:"pending",children:"Pending"}),e.jsx(u,{value:"in_progress",children:"In Progress"}),e.jsx(u,{value:"done",children:"Done"}),e.jsx(u,{value:"rated",children:"Rated"})]})]})]})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs(o,{className:"bg-card border-border",children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(v,{className:"text-sm font-medium text-muted-foreground",children:"Total Projects"}),e.jsx(h,{className:"w-4 h-4 text-chart-1"})]}),e.jsx(i,{children:e.jsx("div",{className:"text-2xl font-bold text-foreground",children:a?.total||t.length})})]}),e.jsxs(o,{className:"bg-card border-border",children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(v,{className:"text-sm font-medium text-muted-foreground",children:"In Progress"}),e.jsx(h,{className:"w-4 h-4 text-chart-2"})]}),e.jsx(i,{children:e.jsx("div",{className:"text-2xl font-bold text-foreground",children:t.filter(s=>s.status==="in_progress").length})})]}),e.jsxs(o,{className:"bg-card border-border",children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(v,{className:"text-sm font-medium text-muted-foreground",children:"Completed"}),e.jsx(h,{className:"w-4 h-4 text-chart-3"})]}),e.jsx(i,{children:e.jsx("div",{className:"text-2xl font-bold text-foreground",children:t.filter(s=>s.status==="done").length})})]}),e.jsxs(o,{className:"bg-card border-border",children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(v,{className:"text-sm font-medium text-muted-foreground",children:"Avg Progress"}),e.jsx(h,{className:"w-4 h-4 text-chart-4"})]}),e.jsx(i,{children:e.jsxs("div",{className:"text-2xl font-bold text-foreground",children:[t.length>0?Math.round(t.reduce((s,n)=>s+n.progress_percentage,0)/t.length):0,"%"]})})]})]}),e.jsx(de,{projects:t,isLoading:w,onDelete:D}),a&&a.last_page>1&&e.jsx(o,{className:"bg-card border-border",children:e.jsx(i,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",a.from||0," to ",a.to||0," of ",a.total," results"]}),e.jsx(R,{children:e.jsxs(U,{children:[e.jsx(C,{children:e.jsx(q,{onClick:g,className:a.current_page===1?"pointer-events-none opacity-50":"cursor-pointer"})}),M().map((s,n)=>e.jsx(C,{children:s==="ellipsis-start"||s==="ellipsis-end"?e.jsx(O,{}):e.jsx(z,{onClick:()=>r(s),isActive:a.current_page===s,className:"cursor-pointer",children:s})},n)),e.jsx(C,{children:e.jsx(G,{onClick:l,className:a.current_page===a.last_page?"pointer-events-none opacity-50":"cursor-pointer"})})]})})]})})})]})};export{Ae as default};
