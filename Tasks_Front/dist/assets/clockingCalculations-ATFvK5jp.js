import{g as d,h as n,i as g,t as o}from"./index-DhfIzlYp.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u=[["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M14 2v2",key:"6buw04"}],["path",{d:"M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1",key:"pwadti"}],["path",{d:"M6 2v2",key:"colzsn"}]],f=d("coffee",u);class p{async getInitialData(){return n.get("/clocking/initial-data")}async clockIn(){return n.post("/clocking/clock-in")}async clockOut(){return n.post("/clocking/clock-out")}async startBreak(){return n.post("/clocking/break/start")}async endBreak(s){return n.post("/clocking/break/end",s)}async getRecords(s){return n.getPaginated("/clocking/records",s)}async exportRecords(s){return n.post("/clocking/export",s)}async getManagerInitialData(){return n.get("/clocking/manager/initial-data")}async getAllRecords(s){return n.getPaginated("/clocking/manager/all-records",s)}async exportAllRecords(s){return n.post("/clocking/manager/export-all",s)}}const t=new p,k=g((r,s)=>({session:null,companyTimezone:"UTC",serverTimeUtc:"",records:[],recordsPagination:null,managerSessions:[],managerAllRecords:[],managerAllRecordsPagination:null,isLoading:!1,isExporting:!1,error:null,fetchInitialData:async()=>{try{const a=await t.getInitialData();a.success&&r({session:a.data.session,companyTimezone:a.data.company_timezone,serverTimeUtc:a.data.server_time_utc})}catch(a){console.error("Failed to fetch initial data:",a)}},updateSession:a=>{r({session:a.session,companyTimezone:a.company_timezone,serverTimeUtc:a.server_time_utc})},clockIn:async()=>{r({isLoading:!0,error:null});try{const a=await t.clockIn();a.success&&(o.success(a.message),s().updateSession(a.data))}catch(a){const e=a.response?.data?.message||"Failed to clock in";r({error:e}),o.error(e)}finally{r({isLoading:!1})}},clockOut:async()=>{r({isLoading:!0,error:null});try{const a=await t.clockOut();a.success&&(o.success(a.message),s().updateSession(a.data))}catch(a){const e=a.response?.data?.message||"Failed to clock out";r({error:e}),o.error(e)}finally{r({isLoading:!1})}},startBreak:async()=>{r({isLoading:!0,error:null});try{const a=await t.startBreak();a.success&&(o.success(a.message),s().updateSession(a.data))}catch(a){const e=a.response?.data?.message||"Failed to start break";r({error:e}),o.error(e)}finally{r({isLoading:!1})}},endBreak:async a=>{r({isLoading:!0,error:null});try{const e=await t.endBreak(a?{description:a}:void 0);e.success&&(o.success(e.message),s().updateSession(e.data))}catch(e){const c=e.response?.data?.message||"Failed to end break";r({error:c}),o.error(c)}finally{r({isLoading:!1})}},fetchRecords:async a=>{r({isLoading:!0,error:null});try{const e=await t.getRecords(a);e.success&&r({records:e.data,recordsPagination:e.pagination})}catch(e){const c=e.response?.data?.message||"Failed to fetch records";r({error:c}),o.error(c)}finally{r({isLoading:!1})}},exportRecords:async a=>{r({isExporting:!0});try{const e=await t.exportRecords(a);e.success&&(window.open(e.data.download_url,"_blank"),o.success(e.message))}catch(e){o.error(e.response?.data?.message||"Export failed")}finally{r({isExporting:!1})}},fetchManagerInitialData:async()=>{r({isLoading:!0});try{const a=await t.getManagerInitialData();a.success&&r({managerSessions:a.data.sessions,companyTimezone:a.data.company_timezone,serverTimeUtc:a.data.server_time_utc})}catch(a){console.error("Failed to fetch manager data:",a)}finally{r({isLoading:!1})}},updateManagerSession:(a,e)=>{r(c=>({managerSessions:c.managerSessions.map(i=>i.session?.user_id===a?e:i)}))},fetchManagerAllRecords:async a=>{r({isLoading:!0});try{const e=await t.getAllRecords(a);e.success&&r({managerAllRecords:e.data,managerAllRecordsPagination:e.pagination})}catch(e){console.error("Failed to fetch all records:",e)}finally{r({isLoading:!1})}},exportManagerRecords:async a=>{r({isExporting:!0});try{const e=await t.exportAllRecords(a);e.success&&(window.open(e.data.download_url,"_blank"),o.success(e.message))}catch(e){o.error(e.response?.data?.message||"Export failed")}finally{r({isExporting:!1})}},clearError:()=>r({error:null})})),l=(r,s)=>{const a=new Date(r).getTime(),e=s?new Date(s).getTime():Date.now();return Math.floor((e-a)/1e3)},m=r=>r.reduce((s,a)=>s+l(a.break_start_utc,a.break_end_utc),0),h=(r,s,a)=>{const e=l(r,s),c=m(a);return Math.max(0,e-c)},w=r=>{const s=Math.floor(r/3600),a=Math.floor(r%3600/60),e=r%60;return`${String(s).padStart(2,"0")}:${String(a).padStart(2,"0")}:${String(e).padStart(2,"0")}`},S=(r,s)=>new Date(r).toLocaleString("en-US",{timeZone:s,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1});export{f as C,l as a,h as b,S as c,m as d,w as f,k as u};
