import{q as E,j as e,D as R,v as H,B as _,w as V,x as i,y as w,T as k,p as F,I as Q}from"./index-C2FMqJ1N.js";import{C as m,d as x,a as f,b as p}from"./card-Cp0xe702.js";import{T as $,a as O,b as A,c as U}from"./tabs-Bi8-Sl-h.js";import{u as X}from"./useTickets-B4JiTTnB.js";import{u as z}from"./filtersStore-CymZsb_f.js";import{T as G,a as J,b as D,c as n,d as K,e as l}from"./table-p59RNBMI.js";import{A as P,a as B}from"./avatar-CIyCCwmM.js";import{B as W}from"./badge-rMA5ZzkR.js";import{T as Y,a as Z,b as ee}from"./TicketPriorityBadge-D9DCGD1R.js";import{E as se}from"./ellipsis-Br7MXmjH.js";import{E as re}from"./eye-CSsCin7R.js";import{S as ae}from"./square-pen-C7dy-o9l.js";import{U as te,a as ne}from"./user-x-D0Par4gr.js";import{C as le}from"./circle-check-big-mnU2iT_r.js";import{T as ce}from"./trash-2-Q4nOQ0Bd.js";import{P as ie}from"./plus-CEN3jICz.js";import{C as oe}from"./circle-alert-CSSPFpmT.js";import{C as de}from"./clock-DRvA1-Wb.js";import{C as me}from"./circle-check-DIlVSSL9.js";import"./ticketsStore-BNZo-zpv.js";import"./index-DjEDu1ci.js";const S=({tickets:t,isLoading:h,onDelete:u,onClaim:N,onComplete:b,onUnassign:v,showActions:j=!0})=>{const{hasPermission:o}=E();return h?e.jsx("div",{className:"space-y-4",children:Array.from({length:5}).map((s,c)=>e.jsx("div",{className:"h-16 bg-muted animate-pulse rounded-lg"},c))}):t.length===0?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-muted-foreground",children:"No tickets found"})}):e.jsx("div",{className:"border border-border rounded-lg bg-card",children:e.jsxs(G,{children:[e.jsx(J,{children:e.jsxs(D,{className:"border-border",children:[e.jsx(n,{className:"text-foreground",children:"Title"}),e.jsx(n,{className:"text-foreground",children:"Type"}),e.jsx(n,{className:"text-foreground",children:"Status"}),e.jsx(n,{className:"text-foreground",children:"Priority"}),e.jsx(n,{className:"text-foreground",children:"Requester"}),e.jsx(n,{className:"text-foreground",children:"Assignee"}),e.jsx(n,{className:"text-foreground",children:"Created"}),j&&e.jsx(n,{className:"text-foreground w-[50px]",children:"Actions"})]})}),e.jsx(K,{children:t.map(s=>{const c=o("view tickets"),a=o("edit tickets"),d=o("delete tickets"),g=c||a||d;return e.jsxs(D,{className:"border-border hover:bg-accent/50",children:[e.jsx(l,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:s.title}),e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-2",children:s.description})]})}),e.jsx(l,{children:e.jsx(Y,{type:s.type})}),e.jsx(l,{children:e.jsx(Z,{status:s.status})}),e.jsx(l,{children:e.jsx(ee,{priority:s.priority})}),e.jsx(l,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(P,{className:"w-6 h-6",children:e.jsx(B,{className:"bg-primary text-primary-foreground text-xs",children:s.requester?.name?.charAt(0).toUpperCase()||"U"})}),e.jsx("span",{className:"text-sm text-foreground",children:s.requester?.name||"Unknown User"})]})}),e.jsx(l,{children:s.assignee?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(P,{className:"w-6 h-6",children:e.jsx(B,{className:"bg-chart-2 text-white text-xs",children:s.assignee.name?.charAt(0).toUpperCase()||"A"})}),e.jsx("span",{className:"text-sm text-foreground",children:s.assignee.name})]}):e.jsx(W,{variant:"outline",className:"text-xs",children:"Unassigned"})}),e.jsx(l,{className:"text-muted-foreground",children:new Date(s.created_at).toLocaleDateString()}),j&&e.jsx(l,{children:g?e.jsxs(R,{children:[e.jsx(H,{asChild:!0,children:e.jsx(_,{variant:"ghost",className:"h-8 w-8 p-0 hover:bg-accent",children:e.jsx(se,{className:"h-4 w-4"})})}),e.jsxs(V,{align:"end",className:"bg-popover border-border",children:[c&&e.jsx(i,{asChild:!0,className:"hover:bg-accent hover:text-accent-foreground",children:e.jsxs(w,{to:`/tickets/${s.id}`,className:"flex items-center",children:[e.jsx(re,{className:"mr-2 h-4 w-4"}),"View"]})}),a&&e.jsx(i,{asChild:!0,className:"hover:bg-accent hover:text-accent-foreground",children:e.jsxs(w,{to:`/tickets/${s.id}/edit`,className:"flex items-center",children:[e.jsx(ae,{className:"mr-2 h-4 w-4"}),"Edit"]})}),a&&s.is_available&&e.jsxs(i,{onClick:()=>N(s.id),className:"hover:bg-accent hover:text-accent-foreground",children:[e.jsx(te,{className:"mr-2 h-4 w-4"}),"Claim"]}),a&&s.is_assigned&&s.status==="in_progress"&&e.jsxs(i,{onClick:()=>b(s.id),className:"hover:bg-accent hover:text-accent-foreground",children:[e.jsx(le,{className:"mr-2 h-4 w-4"}),"Complete"]}),a&&s.is_assigned&&s.status!=="resolved"&&e.jsxs(i,{onClick:()=>v(s.id),className:"hover:bg-accent hover:text-accent-foreground",children:[e.jsx(ne,{className:"mr-2 h-4 w-4"}),"Unassign"]}),d&&e.jsxs(i,{onClick:()=>u(s.id),className:"text-destructive hover:bg-destructive hover:text-destructive-foreground",children:[e.jsx(ce,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]}):e.jsx("span",{className:"text-muted-foreground text-xs",children:"No actions"})})]},s.id)})})]})})},Ee=()=>{const{tickets:t,availableTickets:h,isLoading:u,deleteTicket:N,claimTicket:b,assignTicket:v,completeTicket:j,unassignTicket:o}=X(),{searchQuery:s,setSearchQuery:c}=z(),{hasPermission:a}=E(),d=async r=>{a("delete tickets")&&window.confirm("Are you sure you want to delete this ticket?")&&await N(r)},g=async r=>{a("edit tickets")&&await b(r)},y=async(r,I)=>{a("edit tickets")&&await v(r,I)},T=async r=>{a("edit tickets")&&await j(r)},C=async r=>{a("edit tickets")&&window.confirm("Are you sure you want to unassign this ticket?")&&await o(r)},q=t.filter(r=>r.status==="open").length,L=t.filter(r=>r.status==="in_progress").length,M=t.filter(r=>r.status==="resolved").length;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(k,{className:"w-6 h-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground font-sans",children:"Tickets"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage support tickets and track resolution"})]})]}),e.jsx(_,{asChild:!0,className:"bg-primary text-primary-foreground hover:bg-primary/90",children:e.jsxs(w,{to:"/tickets/create",children:[e.jsx(ie,{className:"mr-2 h-4 w-4"}),"New Ticket"]})})]}),e.jsx(m,{className:"bg-card border-border",children:e.jsx(x,{className:"p-4",children:e.jsxs("div",{className:"relative max-w-sm",children:[e.jsx(F,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(Q,{placeholder:"Search tickets...",value:s,onChange:r=>c(r.target.value),className:"pl-10 bg-background border-input text-foreground"})]})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs(m,{className:"bg-card border-border",children:[e.jsxs(f,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(p,{className:"text-sm font-medium text-muted-foreground",children:"Total Tickets"}),e.jsx(k,{className:"w-4 h-4 text-chart-1"})]}),e.jsx(x,{children:e.jsx("div",{className:"text-2xl font-bold text-foreground",children:t.length})})]}),e.jsxs(m,{className:"bg-card border-border",children:[e.jsxs(f,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(p,{className:"text-sm font-medium text-muted-foreground",children:"Open"}),e.jsx(oe,{className:"w-4 h-4 text-red-500"})]}),e.jsx(x,{children:e.jsx("div",{className:"text-2xl font-bold text-foreground",children:q})})]}),e.jsxs(m,{className:"bg-card border-border",children:[e.jsxs(f,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(p,{className:"text-sm font-medium text-muted-foreground",children:"In Progress"}),e.jsx(de,{className:"w-4 h-4 text-yellow-500"})]}),e.jsx(x,{children:e.jsx("div",{className:"text-2xl font-bold text-foreground",children:L})})]}),e.jsxs(m,{className:"bg-card border-border",children:[e.jsxs(f,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(p,{className:"text-sm font-medium text-muted-foreground",children:"Resolved"}),e.jsx(me,{className:"w-4 h-4 text-green-500"})]}),e.jsx(x,{children:e.jsx("div",{className:"text-2xl font-bold text-foreground",children:M})})]})]}),e.jsxs($,{defaultValue:"all",className:"space-y-4",children:[e.jsxs(O,{className:"bg-muted",children:[e.jsxs(A,{value:"all",children:["All Tickets (",t.length,")"]}),e.jsxs(A,{value:"available",children:["Available (",h.length,")"]})]}),e.jsx(U,{value:"all",children:e.jsx(S,{tickets:t,isLoading:u,onDelete:d,onClaim:g,onAssign:y,onComplete:T,onUnassign:C})}),e.jsx(U,{value:"available",children:e.jsx(S,{tickets:h,isLoading:u,onDelete:d,onClaim:g,onAssign:y,onComplete:T,onUnassign:C})})]})]})};export{Ee as default};
