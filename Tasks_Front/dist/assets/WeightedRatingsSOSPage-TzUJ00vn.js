import{D as t,j as e,B as j,C as T,c as R,d as _,e as E,f as L,I as p,L as D,h as F}from"./index-BQ68OLb7.js";import{L as f}from"./label-D6jQ_tmf.js";import{T as I,a as k,b,c as o,d as B,e as m}from"./table-C8BLNWbY.js";import{T as H}from"./trending-up-BxUxxyJJ.js";import{R as O}from"./refresh-cw-D84Ssh_q.js";import{C as N}from"./calculator-BZigadQb.js";const V=()=>{const[r,x]=t.useState(""),[l,u]=t.useState(""),[h,g]=t.useState(!1),[d,n]=t.useState(null),[i,c]=t.useState(null),C=[1,4,5,6],v=s=>s?.data?s.data:s,y=async s=>{if(s.preventDefault(),!(!r||!l)){g(!0),n(null),c(null);try{const a=await F.post("/calculate-weighted-ratings-sos",{user_ids:C,start_date:r,end_date:l}),S=v(a);c(S),setTimeout(()=>{document.getElementById("sos-results-table")?.scrollIntoView({behavior:"smooth",block:"start"})},0)}catch(a){n(a?.message||"Something went wrong")}finally{g(!1)}}},w=()=>{x(""),u(""),n(null),c(null)};return e.jsx("div",{className:"min-h-screen flex flex-col",children:e.jsxs("div",{className:"flex-1 space-y-6 p-4 md:p-6 max-w-full",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(H,{className:"w-6 h-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground font-sans",children:"Weighted Ratings (SOS)"}),e.jsx("p",{className:"text-muted-foreground",children:"Latest task rating × user percentage, averaged per user (out of 100)"})]})]}),e.jsxs(j,{variant:"outline",onClick:w,children:[e.jsx(O,{className:"w-4 h-4 mr-2"}),"Reset"]})]}),e.jsxs(T,{className:"bg-card border-border",children:[e.jsxs(R,{children:[e.jsxs(_,{className:"flex items-center gap-2",children:[e.jsx(N,{className:"w-5 h-5"}),"Calculate Weighted Ratings (SOS)"]}),e.jsx(E,{children:"Hardcoded users: 1, 4, 5, 6"})]}),e.jsxs(L,{className:"space-y-6",children:[e.jsxs("form",{onSubmit:y,className:"grid grid-cols-1 md:grid-cols-3 gap-4 items-end",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{htmlFor:"start_date",children:"Start Date"}),e.jsx(p,{id:"start_date",type:"date",value:r,onChange:s=>x(s.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{htmlFor:"end_date",children:"End Date"}),e.jsx(p,{id:"end_date",type:"date",min:r,value:l,onChange:s=>u(s.target.value),required:!0})]}),e.jsx(j,{type:"submit",className:"w-full md:w-auto",disabled:h,children:h?e.jsxs(e.Fragment,{children:[e.jsx(D,{className:"w-4 h-4 mr-2 animate-spin"}),"Calculating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(N,{className:"w-4 h-4 mr-2"}),"Calculate"]})})]}),d&&e.jsx("div",{className:"text-sm text-red-600 border border-red-200 bg-red-50 rounded-md p-3",children:d}),i&&e.jsx("div",{id:"sos-results-table",className:"rounded-md border border-border overflow-hidden",children:e.jsxs(I,{children:[e.jsx(k,{children:e.jsxs(b,{children:[e.jsx(o,{className:"w-[60px]",children:"#"}),e.jsx(o,{children:"User"}),e.jsx(o,{className:"text-right",children:"Rating (out of 100)"})]})}),e.jsx(B,{children:i.map((s,a)=>e.jsxs(b,{children:[e.jsx(m,{className:"font-medium",children:a+1}),e.jsx(m,{children:s.user_name}),e.jsx(m,{className:"text-right",children:s.rating===null?"—":s.rating.toFixed(2)})]},`${s.user_name}-${a}`))})]})}),!i&&!d&&e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Choose a date range and click ",e.jsx("span",{className:"font-medium",children:"Calculate"})," to see ratings."]})]})]})]})})};export{V as default};
