import{D as V,a as A,b as E,a$ as I,b0 as $,j as e,C as j,c as v,d as y,f as p,I as f,V as C,r as q,v as B,w as M,x as z,y as g,B as b,P,L as U,o as S,s as u,as as H,b1 as G,aa as J,b2 as K,N as k}from"./index-DgAmBmQE.js";import{F as O,a as i,b as o,c,d,e as m}from"./form-BfK1M0Sl.js";import{C as Q}from"./checkbox-C1cfEngC.js";import{S as W}from"./settings-CzvouVPS.js";import{T as X}from"./trash-2-DfpprwwN.js";const Y=S({name:u().min(1,"Field name is required"),max_value:H().min(1,"Max value must be at least 1"),description:u().optional()}),Z=S({type:K([k("task_rating"),k("stakeholder_rating")]),name:u().min(1,"Name is required").max(255),description:u().optional(),is_active:J(),fields:G(Y).min(1,"At least one field is required")}),L=I("type",[Z]),ne=({ratingConfig:l,onSubmit:_,isLoading:r})=>{const F=!!l,[h,w]=V.useState(l?.type||"task_rating"),N=s=>{const a={name:l?.name||"",description:l?.description||"",is_active:l?.is_active??!1};if(l){const n=l.config_data;return{type:s,...a,fields:n.fields||[{name:"",max_value:50,description:""}]}}return{type:s,...a,fields:[{name:"",max_value:50,description:""}]}},t=A({resolver:E(L),defaultValues:N(h),mode:"onSubmit"}),x=$({control:t.control,name:"fields"}),D=async s=>{let a;a={fields:s.fields};const n={name:s.name,description:s.description,type:s.type,config_data:a,is_active:s.is_active};await _(n)},T=s=>{console.log("🔄 Changing type from",h,"to",s),w(s);const a=N(s);t.reset(a)};return e.jsx(O,{...t,children:e.jsxs("form",{onSubmit:t.handleSubmit(D,s=>{console.log("❌ Form validation errors:",s)}),className:"space-y-6",children:[e.jsxs(j,{className:"bg-card border-border",children:[e.jsx(v,{children:e.jsxs(y,{className:"text-foreground flex items-center gap-2",children:[e.jsx(W,{className:"w-5 h-5"}),"Basic Information"]})}),e.jsxs(p,{className:"space-y-4",children:[e.jsx(i,{control:t.control,name:"name",render:({field:s})=>e.jsxs(o,{children:[e.jsx(c,{className:"text-foreground",children:"Name"}),e.jsx(d,{children:e.jsx(f,{placeholder:"Enter configuration name",...s,disabled:r,className:"bg-background border-input text-foreground"})}),e.jsx(m,{className:"text-destructive"})]})}),e.jsx(i,{control:t.control,name:"description",render:({field:s})=>e.jsxs(o,{children:[e.jsx(c,{className:"text-foreground",children:"Description"}),e.jsx(d,{children:e.jsx(C,{placeholder:"Enter configuration description (optional)",...s,disabled:r,className:"bg-background border-input text-foreground",rows:3})}),e.jsx(m,{className:"text-destructive"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(i,{control:t.control,name:"type",render:({field:s})=>e.jsxs(o,{children:[e.jsx(c,{className:"text-foreground",children:"Type"}),e.jsxs(q,{onValueChange:T,value:s.value,disabled:r,children:[e.jsx(d,{children:e.jsx(B,{className:"bg-background border-input text-foreground",children:e.jsx(M,{placeholder:"Select configuration type"})})}),e.jsxs(z,{children:[e.jsx(g,{value:"task_rating",children:"Task Rating"}),e.jsx(g,{value:"stakeholder_rating",children:"Stakeholder Rating"}),e.jsx(g,{value:"final_rating",children:"Final Rating"})]})]}),e.jsx(m,{className:"text-destructive"})]})}),e.jsx(i,{control:t.control,name:"is_active",render:({field:s})=>e.jsxs(o,{className:"flex flex-row items-start space-x-3 space-y-0 mt-8",children:[e.jsx(d,{children:e.jsx(Q,{checked:s.value,onCheckedChange:s.onChange,disabled:r})}),e.jsxs("div",{className:"space-y-1 leading-none",children:[e.jsx(c,{className:"text-foreground",children:"Active Configuration"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Set as the active configuration for this type"})]})]})})]})]})]}),"// Task/Stakeholder Rating Configuration - Same as before",e.jsxs(j,{className:"bg-card border-border",children:[e.jsx(v,{children:e.jsx(y,{className:"text-foreground",children:"Rating Fields"})}),e.jsxs(p,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Define the fields that will be used for ",h.replace("_"," ")]}),e.jsxs(b,{type:"button",variant:"outline",size:"sm",onClick:()=>x.append({name:"",max_value:50,description:""}),disabled:r,children:[e.jsx(P,{className:"w-4 h-4 mr-2"}),"Add Field"]})]}),x.fields.map((s,a)=>e.jsx(j,{className:"bg-accent/20",children:e.jsxs(p,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h4",{className:"text-sm font-medium text-foreground",children:["Field ",a+1]}),e.jsx(b,{type:"button",variant:"ghost",size:"sm",onClick:()=>x.remove(a),disabled:r||x.fields.length<=1,children:e.jsx(X,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(i,{control:t.control,name:`fields.${a}.name`,render:({field:n})=>e.jsxs(o,{children:[e.jsx(c,{className:"text-foreground",children:"Field Name"}),e.jsx(d,{children:e.jsx(f,{placeholder:"e.g., Code Cleanliness",...n,disabled:r,className:"bg-background border-input text-foreground"})}),e.jsx(m,{className:"text-destructive"})]})}),e.jsx(i,{control:t.control,name:`fields.${a}.description`,render:({field:n})=>e.jsxs(o,{children:[e.jsx(c,{className:"text-foreground",children:"Description"}),e.jsx(d,{children:e.jsx(C,{placeholder:"Describe what this field measures...",...n,disabled:r,className:"bg-background border-input text-foreground",rows:2})}),e.jsx(m,{className:"text-destructive"})]})}),e.jsx(i,{control:t.control,name:`fields.${a}.max_value`,render:({field:n})=>e.jsxs(o,{children:[e.jsx(c,{className:"text-foreground",children:"Max Value"}),e.jsx(d,{children:e.jsx(f,{type:"number",placeholder:"50",...n,onChange:R=>n.onChange(Number(R.target.value)),disabled:r,className:"bg-background border-input text-foreground"})}),e.jsx(m,{className:"text-destructive"})]})})]})]})},s.id))]})]}),e.jsxs(b,{type:"submit",disabled:r,className:"bg-primary text-primary-foreground hover:bg-primary/90",children:[r&&e.jsx(U,{className:"mr-2 h-4 w-4 animate-spin"}),F?"Update Configuration":"Create Configuration"]})]})})};export{ne as R};
