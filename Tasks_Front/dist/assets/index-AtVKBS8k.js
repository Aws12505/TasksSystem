import{k as D,j as e,A as _,n as S,p as E,D as M,E as I,B as A,F as B,G as f,H as b,R as H,U as y,P as L,C as n,f as g,I as R,c as F,d as Q}from"./index-C-JOrvqu.js";import{P as $,a as q,b as N,c as G,d as O,e as V,f as z}from"./pagination-xdB_GHyC.js";import{A as J,a as K,b as W,c as X,d as Y,e as Z,f as ee,g as se}from"./alert-dialog-Bgx7HfCP.js";import{u as re}from"./useUsers-C4VbtT1v.js";import{u as ae}from"./filtersStore-CuOg0dqF.js";import{T as le,a as te,b as w,c as d,d as ne,e as x}from"./table-NoCL8fJ3.js";import{B as C}from"./badge-BTqXeqU2.js";import{E as ie}from"./ellipsis-BSeDaogL.js";import{E as ce}from"./eye-DTScXWI0.js";import{S as oe}from"./square-pen-DuOAqyw6.js";import{T as de}from"./trash-2-DjNaN0DC.js";import{S as xe}from"./search-CCldpCnb.js";import"./usersStore-DwPA7xNr.js";import"./permissionService-BVWK9S_C.js";const me=({users:i,isLoading:a,onDelete:u})=>{const{hasPermission:l}=D();return a?e.jsx("div",{className:"space-y-4",children:Array.from({length:5}).map((s,c)=>e.jsx("div",{className:"h-16 bg-muted animate-pulse rounded-lg"},c))}):i.length===0?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-muted-foreground",children:"No users found"})}):e.jsx("div",{className:"border border-border rounded-lg bg-card",children:e.jsxs(le,{children:[e.jsx(te,{children:e.jsxs(w,{className:"border-border",children:[e.jsx(d,{className:"text-foreground",children:"User"}),e.jsx(d,{className:"text-foreground",children:"Email"}),e.jsx(d,{className:"text-foreground",children:"Roles"}),e.jsx(d,{className:"text-foreground",children:"Created"}),e.jsx(d,{className:"text-foreground w-[50px]",children:"Actions"})]})}),e.jsx(ne,{children:i.map(s=>{const c=l("view users")||l("edit users")||l("delete users");return e.jsxs(w,{className:"border-border hover:bg-accent/50",children:[e.jsx(x,{children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs(_,{className:"w-8 h-8",children:[typeof s.avatar_url=="string"&&s.avatar_url.trim()!==""&&e.jsx(S,{src:s.avatar_url,alt:s.name||"User avatar",className:"object-cover"}),e.jsx(E,{className:"bg-primary text-primary-foreground text-sm",children:s.name.charAt(0).toUpperCase()})]}),e.jsx("div",{children:e.jsx("p",{className:"text-sm font-medium text-foreground",children:s.name})})]})}),e.jsx(x,{className:"text-foreground",children:s.email}),e.jsx(x,{children:e.jsxs("div",{className:"flex gap-1 flex-wrap",children:[s.roles.slice(0,2).map(m=>e.jsx(C,{variant:"secondary",className:"text-xs",children:m.name},m.id)),s.roles.length>2&&e.jsxs(C,{variant:"outline",className:"text-xs",children:["+",s.roles.length-2]})]})}),e.jsx(x,{className:"text-muted-foreground",children:new Date(s.created_at).toLocaleDateString()}),e.jsx(x,{children:c?e.jsxs(M,{children:[e.jsx(I,{asChild:!0,children:e.jsx(A,{variant:"ghost",className:"h-8 w-8 p-0 hover:bg-accent",children:e.jsx(ie,{className:"h-4 w-4"})})}),e.jsxs(B,{align:"end",className:"bg-popover border-border",children:[l("view users")&&e.jsx(f,{asChild:!0,className:"hover:bg-accent hover:text-accent-foreground",children:e.jsxs(b,{to:`/users/${s.id}`,className:"flex items-center",children:[e.jsx(ce,{className:"mr-2 h-4 w-4"}),"View"]})}),l("edit users")&&e.jsx(f,{asChild:!0,className:"hover:bg-accent hover:text-accent-foreground",children:e.jsxs(b,{to:`/users/${s.id}/edit`,className:"flex items-center",children:[e.jsx(oe,{className:"mr-2 h-4 w-4"}),"Edit"]})}),l("delete users")&&e.jsxs(f,{onClick:()=>u(s.id),className:"text-destructive hover:bg-destructive hover:text-destructive-foreground",children:[e.jsx(de,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]}):e.jsx("span",{className:"text-muted-foreground text-xs",children:"No actions"})})]},s.id)})})]})})},Pe=()=>{const{users:i,pagination:a,isLoading:u,deleteUser:l,goToPage:s,nextPage:c,prevPage:m}=re(),{searchQuery:P,setSearchQuery:T}=ae(),{hasPermission:v}=D(),[p,o]=H.useState(null),k=async()=>{if(!v("delete users")){o(null);return}p&&(await l(p),o(null))},U=()=>{if(!a)return[];const r=[],{current_page:t,last_page:h}=a;t>3&&(r.push(1),t>4&&r.push("ellipsis-start"));for(let j=Math.max(1,t-2);j<=Math.min(h,t+2);j++)r.push(j);return t<h-2&&(t<h-3&&r.push("ellipsis-end"),r.push(h)),r};return e.jsxs("div",{className:"min-h-screen flex flex-col",children:[e.jsxs("div",{className:"flex-1 space-y-6 p-4 md:p-6 max-w-full",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(y,{className:"w-6 h-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground font-sans",children:"Users"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage system users and their permissions"})]})]}),v("create users")&&e.jsx(A,{asChild:!0,className:"bg-primary text-primary-foreground hover:bg-primary/90",children:e.jsxs(b,{to:"/users/create",children:[e.jsx(L,{className:"mr-2 h-4 w-4"}),"Add User"]})})]}),e.jsx(n,{className:"bg-card border-border",children:e.jsx(g,{className:"p-4 space-y-3",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"relative lg:col-span-2",children:[e.jsx(xe,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(R,{placeholder:"Search users (name, email, role)â€¦",value:P,onChange:r=>T(r.target.value),className:"pl-10 bg-background border-input text-foreground"})]}),e.jsx("div",{className:"hidden lg:block"}),e.jsx("div",{className:"hidden lg:block"})]})})}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs(n,{className:"bg-card border-border",children:[e.jsxs(F,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Q,{className:"text-sm font-medium text-muted-foreground",children:"Total Users"}),e.jsx(y,{className:"w-4 h-4 text-chart-1"})]}),e.jsx(g,{children:e.jsx("div",{className:"text-2xl font-bold text-foreground",children:a?.total||i.length||0})})]}),e.jsx("div",{className:"hidden sm:block",children:e.jsx(n,{className:"bg-card border-border h-full opacity-0 pointer-events-none"})}),e.jsx("div",{className:"hidden lg:block",children:e.jsx(n,{className:"bg-card border-border h-full opacity-0 pointer-events-none"})}),e.jsx("div",{className:"hidden lg:block",children:e.jsx(n,{className:"bg-card border-border h-full opacity-0 pointer-events-none"})})]}),e.jsx(n,{className:"bg-card border-border flex-1 flex flex-col min-h-0",children:e.jsx(g,{className:"p-0 flex-1 flex flex-col min-h-0",children:e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsx(me,{users:i,isLoading:u,onDelete:async r=>o(r)})})})}),a&&a.last_page>1&&e.jsx(n,{className:"bg-card border-border",children:e.jsx(g,{className:"p-3",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4",children:[e.jsxs("div",{className:"text-sm text-muted-foreground text-center sm:text-left",children:["Showing ",a.from||0," to ",a.to||0," of ",a.total||0," results"]}),e.jsx($,{children:e.jsxs(q,{children:[e.jsx(N,{children:e.jsx(G,{onClick:m,className:a.current_page===1?"pointer-events-none opacity-50":"cursor-pointer"})}),U().map((r,t)=>e.jsx(N,{children:r==="ellipsis-start"||r==="ellipsis-end"?e.jsx(O,{}):e.jsx(V,{onClick:()=>s(r),isActive:a.current_page===r,className:"cursor-pointer",children:r})},t)),e.jsx(N,{children:e.jsx(z,{onClick:c,className:a.current_page===a.last_page?"pointer-events-none opacity-50":"cursor-pointer"})})]})})]})})})]}),e.jsx(J,{open:!!p,onOpenChange:r=>!r&&o(null),children:e.jsxs(K,{className:"sm:max-w-[480px]",children:[e.jsxs(W,{children:[e.jsx(X,{children:"Delete user"}),e.jsx(Y,{children:"Are you sure you want to delete this user? This action cannot be undone."})]}),e.jsxs(Z,{children:[e.jsx(ee,{onClick:()=>o(null),children:"Cancel"}),e.jsx(se,{onClick:k,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete"})]})]})})]})};export{Pe as default};
