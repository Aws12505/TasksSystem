import{p as D,j as e,D as S,q as _,B as A,v as E,w as g,x as p,R as M,U as w,I as B}from"./index-aIDF15FF.js";import{C as n,d as u,a as I,b as L}from"./card-DegwiSso.js";import{P as R,a as H,b,c as F,d as $,e as q,f as Q}from"./pagination-B4XyrHhv.js";import{A as O,a as V,b as z,c as G,d as J,e as K,f as W,g as X}from"./alert-dialog-ds1JXdri.js";import{u as Y}from"./useUsers-C_E5PB0y.js";import{u as Z}from"./filtersStore-jmA0_qHt.js";import{T as ee,a as se,b as y,c as d,d as re,e as m}from"./table-DocBqU00.js";import{B as C}from"./badge-D7aLlcYV.js";import{A as ae,a as le}from"./avatar-Dx134Ua-.js";import{E as te}from"./ellipsis-DsHtDR5U.js";import{E as ne}from"./eye-C1We8Kzb.js";import{T as ie}from"./trending-up-16StpwkQ.js";import{S as ce}from"./square-pen-B8hD18R8.js";import{T as oe}from"./trash-2-CAuoNeFC.js";import{P as de}from"./plus-DsrYCZRf.js";import{S as me}from"./search-xnRKQA1g.js";import"./usersStore-PQDonZ7P.js";import"./permissionService-B5huWhq-.js";import"./index-CT1d_Ntm.js";const xe=({users:i,isLoading:a,onDelete:j})=>{const{hasPermission:l}=D();return a?e.jsx("div",{className:"space-y-4",children:Array.from({length:5}).map((r,c)=>e.jsx("div",{className:"h-16 bg-muted animate-pulse rounded-lg"},c))}):i.length===0?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-muted-foreground",children:"No users found"})}):e.jsx("div",{className:"border border-border rounded-lg bg-card",children:e.jsxs(ee,{children:[e.jsx(se,{children:e.jsxs(y,{className:"border-border",children:[e.jsx(d,{className:"text-foreground",children:"User"}),e.jsx(d,{className:"text-foreground",children:"Email"}),e.jsx(d,{className:"text-foreground",children:"Roles"}),e.jsx(d,{className:"text-foreground",children:"Created"}),e.jsx(d,{className:"text-foreground w-[50px]",children:"Actions"})]})}),e.jsx(re,{children:i.map(r=>{const c=l("view users")||l("edit users")||l("delete users")||l("view analytics");return e.jsxs(y,{className:"border-border hover:bg-accent/50",children:[e.jsx(m,{children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ae,{className:"w-8 h-8",children:e.jsx(le,{className:"bg-primary text-primary-foreground text-sm",children:r.name.charAt(0).toUpperCase()})}),e.jsx("div",{children:e.jsx("p",{className:"text-sm font-medium text-foreground",children:r.name})})]})}),e.jsx(m,{className:"text-foreground",children:r.email}),e.jsx(m,{children:e.jsxs("div",{className:"flex gap-1 flex-wrap",children:[r.roles.slice(0,2).map(x=>e.jsx(C,{variant:"secondary",className:"text-xs",children:x.name},x.id)),r.roles.length>2&&e.jsxs(C,{variant:"outline",className:"text-xs",children:["+",r.roles.length-2]})]})}),e.jsx(m,{className:"text-muted-foreground",children:new Date(r.created_at).toLocaleDateString()}),e.jsx(m,{children:c?e.jsxs(S,{children:[e.jsx(_,{asChild:!0,children:e.jsx(A,{variant:"ghost",className:"h-8 w-8 p-0 hover:bg-accent",children:e.jsx(te,{className:"h-4 w-4"})})}),e.jsxs(E,{align:"end",className:"bg-popover border-border",children:[l("view users")&&e.jsx(g,{asChild:!0,className:"hover:bg-accent hover:text-accent-foreground",children:e.jsxs(p,{to:`/users/${r.id}`,className:"flex items-center",children:[e.jsx(ne,{className:"mr-2 h-4 w-4"}),"View"]})}),l("view analytics")&&e.jsx(g,{asChild:!0,className:"hover:bg-accent hover:text-accent-foreground",children:e.jsxs(p,{to:`/analytics/users/${r.id}`,className:"flex items-center",children:[e.jsx(ie,{className:"mr-2 h-4 w-4"}),"User Analytics"]})}),l("edit users")&&e.jsx(g,{asChild:!0,className:"hover:bg-accent hover:text-accent-foreground",children:e.jsxs(p,{to:`/users/${r.id}/edit`,className:"flex items-center",children:[e.jsx(ce,{className:"mr-2 h-4 w-4"}),"Edit"]})}),l("delete users")&&e.jsxs(g,{onClick:()=>j(r.id),className:"text-destructive hover:bg-destructive hover:text-destructive-foreground",children:[e.jsx(oe,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]}):e.jsx("span",{className:"text-muted-foreground text-xs",children:"No actions"})})]},r.id)})})]})})},_e=()=>{const{users:i,pagination:a,isLoading:j,deleteUser:l,goToPage:r,nextPage:c,prevPage:x}=Y(),{searchQuery:P,setSearchQuery:T}=Z(),{hasPermission:v}=D(),[f,o]=M.useState(null),k=async()=>{if(!v("delete users")){o(null);return}f&&(await l(f),o(null))},U=()=>{if(!a)return[];const s=[],{current_page:t,last_page:h}=a;t>3&&(s.push(1),t>4&&s.push("ellipsis-start"));for(let N=Math.max(1,t-2);N<=Math.min(h,t+2);N++)s.push(N);return t<h-2&&(t<h-3&&s.push("ellipsis-end"),s.push(h)),s};return e.jsxs("div",{className:"min-h-screen flex flex-col",children:[e.jsxs("div",{className:"flex-1 space-y-6 p-4 md:p-6 max-w-full",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(w,{className:"w-6 h-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground font-sans",children:"Users"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage system users and their permissions"})]})]}),v("create users")&&e.jsx(A,{asChild:!0,className:"bg-primary text-primary-foreground hover:bg-primary/90",children:e.jsxs(p,{to:"/users/create",children:[e.jsx(de,{className:"mr-2 h-4 w-4"}),"Add User"]})})]}),e.jsx(n,{className:"bg-card border-border",children:e.jsx(u,{className:"p-4 space-y-3",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"relative lg:col-span-2",children:[e.jsx(me,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(B,{placeholder:"Search users (name, email, role)â€¦",value:P,onChange:s=>T(s.target.value),className:"pl-10 bg-background border-input text-foreground"})]}),e.jsx("div",{className:"hidden lg:block"}),e.jsx("div",{className:"hidden lg:block"})]})})}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs(n,{className:"bg-card border-border",children:[e.jsxs(I,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(L,{className:"text-sm font-medium text-muted-foreground",children:"Total Users"}),e.jsx(w,{className:"w-4 h-4 text-chart-1"})]}),e.jsx(u,{children:e.jsx("div",{className:"text-2xl font-bold text-foreground",children:a?.total||i.length||0})})]}),e.jsx("div",{className:"hidden sm:block",children:e.jsx(n,{className:"bg-card border-border h-full opacity-0 pointer-events-none"})}),e.jsx("div",{className:"hidden lg:block",children:e.jsx(n,{className:"bg-card border-border h-full opacity-0 pointer-events-none"})}),e.jsx("div",{className:"hidden lg:block",children:e.jsx(n,{className:"bg-card border-border h-full opacity-0 pointer-events-none"})})]}),e.jsx(n,{className:"bg-card border-border flex-1 flex flex-col min-h-0",children:e.jsx(u,{className:"p-0 flex-1 flex flex-col min-h-0",children:e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsx(xe,{users:i,isLoading:j,onDelete:async s=>o(s)})})})}),a&&a.last_page>1&&e.jsx(n,{className:"bg-card border-border",children:e.jsx(u,{className:"p-3",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4",children:[e.jsxs("div",{className:"text-sm text-muted-foreground text-center sm:text-left",children:["Showing ",a.from||0," to ",a.to||0," of ",a.total||0," results"]}),e.jsx(R,{children:e.jsxs(H,{children:[e.jsx(b,{children:e.jsx(F,{onClick:x,className:a.current_page===1?"pointer-events-none opacity-50":"cursor-pointer"})}),U().map((s,t)=>e.jsx(b,{children:s==="ellipsis-start"||s==="ellipsis-end"?e.jsx($,{}):e.jsx(q,{onClick:()=>r(s),isActive:a.current_page===s,className:"cursor-pointer",children:s})},t)),e.jsx(b,{children:e.jsx(Q,{onClick:c,className:a.current_page===a.last_page?"pointer-events-none opacity-50":"cursor-pointer"})})]})})]})})})]}),e.jsx(O,{open:!!f,onOpenChange:s=>!s&&o(null),children:e.jsxs(V,{className:"sm:max-w-[480px]",children:[e.jsxs(z,{children:[e.jsx(G,{children:"Delete user"}),e.jsx(J,{children:"Are you sure you want to delete this user? This action cannot be undone."})]}),e.jsxs(K,{children:[e.jsx(W,{onClick:()=>o(null),children:"Cancel"}),e.jsx(X,{onClick:k,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete"})]})]})})]})};export{_e as default};
