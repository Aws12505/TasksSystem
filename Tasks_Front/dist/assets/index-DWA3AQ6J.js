import{q as G,j as e,D as te,v as ne,B as J,w as ie,x as u,y as A,T as M,p as le,I as ce}from"./index-Zu_vECNa.js";import{C as d,d as x,a as y,b as C}from"./card-BEr3QNnL.js";import{T as oe,a as de,b as L,c as q}from"./tabs-DR-YrqT6.js";import{P as I,a as R,b as g,c as H,d as V,e as F,f as Q}from"./pagination-BuOP3ZWf.js";import{u as xe}from"./useTickets-BCfgxJNI.js";import{u as me}from"./filtersStore-Bzkg2oTq.js";import{T as he,a as ue,b as $,c as l,d as ge,e as c}from"./table-BG5bWP2S.js";import{A as O,a as X}from"./avatar-DLajZ5eL.js";import{B as pe}from"./badge-DxFSLxNv.js";import{T as je,a as fe,b as Ne}from"./TicketPriorityBadge-B7uZBUd6.js";import{E as be}from"./ellipsis-BlRS9ixv.js";import{E as ve}from"./eye-CMXziqT6.js";import{S as we}from"./square-pen-nXKqUES0.js";import{U as ye,a as Ce}from"./user-x-KFgm4agt.js";import{C as Te}from"./circle-check-big-BHZOumvS.js";import{T as ke}from"./trash-2-CfGhK2lt.js";import{P as Pe}from"./plus-BVAq3NVV.js";import{C as Ae}from"./circle-alert-DuMf0MI3.js";import{C as _e}from"./clock-D2BjIf0k.js";import{C as Ue}from"./circle-check-Darv1scT.js";import"./ticketsStore-CjniGEnL.js";import"./index-C8ilSr3e.js";const z=({tickets:i,isLoading:f,onDelete:r,onClaim:t,onComplete:N,onUnassign:T,showActions:b=!0})=>{const{hasPermission:p}=G();return f?e.jsx("div",{className:"space-y-4",children:Array.from({length:5}).map((a,m)=>e.jsx("div",{className:"h-16 bg-muted animate-pulse rounded-lg"},m))}):i.length===0?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-muted-foreground",children:"No tickets found"})}):e.jsx("div",{className:"border border-border rounded-lg bg-card",children:e.jsxs(he,{children:[e.jsx(ue,{children:e.jsxs($,{className:"border-border",children:[e.jsx(l,{className:"text-foreground",children:"Title"}),e.jsx(l,{className:"text-foreground",children:"Type"}),e.jsx(l,{className:"text-foreground",children:"Status"}),e.jsx(l,{className:"text-foreground",children:"Priority"}),e.jsx(l,{className:"text-foreground",children:"Requester"}),e.jsx(l,{className:"text-foreground",children:"Assignee"}),e.jsx(l,{className:"text-foreground",children:"Created"}),b&&e.jsx(l,{className:"text-foreground w-[50px]",children:"Actions"})]})}),e.jsx(ge,{children:i.map(a=>{const m=p("view tickets"),o=p("edit tickets"),v=p("delete tickets"),k=m||o||v;return e.jsxs($,{className:"border-border hover:bg-accent/50",children:[e.jsx(c,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:a.title}),e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-2",children:a.description})]})}),e.jsx(c,{children:e.jsx(je,{type:a.type})}),e.jsx(c,{children:e.jsx(fe,{status:a.status})}),e.jsx(c,{children:e.jsx(Ne,{priority:a.priority})}),e.jsx(c,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(O,{className:"w-6 h-6",children:e.jsx(X,{className:"bg-primary text-primary-foreground text-xs",children:a.requester?.name?.charAt(0).toUpperCase()||"U"})}),e.jsx("span",{className:"text-sm text-foreground",children:a.requester?.name||"Unknown User"})]})}),e.jsx(c,{children:a.assignee?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(O,{className:"w-6 h-6",children:e.jsx(X,{className:"bg-chart-2 text-white text-xs",children:a.assignee.name?.charAt(0).toUpperCase()||"A"})}),e.jsx("span",{className:"text-sm text-foreground",children:a.assignee.name})]}):e.jsx(pe,{variant:"outline",className:"text-xs",children:"Unassigned"})}),e.jsx(c,{className:"text-muted-foreground",children:new Date(a.created_at).toLocaleDateString()}),b&&e.jsx(c,{children:k?e.jsxs(te,{children:[e.jsx(ne,{asChild:!0,children:e.jsx(J,{variant:"ghost",className:"h-8 w-8 p-0 hover:bg-accent",children:e.jsx(be,{className:"h-4 w-4"})})}),e.jsxs(ie,{align:"end",className:"bg-popover border-border",children:[m&&e.jsx(u,{asChild:!0,className:"hover:bg-accent hover:text-accent-foreground",children:e.jsxs(A,{to:`/tickets/${a.id}`,className:"flex items-center",children:[e.jsx(ve,{className:"mr-2 h-4 w-4"}),"View"]})}),o&&e.jsx(u,{asChild:!0,className:"hover:bg-accent hover:text-accent-foreground",children:e.jsxs(A,{to:`/tickets/${a.id}/edit`,className:"flex items-center",children:[e.jsx(we,{className:"mr-2 h-4 w-4"}),"Edit"]})}),o&&a.is_available&&e.jsxs(u,{onClick:()=>t(a.id),className:"hover:bg-accent hover:text-accent-foreground",children:[e.jsx(ye,{className:"mr-2 h-4 w-4"}),"Claim"]}),o&&a.is_assigned&&a.status==="in_progress"&&e.jsxs(u,{onClick:()=>N(a.id),className:"hover:bg-accent hover:text-accent-foreground",children:[e.jsx(Te,{className:"mr-2 h-4 w-4"}),"Complete"]}),o&&a.is_assigned&&a.status!=="resolved"&&e.jsxs(u,{onClick:()=>T(a.id),className:"hover:bg-accent hover:text-accent-foreground",children:[e.jsx(Ce,{className:"mr-2 h-4 w-4"}),"Unassign"]}),v&&e.jsxs(u,{onClick:()=>r(a.id),className:"text-destructive hover:bg-destructive hover:text-destructive-foreground",children:[e.jsx(ke,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]}):e.jsx("span",{className:"text-muted-foreground text-xs",children:"No actions"})})]},a.id)})})]})})},Ze=()=>{const{tickets:i,availableTickets:f,pagination:r,availablePagination:t,isLoading:N,deleteTicket:T,claimTicket:b,assignTicket:p,completeTicket:a,unassignTicket:m,goToPage:o,goToAvailablePage:v,nextPage:k,prevPage:K,nextAvailablePage:W,prevAvailablePage:Y}=xe(),{searchQuery:Z,setSearchQuery:ee}=me(),{hasPermission:j}=G(),_=async s=>{j("delete tickets")&&window.confirm("Are you sure you want to delete this ticket?")&&await T(s)},U=async s=>{j("edit tickets")&&await b(s)},D=async(s,n)=>{j("edit tickets")&&await p(s,n)},S=async s=>{j("edit tickets")&&await a(s)},B=async s=>{j("edit tickets")&&window.confirm("Are you sure you want to unassign this ticket?")&&await m(s)},se=i.filter(s=>s.status==="open").length,ae=i.filter(s=>s.status==="in_progress").length,re=i.filter(s=>s.status==="resolved").length,E=s=>{if(!s)return[];const n=[],{current_page:h,last_page:w}=s;h>3&&(n.push(1),h>4&&n.push("ellipsis-start"));for(let P=Math.max(1,h-2);P<=Math.min(w,h+2);P++)n.push(P);return h<w-2&&(h<w-3&&n.push("ellipsis-end"),n.push(w)),n};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(M,{className:"w-6 h-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground font-sans",children:"Tickets"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage support tickets and track resolution"})]})]}),e.jsx(J,{asChild:!0,className:"bg-primary text-primary-foreground hover:bg-primary/90",children:e.jsxs(A,{to:"/tickets/create",children:[e.jsx(Pe,{className:"mr-2 h-4 w-4"}),"New Ticket"]})})]}),e.jsx(d,{className:"bg-card border-border",children:e.jsx(x,{className:"p-4",children:e.jsxs("div",{className:"relative max-w-sm",children:[e.jsx(le,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(ce,{placeholder:"Search tickets...",value:Z,onChange:s=>ee(s.target.value),className:"pl-10 bg-background border-input text-foreground"})]})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs(d,{className:"bg-card border-border",children:[e.jsxs(y,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(C,{className:"text-sm font-medium text-muted-foreground",children:"Total Tickets"}),e.jsx(M,{className:"w-4 h-4 text-chart-1"})]}),e.jsx(x,{children:e.jsx("div",{className:"text-2xl font-bold text-foreground",children:r?.total||i.length})})]}),e.jsxs(d,{className:"bg-card border-border",children:[e.jsxs(y,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(C,{className:"text-sm font-medium text-muted-foreground",children:"Open"}),e.jsx(Ae,{className:"w-4 h-4 text-red-500"})]}),e.jsx(x,{children:e.jsx("div",{className:"text-2xl font-bold text-foreground",children:se})})]}),e.jsxs(d,{className:"bg-card border-border",children:[e.jsxs(y,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(C,{className:"text-sm font-medium text-muted-foreground",children:"In Progress"}),e.jsx(_e,{className:"w-4 h-4 text-yellow-500"})]}),e.jsx(x,{children:e.jsx("div",{className:"text-2xl font-bold text-foreground",children:ae})})]}),e.jsxs(d,{className:"bg-card border-border",children:[e.jsxs(y,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(C,{className:"text-sm font-medium text-muted-foreground",children:"Resolved"}),e.jsx(Ue,{className:"w-4 h-4 text-green-500"})]}),e.jsx(x,{children:e.jsx("div",{className:"text-2xl font-bold text-foreground",children:re})})]})]}),e.jsxs(oe,{defaultValue:"all",className:"space-y-4",children:[e.jsxs(de,{className:"bg-muted",children:[e.jsxs(L,{value:"all",children:["All Tickets (",r?.total||i.length,")"]}),e.jsxs(L,{value:"available",children:["Available (",t?.total||f.length,")"]})]}),e.jsxs(q,{value:"all",className:"space-y-4",children:[e.jsx(z,{tickets:i,isLoading:N,onDelete:_,onClaim:U,onAssign:D,onComplete:S,onUnassign:B}),r&&r.last_page>1&&e.jsx(d,{className:"bg-card border-border",children:e.jsx(x,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",r.from||0," to ",r.to||0," of ",r.total," results"]}),e.jsx(I,{children:e.jsxs(R,{children:[e.jsx(g,{children:e.jsx(H,{onClick:K,className:r.current_page===1?"pointer-events-none opacity-50":"cursor-pointer"})}),E(r).map((s,n)=>e.jsx(g,{children:s==="ellipsis-start"||s==="ellipsis-end"?e.jsx(V,{}):e.jsx(F,{onClick:()=>o(s),isActive:r.current_page===s,className:"cursor-pointer",children:s})},n)),e.jsx(g,{children:e.jsx(Q,{onClick:k,className:r.current_page===r.last_page?"pointer-events-none opacity-50":"cursor-pointer"})})]})})]})})})]}),e.jsxs(q,{value:"available",className:"space-y-4",children:[e.jsx(z,{tickets:f,isLoading:N,onDelete:_,onClaim:U,onAssign:D,onComplete:S,onUnassign:B}),t&&t.last_page>1&&e.jsx(d,{className:"bg-card border-border",children:e.jsx(x,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",t.from||0," to ",t.to||0," of ",t.total," results"]}),e.jsx(I,{children:e.jsxs(R,{children:[e.jsx(g,{children:e.jsx(H,{onClick:Y,className:t.current_page===1?"pointer-events-none opacity-50":"cursor-pointer"})}),E(t).map((s,n)=>e.jsx(g,{children:s==="ellipsis-start"||s==="ellipsis-end"?e.jsx(V,{}):e.jsx(F,{onClick:()=>v(s),isActive:t.current_page===s,className:"cursor-pointer",children:s})},n)),e.jsx(g,{children:e.jsx(Q,{onClick:W,className:t.current_page===t.last_page?"pointer-events-none opacity-50":"cursor-pointer"})})]})})]})})})]})]})]})};export{Ze as default};
