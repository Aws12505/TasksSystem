import{g as ee,D as o,j as e,C as b,c as N,d as _,f as C,l as H,ax as se,az as re,aA as te,aB as ae,b6 as P,I as v,V as ne,b8 as ce,B as h,aq as oe}from"./index-C3ZJYr2K.js";import{L as p}from"./label-BOmi2q2e.js";import{T as ie,a as le,b as B,c as A}from"./tabs-mU1Gdwog.js";import{u as F,c as j,b as de}from"./clockingCalculations-DNvYksCn.js";import{D as xe,R as ue,C as me}from"./CorrectionTypeSelector-DaY9W7_i.js";import{B as ge}from"./badge-C51bFrhW.js";import{C as D}from"./circle-alert-C8-3S4nN.js";import"./table-DcKM-l2K.js";import"./chevron-left-C7gkIf1g.js";import"./calendar-5LLnmlY3.js";import"./user-K9f-5bbj.js";import"./play-Bk-ecL1o.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],pe=ee("funnel",he),je=n=>{const{records:c,recordsPagination:r,isLoading:s,isExporting:i,error:a,fetchRecords:l,exportRecords:d,clearError:x}=F();return o.useEffect(()=>{l(n)},[JSON.stringify(n)]),{records:c,pagination:r,isLoading:s,isExporting:i,error:a,refresh:()=>l(n),exportRecords:d,clearError:x}},fe=()=>{const{pendingCorrections:n,correctionLoading:c,correctionError:r,getPendingCorrections:s,requestCorrection:i,clearCorrectionError:a}=F();return o.useEffect(()=>{s()},[s]),{pendingCorrections:n,isLoading:c,error:r,requestCorrection:i,refresh:s,clearError:a}},be=({corrections:n,companyTimezone:c})=>{const r=n.filter(s=>s.status==="pending");return r.length?e.jsxs(b,{className:"bg-card border-chart-2/50",children:[e.jsx(N,{className:"bg-accent",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs(_,{className:"flex items-center gap-2 text-foreground",children:[e.jsx(D,{className:"w-5 h-5 text-chart-2"}),"Pending Corrections (",r.length,")"]})})}),e.jsx(C,{className:"pt-6 space-y-3",children:r.map(s=>e.jsxs("div",{className:"p-4 rounded-lg border border-chart-2/30 bg-accent space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(H,{className:"w-4 h-4 text-chart-2"}),e.jsx("span",{className:"font-medium text-foreground capitalize",children:s.correction_type.replace("_"," ")})]}),e.jsx(ge,{variant:"outline",className:"text-chart-2",children:"Pending"})]}),e.jsxs("div",{className:"text-sm text-muted-foreground space-y-1",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-foreground",children:"Original:"})," ",j(s.original_time_utc,c)]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-foreground",children:"Requested:"})," ",j(s.requested_time_utc,c)]}),e.jsx("div",{className:"mt-2 p-3 bg-background rounded border border-border",children:e.jsx("p",{className:"text-foreground text-xs",children:s.reason})})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Submitted ",new Date(s.created_at).toLocaleDateString()]})]},s.id))})]}):null},Ne=({open:n,onOpenChange:c,type:r,session:s,breakRecord:i,companyTimezone:a,onSubmit:l,isLoading:d})=>{const[x,y]=o.useState(""),[m,g]=o.useState(""),w=()=>r==="clock_in"&&s?.clock_in_utc?j(s.clock_in_utc,a):r==="clock_out"&&s?.clock_out_utc?j(s.clock_out_utc,a):r==="break_in"&&i?.break_start_utc?j(i.break_start_utc,a):r==="break_out"&&i?.break_end_utc?j(i.break_end_utc,a):"Not set",f=async()=>{if(!x||!m.trim()||m.length<10)return;const u=de(x,a);await l({clock_session_id:r.includes("clock")?s?.id:void 0,break_record_id:r.includes("break")?i?.id:void 0,correction_type:r,requested_time_utc:u,reason:m.trim()}),y(""),g(""),c(!1)};return e.jsx(se,{open:n,onOpenChange:c,children:e.jsxs(re,{className:"bg-card border-border",children:[e.jsxs(te,{children:[e.jsxs(ae,{className:"text-foreground",children:["Request ",r.replace("_"," ").toUpperCase()," Correction"]}),e.jsxs(P,{className:"text-muted-foreground",children:["Original: ",w()]}),e.jsxs(P,{className:"text-muted-foreground",children:["Enter corrected time in ",a]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(p,{htmlFor:"requested_time",className:"text-foreground",children:["Corrected Time (",a,")"]}),e.jsx(v,{id:"requested_time",type:"datetime-local",value:x,onChange:u=>y(u.target.value),className:"bg-background border-input text-foreground",disabled:d}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Enter time in ",a]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"reason",className:"text-foreground",children:"Reason (required - min 10 chars)"}),e.jsx(ne,{id:"reason",placeholder:"Explain why you need this correction...",value:m,onChange:u=>g(u.target.value),rows:4,maxLength:500,className:"bg-background border-input text-foreground",disabled:d}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[m.length,"/500"]})]})]}),e.jsxs(ce,{children:[e.jsx(h,{variant:"outline",onClick:()=>c(!1),disabled:d,children:"Cancel"}),e.jsx(h,{onClick:f,disabled:d||!x||m.length<10,className:"bg-primary hover:bg-primary/90",children:d?"Submitting...":"Submit Request"})]})]})})},qe=()=>{const[n,c]=o.useState({per_page:15}),[r,s]=o.useState(!1),[i,a]=o.useState(!1),[l,d]=o.useState({start_date:"",end_date:""}),{records:x,pagination:y,isLoading:m,isExporting:g,exportRecords:w}=je(n),{companyTimezone:f}=F(),{pendingCorrections:u,isLoading:E,requestCorrection:V,refresh:I}=fe(),[M,T]=o.useState(!1),[k,q]=o.useState(null),[U,R]=o.useState(!1),[J,X]=o.useState("clock_in"),[Y,L]=o.useState(null),O=(t,S)=>{c({...n,[t]:S,page:1})},G=()=>{c({per_page:15})},K=t=>{c({...n,page:t})},Q=()=>{const t={start_date:l.start_date||void 0,end_date:l.end_date||void 0};w(t),a(!1)},W=t=>{q(t),T(!0)},Z=(t,S)=>{X(t),S&&k?.break_records&&L(k.break_records.find(z=>z.id===S)),R(!0)},$=async t=>{await V(t),R(!1),q(null),L(null)};return e.jsxs("div",{className:"min-h-screen flex flex-col",children:[e.jsxs("div",{className:"flex-1 space-y-6 p-4 md:p-6 max-w-full",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(H,{className:"w-6 h-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground font-sans",children:"Clocking Records"}),e.jsx("p",{className:"text-muted-foreground",children:"View your clocking history"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(h,{variant:"outline",onClick:()=>s(!r),className:"bg-background border-input",children:[e.jsx(pe,{className:"w-4 h-4 mr-2"}),r?"Hide":"Show"," Filters"]}),e.jsxs(h,{onClick:()=>a(!0),disabled:g||x.length===0,className:"bg-primary text-primary-foreground hover:bg-primary/90",children:[e.jsx(xe,{className:"w-4 h-4 mr-2"}),g?"Exporting...":"Export"]})]})]}),e.jsxs(ie,{defaultValue:"records",className:"space-y-6",children:[e.jsxs(le,{className:"bg-muted",children:[e.jsx(B,{value:"records",children:"Records"}),e.jsxs(B,{value:"corrections",children:["Corrections (",u.length,")"]})]}),e.jsxs(A,{value:"records",className:"space-y-4",children:[r&&e.jsxs(b,{className:"bg-card border-border",children:[e.jsx(N,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(_,{className:"text-lg text-foreground",children:"Filters"}),e.jsxs(h,{variant:"ghost",size:"sm",onClick:G,children:[e.jsx(oe,{className:"w-4 h-4 mr-1"}),"Clear"]})]})}),e.jsx(C,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"start_date",className:"text-foreground",children:"Start Date"}),e.jsx(v,{id:"start_date",type:"date",value:n.start_date||"",onChange:t=>O("start_date",t.target.value),className:"bg-background border-input text-foreground"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"end_date",className:"text-foreground",children:"End Date"}),e.jsx(v,{id:"end_date",type:"date",value:n.end_date||"",onChange:t=>O("end_date",t.target.value),className:"bg-background border-input text-foreground"})]})]})})]}),e.jsxs(b,{className:"bg-card border-border",children:[e.jsx(N,{children:e.jsx(_,{className:"text-foreground",children:"Your Records"})}),e.jsx(C,{children:e.jsx(ue,{records:x,companyTimezone:f,pagination:y,onPageChange:K,isLoading:m,onCorrectionClick:W})})]})]}),e.jsx(A,{value:"corrections",className:"space-y-4",children:e.jsxs(b,{className:"bg-card border-border",children:[e.jsx(N,{className:"bg-accent",children:e.jsxs(_,{className:"flex items-center gap-2 text-foreground",children:[e.jsx(D,{className:"w-5 h-5 text-chart-2"}),"My Pending Corrections"]})}),e.jsx(C,{className:"pt-6",children:u.length>0?e.jsx(be,{corrections:u,isLoading:E,onRefresh:I,companyTimezone:f}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(D,{className:"w-12 h-12 mx-auto text-muted-foreground/50 mb-3"}),e.jsx("p",{className:"text-muted-foreground",children:"No pending correction requests"})]})})]})})]}),i&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs(b,{className:"bg-card border-border w-full max-w-md mx-4",children:[e.jsx(N,{children:e.jsx(_,{className:"text-foreground",children:"Export Records"})}),e.jsxs(C,{className:"space-y-4",children:[e.jsx("p",{className:"text-muted-foreground text-sm",children:"Choose a date range or leave empty to export all records"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"export_start_date",className:"text-foreground",children:"Start Date (Optional)"}),e.jsx(v,{id:"export_start_date",type:"date",value:l.start_date,onChange:t=>d({...l,start_date:t.target.value}),className:"bg-background border-input text-foreground"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"export_end_date",className:"text-foreground",children:"End Date (Optional)"}),e.jsx(v,{id:"export_end_date",type:"date",value:l.end_date,onChange:t=>d({...l,end_date:t.target.value}),className:"bg-background border-input text-foreground"})]}),e.jsxs("div",{className:"flex gap-2 justify-end pt-4",children:[e.jsx(h,{variant:"outline",onClick:()=>a(!1),className:"border-input",children:"Cancel"}),e.jsx(h,{onClick:Q,disabled:g,className:"bg-primary text-primary-foreground hover:bg-primary/90",children:g?"Exporting...":"Export"})]})]})]})})]}),e.jsx(me,{open:M,onOpenChange:T,session:k,onSelect:Z,isLoading:E}),e.jsx(Ne,{open:U,onOpenChange:R,type:J,session:k,breakRecord:Y,companyTimezone:f,onSubmit:$,isLoading:E})]})};export{qe as default};
