import{p as A,j as e,A as _,q as S,v as E,D as M,w as I,B as D,x as B,y as g,z as p,R as L,U as y,I as R}from"./index-DswDhpz2.js";import{C as n,d as u,a as H,b as F}from"./card-DHEPJeJJ.js";import{P as $,a as q,b,c as Q,d as z,e as O,f as V}from"./pagination-CC2foofY.js";import{A as G,a as J,b as K,c as W,d as X,e as Y,f as Z,g as ee}from"./alert-dialog-CiQ5mFiM.js";import{u as se}from"./useUsers-BuxjGXDd.js";import{u as re}from"./filtersStore-CKo-nj-z.js";import{T as ae,a as te,b as w,c as d,d as le,e as m}from"./table-Cg8n6fLm.js";import{B as C}from"./badge-DzLjXeAx.js";import{E as ne}from"./ellipsis-HHEpgaFa.js";import{E as ie}from"./eye-CBRvwtnZ.js";import{T as ce}from"./trending-up-IQt5XO4x.js";import{S as oe}from"./square-pen-DQqsBbkZ.js";import{T as de}from"./trash-2-JR_tJt8Y.js";import{P as me}from"./plus-CCocBn2e.js";import{S as xe}from"./search-JJls1o8W.js";import"./usersStore-kfCWoafh.js";import"./permissionService-XLe0_ulN.js";const he=({users:i,isLoading:a,onDelete:j})=>{const{hasPermission:t}=A();return a?e.jsx("div",{className:"space-y-4",children:Array.from({length:5}).map((s,c)=>e.jsx("div",{className:"h-16 bg-muted animate-pulse rounded-lg"},c))}):i.length===0?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-muted-foreground",children:"No users found"})}):e.jsx("div",{className:"border border-border rounded-lg bg-card",children:e.jsxs(ae,{children:[e.jsx(te,{children:e.jsxs(w,{className:"border-border",children:[e.jsx(d,{className:"text-foreground",children:"User"}),e.jsx(d,{className:"text-foreground",children:"Email"}),e.jsx(d,{className:"text-foreground",children:"Roles"}),e.jsx(d,{className:"text-foreground",children:"Created"}),e.jsx(d,{className:"text-foreground w-[50px]",children:"Actions"})]})}),e.jsx(le,{children:i.map(s=>{const c=t("view users")||t("edit users")||t("delete users")||t("view analytics");return e.jsxs(w,{className:"border-border hover:bg-accent/50",children:[e.jsx(m,{children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs(_,{className:"w-8 h-8",children:[typeof s.avatar_url=="string"&&s.avatar_url.trim()!==""&&e.jsx(S,{src:s.avatar_url,alt:s.name||"User avatar",className:"object-cover"}),e.jsx(E,{className:"bg-primary text-primary-foreground text-sm",children:s.name.charAt(0).toUpperCase()})]}),e.jsx("div",{children:e.jsx("p",{className:"text-sm font-medium text-foreground",children:s.name})})]})}),e.jsx(m,{className:"text-foreground",children:s.email}),e.jsx(m,{children:e.jsxs("div",{className:"flex gap-1 flex-wrap",children:[s.roles.slice(0,2).map(x=>e.jsx(C,{variant:"secondary",className:"text-xs",children:x.name},x.id)),s.roles.length>2&&e.jsxs(C,{variant:"outline",className:"text-xs",children:["+",s.roles.length-2]})]})}),e.jsx(m,{className:"text-muted-foreground",children:new Date(s.created_at).toLocaleDateString()}),e.jsx(m,{children:c?e.jsxs(M,{children:[e.jsx(I,{asChild:!0,children:e.jsx(D,{variant:"ghost",className:"h-8 w-8 p-0 hover:bg-accent",children:e.jsx(ne,{className:"h-4 w-4"})})}),e.jsxs(B,{align:"end",className:"bg-popover border-border",children:[t("view users")&&e.jsx(g,{asChild:!0,className:"hover:bg-accent hover:text-accent-foreground",children:e.jsxs(p,{to:`/users/${s.id}`,className:"flex items-center",children:[e.jsx(ie,{className:"mr-2 h-4 w-4"}),"View"]})}),t("view analytics")&&e.jsx(g,{asChild:!0,className:"hover:bg-accent hover:text-accent-foreground",children:e.jsxs(p,{to:`/analytics/users/${s.id}`,className:"flex items-center",children:[e.jsx(ce,{className:"mr-2 h-4 w-4"}),"User Analytics"]})}),t("edit users")&&e.jsx(g,{asChild:!0,className:"hover:bg-accent hover:text-accent-foreground",children:e.jsxs(p,{to:`/users/${s.id}/edit`,className:"flex items-center",children:[e.jsx(oe,{className:"mr-2 h-4 w-4"}),"Edit"]})}),t("delete users")&&e.jsxs(g,{onClick:()=>j(s.id),className:"text-destructive hover:bg-destructive hover:text-destructive-foreground",children:[e.jsx(de,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]}):e.jsx("span",{className:"text-muted-foreground text-xs",children:"No actions"})})]},s.id)})})]})})},_e=()=>{const{users:i,pagination:a,isLoading:j,deleteUser:t,goToPage:s,nextPage:c,prevPage:x}=se(),{searchQuery:P,setSearchQuery:T}=re(),{hasPermission:v}=A(),[f,o]=L.useState(null),k=async()=>{if(!v("delete users")){o(null);return}f&&(await t(f),o(null))},U=()=>{if(!a)return[];const r=[],{current_page:l,last_page:h}=a;l>3&&(r.push(1),l>4&&r.push("ellipsis-start"));for(let N=Math.max(1,l-2);N<=Math.min(h,l+2);N++)r.push(N);return l<h-2&&(l<h-3&&r.push("ellipsis-end"),r.push(h)),r};return e.jsxs("div",{className:"min-h-screen flex flex-col",children:[e.jsxs("div",{className:"flex-1 space-y-6 p-4 md:p-6 max-w-full",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(y,{className:"w-6 h-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground font-sans",children:"Users"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage system users and their permissions"})]})]}),v("create users")&&e.jsx(D,{asChild:!0,className:"bg-primary text-primary-foreground hover:bg-primary/90",children:e.jsxs(p,{to:"/users/create",children:[e.jsx(me,{className:"mr-2 h-4 w-4"}),"Add User"]})})]}),e.jsx(n,{className:"bg-card border-border",children:e.jsx(u,{className:"p-4 space-y-3",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"relative lg:col-span-2",children:[e.jsx(xe,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(R,{placeholder:"Search users (name, email, role)â€¦",value:P,onChange:r=>T(r.target.value),className:"pl-10 bg-background border-input text-foreground"})]}),e.jsx("div",{className:"hidden lg:block"}),e.jsx("div",{className:"hidden lg:block"})]})})}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs(n,{className:"bg-card border-border",children:[e.jsxs(H,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(F,{className:"text-sm font-medium text-muted-foreground",children:"Total Users"}),e.jsx(y,{className:"w-4 h-4 text-chart-1"})]}),e.jsx(u,{children:e.jsx("div",{className:"text-2xl font-bold text-foreground",children:a?.total||i.length||0})})]}),e.jsx("div",{className:"hidden sm:block",children:e.jsx(n,{className:"bg-card border-border h-full opacity-0 pointer-events-none"})}),e.jsx("div",{className:"hidden lg:block",children:e.jsx(n,{className:"bg-card border-border h-full opacity-0 pointer-events-none"})}),e.jsx("div",{className:"hidden lg:block",children:e.jsx(n,{className:"bg-card border-border h-full opacity-0 pointer-events-none"})})]}),e.jsx(n,{className:"bg-card border-border flex-1 flex flex-col min-h-0",children:e.jsx(u,{className:"p-0 flex-1 flex flex-col min-h-0",children:e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsx(he,{users:i,isLoading:j,onDelete:async r=>o(r)})})})}),a&&a.last_page>1&&e.jsx(n,{className:"bg-card border-border",children:e.jsx(u,{className:"p-3",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4",children:[e.jsxs("div",{className:"text-sm text-muted-foreground text-center sm:text-left",children:["Showing ",a.from||0," to ",a.to||0," of ",a.total||0," results"]}),e.jsx($,{children:e.jsxs(q,{children:[e.jsx(b,{children:e.jsx(Q,{onClick:x,className:a.current_page===1?"pointer-events-none opacity-50":"cursor-pointer"})}),U().map((r,l)=>e.jsx(b,{children:r==="ellipsis-start"||r==="ellipsis-end"?e.jsx(z,{}):e.jsx(O,{onClick:()=>s(r),isActive:a.current_page===r,className:"cursor-pointer",children:r})},l)),e.jsx(b,{children:e.jsx(V,{onClick:c,className:a.current_page===a.last_page?"pointer-events-none opacity-50":"cursor-pointer"})})]})})]})})})]}),e.jsx(G,{open:!!f,onOpenChange:r=>!r&&o(null),children:e.jsxs(J,{className:"sm:max-w-[480px]",children:[e.jsxs(K,{children:[e.jsx(W,{children:"Delete user"}),e.jsx(X,{children:"Are you sure you want to delete this user? This action cannot be undone."})]}),e.jsxs(Y,{children:[e.jsx(Z,{onClick:()=>o(null),children:"Cancel"}),e.jsx(ee,{onClick:k,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete"})]})]})})]})};export{_e as default};
