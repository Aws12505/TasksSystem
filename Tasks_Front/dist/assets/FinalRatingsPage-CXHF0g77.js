import{g as he,h as w,i as ge,t as f,D as m,j as e,C as S,c as L,d as T,e as H,f as q,I as N,r as me,v as xe,w as pe,x as fe,y as je,B as C,L as E,ag as Q,aU as _e,ai as ve,aj as X,al as be,aZ as Ne,a_ as ke,W as Y,ax as O,az as U,aA as G,aB as K,b6 as ee,V as se,b7 as te,b8 as ae,A as ye,p as Ce,q as we,b9 as Fe,a1 as Se}from"./index-BpYXyGyg.js";import{T as I,a as z,b as k,c as y}from"./tabs-D_uEvD7N.js";import{L as u}from"./label-Ct-uavZv.js";import{C as V}from"./calculator-CI_9YgYF.js";import{B as R}from"./badge-BNmpcbkq.js";import{A as qe,a as Re,b as De,c as Le,d as Te,e as Ee,f as Pe,g as Ae}from"./alert-dialog-D8qUWLR0.js";import{S as M}from"./settings-c2dFtCYU.js";import{C as Z}from"./circle-check-big-B7x9zUoj.js";import{S as Me}from"./square-pen-sOdHvJIT.js";import{T as He}from"./trash-2-Bwklm-SU.js";import{f as W}from"./format-C-V0FnqD.js";import{P as Oe}from"./progress-B7_DzQCP.js";import{T as $}from"./trending-up-PVCGbMgr.js";import{C as Ue}from"./calendar-Cj1gDPbC.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],re=he("file-text",Ie);class ze{async calculateRatings(s){return w.post("/final-ratings/calculate",s)}async exportPdf(s){return w.downloadFile("/final-ratings/export-pdf",s)}async getConfigs(){return w.get("/final-ratings/configs")}async getConfig(s){return w.get(`/final-ratings/configs/${s}`)}async getActiveConfig(){return w.get("/final-ratings/configs/active")}async getDefaultStructure(){return w.get("/final-ratings/configs/default-structure")}async createConfig(s){return w.post("/final-ratings/configs",s)}async updateConfig(s,t){return w.put(`/final-ratings/configs/${s}`,t)}async deleteConfig(s){return w.delete(`/final-ratings/configs/${s}`)}async activateConfig(s){return w.post(`/final-ratings/configs/${s}/activate`)}}const F=new ze,ie=ge(r=>({configs:[],activeConfig:null,currentConfig:null,defaultStructure:null,calculationResult:null,isLoading:!1,isExporting:!1,error:null,fetchConfigs:async()=>{r({isLoading:!0,error:null});try{const s=await F.getConfigs();s.success&&s.data?r({configs:s.data,isLoading:!1}):(r({error:s.message||"Failed to fetch configs",isLoading:!1}),f.error(s.message||"Failed to fetch configs"))}catch(s){const t=s.message||"Failed to fetch configs";r({error:t,isLoading:!1}),f.error(t)}},fetchConfig:async s=>{r({isLoading:!0,error:null});try{const t=await F.getConfig(s);t.success&&t.data?r({currentConfig:t.data,isLoading:!1}):(r({error:t.message||"Failed to fetch config",isLoading:!1}),f.error(t.message||"Failed to fetch config"))}catch(t){const n=t.message||"Failed to fetch config";r({error:n,isLoading:!1}),f.error(n)}},fetchActiveConfig:async()=>{r({isLoading:!0,error:null});try{const s=await F.getActiveConfig();s.success&&s.data?r({activeConfig:s.data,isLoading:!1}):r({error:s.message||"No active config found",isLoading:!1})}catch(s){const t=s.message||"Failed to fetch active config";r({error:t,isLoading:!1})}},fetchDefaultStructure:async()=>{try{const s=await F.getDefaultStructure();s.success&&s.data&&r({defaultStructure:s.data})}catch(s){f.error(s.message||"Failed to fetch default structure")}},createConfig:async s=>{r({isLoading:!0,error:null});try{const t=await F.createConfig(s);return t.success&&t.data?(r(n=>({configs:[t.data,...n.configs],isLoading:!1})),f.success("Configuration created successfully"),t.data):(r({error:t.message||"Failed to create config",isLoading:!1}),f.error(t.message||"Failed to create config"),null)}catch(t){const n=t.message||"Failed to create config";return r({error:n,isLoading:!1}),f.error(n),null}},updateConfig:async(s,t)=>{r({isLoading:!0,error:null});try{const n=await F.updateConfig(s,t);return n.success&&n.data?(r(d=>({configs:d.configs.map(o=>o.id===s?n.data:o),currentConfig:d.currentConfig?.id===s?n.data:d.currentConfig,isLoading:!1})),f.success("Configuration updated successfully"),n.data):(r({error:n.message||"Failed to update config",isLoading:!1}),f.error(n.message||"Failed to update config"),null)}catch(n){const d=n.message||"Failed to update config";return r({error:d,isLoading:!1}),f.error(d),null}},deleteConfig:async s=>{r({isLoading:!0,error:null});try{const t=await F.deleteConfig(s);return t.success?(r(n=>({configs:n.configs.filter(d=>d.id!==s),currentConfig:n.currentConfig?.id===s?null:n.currentConfig,isLoading:!1})),f.success("Configuration deleted successfully"),!0):(r({error:t.message||"Failed to delete config",isLoading:!1}),f.error(t.message||"Failed to delete config"),!1)}catch(t){const n=t.message||"Failed to delete config";return r({error:n,isLoading:!1}),f.error(n),!1}},activateConfig:async s=>{r({isLoading:!0,error:null});try{const t=await F.activateConfig(s);return t.success&&t.data?(r(n=>({configs:n.configs.map(d=>({...d,is_active:d.id===s})),activeConfig:t.data,isLoading:!1})),f.success("Configuration activated successfully"),!0):(r({error:t.message||"Failed to activate config",isLoading:!1}),f.error(t.message||"Failed to activate config"),!1)}catch(t){const n=t.message||"Failed to activate config";return r({error:n,isLoading:!1}),f.error(n),!1}},calculateRatings:async s=>{r({isLoading:!0,error:null});try{const t=await F.calculateRatings(s);return t.success&&t.data?(r({calculationResult:t.data,isLoading:!1}),f.success("Ratings calculated successfully"),t.data):(r({error:t.message||"Failed to calculate ratings",isLoading:!1}),f.error(t.message||"Failed to calculate ratings"),null)}catch(t){const n=t.message||"Failed to calculate ratings";return r({error:n,isLoading:!1}),f.error(n),null}},exportPdf:async s=>{r({isExporting:!0,error:null});try{const{blob:t,filename:n}=await F.exportPdf(s),d=window.URL.createObjectURL(t),o=document.createElement("a");o.href=d,o.download=n,document.body.appendChild(o),o.click(),document.body.removeChild(o),window.URL.revokeObjectURL(d),r({isExporting:!1}),f.success("PDF package exported successfully")}catch(t){const n=t.message||"Failed to export PDF";r({error:n,isExporting:!1}),f.error(n)}},clearCalculationResult:()=>r({calculationResult:null,error:null}),clearCurrentConfig:()=>r({currentConfig:null,error:null})})),P=()=>{const{configs:r,activeConfig:s,currentConfig:t,defaultStructure:n,calculationResult:d,isLoading:o,isExporting:g,error:x,fetchConfigs:i,fetchActiveConfig:l,fetchDefaultStructure:p,createConfig:c,updateConfig:a,deleteConfig:_,activateConfig:v,calculateRatings:b,exportPdf:h,clearCalculationResult:D,clearCurrentConfig:J}=ie();return m.useEffect(()=>{r.length===0&&i(),s||l()},[]),{configs:r,activeConfig:s,currentConfig:t,defaultStructure:n,calculationResult:d,isLoading:o,isExporting:g,error:x,fetchConfigs:i,fetchActiveConfig:l,fetchDefaultStructure:p,createConfig:c,updateConfig:a,deleteConfig:_,activateConfig:v,calculateRatings:b,exportPdf:h,clearCalculationResult:D,clearCurrentConfig:J}},Be=()=>{const{configs:r,activeConfig:s,isLoading:t,calculateRatings:n,fetchActiveConfig:d}=P(),[o,g]=m.useState({period_start:"",period_end:"",max_points:"",config_id:""});m.useEffect(()=>{s||d()},[s,d]),m.useEffect(()=>{s&&!o.config_id&&g(l=>({...l,config_id:s.id.toString()}))},[s,o.config_id]);const x=async l=>{if(l.preventDefault(),!o.period_start||!o.period_end||!o.max_points)return;if(await n({period_start:o.period_start,period_end:o.period_end,max_points:parseFloat(o.max_points),config_id:o.config_id?parseInt(o.config_id):void 0})){const c=document.querySelector('[value="results"]');c&&c.click()}},i=(l,p)=>{g(c=>({...c,[l]:p}))};return e.jsxs(S,{className:"bg-card border-border",children:[e.jsxs(L,{children:[e.jsxs(T,{className:"flex items-center gap-2",children:[e.jsx(V,{className:"w-5 h-5"}),"Calculate Final Ratings"]}),e.jsx(H,{children:"Select a period and specify the maximum points for 100% rating"})]}),e.jsx(q,{children:e.jsxs("form",{onSubmit:x,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"period_start",children:"Period Start"}),e.jsx(N,{id:"period_start",type:"date",value:o.period_start,onChange:l=>i("period_start",l.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"period_end",children:"Period End"}),e.jsx(N,{id:"period_end",type:"date",value:o.period_end,onChange:l=>i("period_end",l.target.value),required:!0,min:o.period_start})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(u,{htmlFor:"max_points",children:["Maximum Points for 100%",e.jsx("span",{className:"text-muted-foreground text-sm ml-2",children:"(How many points equals 100% rating?)"})]}),e.jsx(N,{id:"max_points",type:"number",step:"0.01",min:"1",value:o.max_points,onChange:l=>i("max_points",l.target.value),placeholder:"e.g., 200",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(u,{htmlFor:"config_id",children:["Rating Configuration",e.jsx("span",{className:"text-muted-foreground text-sm ml-2",children:"(Leave as active to use current default)"})]}),e.jsxs(me,{value:o.config_id,onValueChange:l=>i("config_id",l),children:[e.jsx(xe,{children:e.jsx(pe,{placeholder:"Select configuration"})}),e.jsx(fe,{children:r.map(l=>e.jsxs(je,{value:l.id.toString(),children:[l.name," ",l.is_active&&"(Active)"]},l.id))})]})]}),e.jsxs("div",{className:"bg-muted/50 border border-border rounded-lg p-4 space-y-2",children:[e.jsx("h4",{className:"font-medium text-sm",children:"How it works:"}),e.jsxs("ul",{className:"text-sm text-muted-foreground space-y-1 list-disc list-inside",children:[e.jsx("li",{children:"All employees with tasks in the selected period will be calculated"}),e.jsx("li",{children:"Each employee's percentage = (their total points / max points) × 100"}),e.jsx("li",{children:"Maximum percentage is capped at 100%"}),e.jsx("li",{children:"Results show full breakdown of how points were calculated"})]})]}),e.jsx(C,{type:"submit",className:"w-full",disabled:t,children:t?e.jsxs(e.Fragment,{children:[e.jsx(E,{className:"w-4 h-4 mr-2 animate-spin"}),"Calculating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(V,{className:"w-4 h-4 mr-2"}),"Calculate Ratings"]})})]})})]})};var B="Switch",[Je,ps]=ve(B),[Ve,We]=Je(B),ne=m.forwardRef((r,s)=>{const{__scopeSwitch:t,name:n,checked:d,defaultChecked:o,required:g,disabled:x,value:i="on",onCheckedChange:l,form:p,...c}=r,[a,_]=m.useState(null),v=Q(s,A=>_(A)),b=m.useRef(!1),h=a?p||!!a.closest("form"):!0,[D,J]=_e({prop:d,defaultProp:o??!1,onChange:l,caller:B});return e.jsxs(Ve,{scope:t,checked:D,disabled:x,children:[e.jsx(X.button,{type:"button",role:"switch","aria-checked":D,"aria-required":g,"data-state":oe(D),"data-disabled":x?"":void 0,disabled:x,value:i,...c,ref:v,onClick:be(r.onClick,A=>{J(ue=>!ue),h&&(b.current=A.isPropagationStopped(),b.current||A.stopPropagation())})}),h&&e.jsx(de,{control:a,bubbles:!b.current,name:n,value:i,checked:D,required:g,disabled:x,form:p,style:{transform:"translateX(-100%)"}})]})});ne.displayName=B;var le="SwitchThumb",ce=m.forwardRef((r,s)=>{const{__scopeSwitch:t,...n}=r,d=We(le,t);return e.jsx(X.span,{"data-state":oe(d.checked),"data-disabled":d.disabled?"":void 0,...n,ref:s})});ce.displayName=le;var $e="SwitchBubbleInput",de=m.forwardRef(({__scopeSwitch:r,control:s,checked:t,bubbles:n=!0,...d},o)=>{const g=m.useRef(null),x=Q(g,o),i=Ne(t),l=ke(s);return m.useEffect(()=>{const p=g.current;if(!p)return;const c=window.HTMLInputElement.prototype,_=Object.getOwnPropertyDescriptor(c,"checked").set;if(i!==t&&_){const v=new Event("click",{bubbles:n});_.call(p,t),p.dispatchEvent(v)}},[i,t,n]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:t,...d,tabIndex:-1,ref:x,style:{...d.style,...l,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});de.displayName=$e;function oe(r){return r?"checked":"unchecked"}var Ye=ne,Ze=ce;function j({className:r,...s}){return e.jsx(Ye,{"data-slot":"switch",className:Y("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",r),...s,children:e.jsx(Ze,{"data-slot":"switch-thumb",className:Y("bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})})}const Qe=r=>{const{currentConfig:s,isLoading:t,error:n,fetchConfig:d,updateConfig:o,clearCurrentConfig:g}=ie();return m.useEffect(()=>(r&&d(r),()=>{g()}),[r,d,g]),{config:s,isLoading:t,error:n,updateConfig:o}},Xe=({open:r,onOpenChange:s,configId:t})=>{const{config:n,isLoading:d,updateConfig:o}=Qe(t),[g,x]=m.useState({name:"",description:""}),[i,l]=m.useState(null);m.useEffect(()=>{n&&(x({name:n.name,description:n.description||""}),l(JSON.parse(JSON.stringify(n.config))))},[n]);const p=async a=>{if(a.preventDefault(),!i)return;await o(t,{...g,config:i})&&s(!1)},c=(a,_)=>{if(!i)return;const v=JSON.parse(JSON.stringify(i));let b=v;for(let h=0;h<a.length-1;h++)b=b[a[h]];b[a[a.length-1]]=_,l(v)};return d||!i?e.jsx(O,{open:r,onOpenChange:s,children:e.jsx(U,{children:e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(E,{className:"w-8 h-8 animate-spin"})})})}):e.jsx(O,{open:r,onOpenChange:s,children:e.jsxs(U,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(G,{children:[e.jsx(K,{children:"Edit Configuration"}),e.jsx(ee,{children:"Update the rating calculation configuration"})]}),e.jsxs("form",{onSubmit:p,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"name",children:"Configuration Name *"}),e.jsx(N,{id:"name",value:g.name,onChange:a=>x({...g,name:a.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"description",children:"Description"}),e.jsx(se,{id:"description",value:g.description,onChange:a=>x({...g,description:a.target.value}),rows:2})]})]}),e.jsx(te,{}),e.jsxs(I,{defaultValue:"task_ratings",className:"w-full",children:[e.jsxs(z,{className:"grid w-full grid-cols-3",children:[e.jsx(k,{value:"task_ratings",children:"Tasks"}),e.jsx(k,{value:"stakeholder",children:"Stakeholder"}),e.jsx(k,{value:"other",children:"Other"})]}),e.jsxs(y,{value:"task_ratings",className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(u,{htmlFor:"task_enabled",children:"Enable Task Ratings"}),e.jsx(j,{id:"task_enabled",checked:i.task_ratings.enabled,onCheckedChange:a=>c(["task_ratings","enabled"],a)})]}),i.task_ratings.enabled&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(u,{htmlFor:"task_weight",children:"Include Task Weight"}),e.jsx(j,{id:"task_weight",checked:i.task_ratings.include_task_weight,onCheckedChange:a=>c(["task_ratings","include_task_weight"],a)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(u,{htmlFor:"task_percentage",children:"Include User Assignment Percentage"}),e.jsx(j,{id:"task_percentage",checked:i.task_ratings.include_user_percentage,onCheckedChange:a=>c(["task_ratings","include_user_percentage"],a)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"task_aggregation",children:"Aggregation Method"}),e.jsxs("select",{id:"task_aggregation",className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm",value:i.task_ratings.aggregation,onChange:a=>c(["task_ratings","aggregation"],a.target.value),children:[e.jsx("option",{value:"sum",children:"Sum"}),e.jsx("option",{value:"average",children:"Average"})]})]})]})]}),e.jsxs(y,{value:"stakeholder",className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(u,{htmlFor:"stakeholder_enabled",children:"Enable Stakeholder Ratings"}),e.jsx(j,{id:"stakeholder_enabled",checked:i.stakeholder_ratings.enabled,onCheckedChange:a=>c(["stakeholder_ratings","enabled"],a)})]}),i.stakeholder_ratings.enabled&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(u,{htmlFor:"stakeholder_percentage",children:"Include Project Percentage"}),e.jsx(j,{id:"stakeholder_percentage",checked:i.stakeholder_ratings.include_project_percentage,onCheckedChange:a=>c(["stakeholder_ratings","include_project_percentage"],a)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(u,{htmlFor:"stakeholder_weight",children:"Include Task Weight"}),e.jsx(j,{id:"stakeholder_weight",checked:i.stakeholder_ratings.include_task_weight,onCheckedChange:a=>c(["stakeholder_ratings","include_task_weight"],a)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"stakeholder_aggregation",children:"Aggregation Method"}),e.jsxs("select",{id:"stakeholder_aggregation",className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm",value:i.stakeholder_ratings.aggregation,onChange:a=>c(["stakeholder_ratings","aggregation"],a.target.value),children:[e.jsx("option",{value:"sum",children:"Sum"}),e.jsx("option",{value:"average",children:"Average"})]})]})]})]}),e.jsxs(y,{value:"other",className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4 bg-muted/30 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(u,{htmlFor:"help_helper_enabled",children:"Help Requests (as Helper)"}),e.jsx(j,{id:"help_helper_enabled",checked:i.help_requests_helper.enabled,onCheckedChange:a=>c(["help_requests_helper","enabled"],a)})]}),i.help_requests_helper.enabled&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"points_per_help",children:"Points per Help"}),e.jsx(N,{id:"points_per_help",type:"number",step:"0.01",value:i.help_requests_helper.points_per_help,onChange:a=>c(["help_requests_helper","points_per_help"],parseFloat(a.target.value))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"helper_max_points",children:"Maximum Points"}),e.jsx(N,{id:"helper_max_points",type:"number",step:"0.01",value:i.help_requests_helper.max_points,onChange:a=>c(["help_requests_helper","max_points"],parseFloat(a.target.value))})]})]})]}),e.jsxs("div",{className:"space-y-4 bg-muted/30 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(u,{htmlFor:"help_requester_enabled",children:"Help Requests (as Requester)"}),e.jsx(j,{id:"help_requester_enabled",checked:i.help_requests_requester.enabled,onCheckedChange:a=>c(["help_requests_requester","enabled"],a)})]}),i.help_requests_requester.enabled&&e.jsxs("div",{className:"space-y-3",children:[e.jsx(u,{children:"Penalties by Request Type"}),Object.entries(i.help_requests_requester.penalties).map(([a,_])=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{className:"flex-1 capitalize",children:a.replace(/_/g," ")}),e.jsx(N,{type:"number",step:"0.01",className:"w-24",value:_,onChange:v=>c(["help_requests_requester","penalties",a],parseFloat(v.target.value))})]},a))]})]}),e.jsxs("div",{className:"space-y-4 bg-muted/30 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(u,{htmlFor:"tickets_enabled",children:"Tickets Resolved"}),e.jsx(j,{id:"tickets_enabled",checked:i.tickets_resolved.enabled,onCheckedChange:a=>c(["tickets_resolved","enabled"],a)})]}),i.tickets_resolved.enabled&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"points_per_ticket",children:"Points per Ticket"}),e.jsx(N,{id:"points_per_ticket",type:"number",step:"0.01",value:i.tickets_resolved.points_per_ticket,onChange:a=>c(["tickets_resolved","points_per_ticket"],parseFloat(a.target.value))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"tickets_max_points",children:"Maximum Points"}),e.jsx(N,{id:"tickets_max_points",type:"number",step:"0.01",value:i.tickets_resolved.max_points,onChange:a=>c(["tickets_resolved","max_points"],parseFloat(a.target.value))})]})]})]})]})]}),e.jsxs(ae,{children:[e.jsx(C,{type:"button",variant:"outline",onClick:()=>s(!1),children:"Cancel"}),e.jsx(C,{type:"submit",disabled:d,children:d?e.jsxs(e.Fragment,{children:[e.jsx(E,{className:"w-4 h-4 mr-2 animate-spin"}),"Updating..."]}):"Update Configuration"})]})]})]})})},Ge=()=>{const{configs:r,isLoading:s,deleteConfig:t,activateConfig:n}=P(),[d,o]=m.useState(!1),[g,x]=m.useState(null),[i,l]=m.useState(!1),[p,c]=m.useState(null),a=h=>{x(h),o(!0)},_=async()=>{g&&await t(g)&&(o(!1),x(null))},v=h=>{c(h),l(!0)},b=async h=>{await n(h)};return s&&r.length===0?e.jsx(S,{className:"bg-card border-border",children:e.jsx(q,{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"text-muted-foreground",children:"Loading configurations..."})})}):r.length===0?e.jsx(S,{className:"bg-card border-border",children:e.jsxs(q,{className:"flex flex-col items-center justify-center py-12 space-y-4",children:[e.jsx(M,{className:"w-12 h-12 text-muted-foreground"}),e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"font-semibold text-lg",children:"No configurations yet"}),e.jsx("p",{className:"text-muted-foreground",children:"Create your first rating configuration to get started"})]})]})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-4",children:r.map(h=>e.jsxs(S,{className:"bg-card border-border",children:[e.jsx(L,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{children:h.name}),h.is_active&&e.jsxs(R,{variant:"default",className:"gap-1",children:[e.jsx(Z,{className:"w-3 h-3"}),"Active"]})]}),h.description&&e.jsx(H,{children:h.description}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Created ",W(new Date(h.created_at),"MMM d, yyyy")]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[!h.is_active&&e.jsxs(C,{variant:"outline",size:"sm",onClick:()=>b(h.id),disabled:s,children:[e.jsx(Z,{className:"w-4 h-4 mr-1"}),"Activate"]}),e.jsx(C,{variant:"outline",size:"sm",onClick:()=>v(h.id),children:e.jsx(Me,{className:"w-4 h-4"})}),e.jsx(C,{variant:"outline",size:"sm",onClick:()=>a(h.id),disabled:h.is_active||s,children:e.jsx(He,{className:"w-4 h-4"})})]})]})}),e.jsx(q,{children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-muted-foreground",children:"Task Ratings"}),e.jsx("div",{className:"font-medium",children:h.config.task_ratings.enabled?"✓ Enabled":"✗ Disabled"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-muted-foreground",children:"Stakeholder"}),e.jsx("div",{className:"font-medium",children:h.config.stakeholder_ratings.enabled?"✓ Enabled":"✗ Disabled"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-muted-foreground",children:"Help (Helper)"}),e.jsx("div",{className:"font-medium",children:h.config.help_requests_helper.enabled?"✓ Enabled":"✗ Disabled"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-muted-foreground",children:"Help (Requester)"}),e.jsx("div",{className:"font-medium",children:h.config.help_requests_requester.enabled?"✓ Enabled":"✗ Disabled"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-muted-foreground",children:"Tickets"}),e.jsx("div",{className:"font-medium",children:h.config.tickets_resolved.enabled?"✓ Enabled":"✗ Disabled"})]})]})})]},h.id))}),e.jsx(qe,{open:d,onOpenChange:o,children:e.jsxs(Re,{children:[e.jsxs(De,{children:[e.jsx(Le,{children:"Are you sure?"}),e.jsx(Te,{children:"This will permanently delete this configuration. This action cannot be undone."})]}),e.jsxs(Ee,{children:[e.jsx(Pe,{children:"Cancel"}),e.jsx(Ae,{onClick:_,className:"bg-destructive",children:"Delete"})]})]})}),p&&e.jsx(Xe,{open:i,onOpenChange:l,configId:p})]})},Ke=({user:r})=>{const{breakdown:s}=r;return e.jsxs("div",{className:"space-y-6 mt-4",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-3",children:[s.task_ratings.enabled&&e.jsxs("div",{className:"bg-muted/50 rounded-lg p-3 space-y-1",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Task Ratings"}),e.jsxs("div",{className:"text-lg font-bold text-blue-600",children:["+",s.task_ratings.value]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[s.task_ratings.tasks_included," tasks"]})]}),s.stakeholder_ratings.enabled&&e.jsxs("div",{className:"bg-muted/50 rounded-lg p-3 space-y-1",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Stakeholder"}),e.jsxs("div",{className:"text-lg font-bold text-purple-600",children:["+",s.stakeholder_ratings.value]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[s.stakeholder_ratings.projects_included," projects"]})]}),s.help_requests.helper.enabled&&e.jsxs("div",{className:"bg-muted/50 rounded-lg p-3 space-y-1",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Helped Others"}),e.jsxs("div",{className:"text-lg font-bold text-green-600",children:["+",s.help_requests.helper.value]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[s.help_requests.helper.count," times"]})]}),s.help_requests.requester.enabled&&e.jsxs("div",{className:"bg-muted/50 rounded-lg p-3 space-y-1",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Help Requests"}),e.jsx("div",{className:"text-lg font-bold text-red-600",children:s.help_requests.requester.value}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"penalties"})]}),s.tickets_resolved.enabled&&e.jsxs("div",{className:"bg-muted/50 rounded-lg p-3 space-y-1",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Tickets"}),e.jsxs("div",{className:"text-lg font-bold text-indigo-600",children:["+",s.tickets_resolved.value]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[s.tickets_resolved.count," resolved"]})]})]}),e.jsxs(I,{defaultValue:"tasks",className:"w-full",children:[e.jsxs(z,{className:"grid w-full grid-cols-2 md:grid-cols-4",children:[s.task_ratings.enabled&&e.jsx(k,{value:"tasks",children:"Tasks"}),s.stakeholder_ratings.enabled&&e.jsx(k,{value:"stakeholder",children:"Stakeholder"}),s.help_requests.helper.enabled&&e.jsx(k,{value:"help",children:"Help"}),s.tickets_resolved.enabled&&e.jsx(k,{value:"tickets",children:"Tickets"})]}),s.task_ratings.enabled&&e.jsxs(y,{value:"tasks",className:"space-y-3",children:[e.jsxs("div",{className:"text-sm text-muted-foreground mb-2",children:["Aggregation: ",s.task_ratings.aggregation," • Weight: ",s.task_ratings.include_task_weight?"Included":"Excluded"," • Percentage: ",s.task_ratings.include_user_percentage?"Included":"Excluded"]}),s.task_ratings.details.map(t=>e.jsxs("div",{className:"bg-muted/30 rounded-lg p-3 space-y-2",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:t.task_name}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["Rating: ",t.task_rating,"/100",t.task_weight&&` • Weight: ${t.task_weight}/100`,t.user_percentage&&` • Your %: ${t.user_percentage}%`]})]}),e.jsxs(R,{variant:"outline",className:"text-blue-600",children:["+",t.contribution]})]}),e.jsx("div",{className:"text-xs font-mono text-muted-foreground bg-background/50 p-2 rounded",children:t.calculation})]},t.task_id))]}),s.stakeholder_ratings.enabled&&e.jsxs(y,{value:"stakeholder",className:"space-y-3",children:[e.jsxs("div",{className:"text-sm text-muted-foreground mb-2",children:["Aggregation: ",s.stakeholder_ratings.aggregation]}),s.stakeholder_ratings.details.map(t=>e.jsxs("div",{className:"bg-muted/30 rounded-lg p-3 space-y-2",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:t.project_name}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["Stakeholder Rating: ",t.stakeholder_rating,"/100",t.user_project_percentage&&` • Your Project %: ${t.user_project_percentage}%`]})]}),e.jsxs(R,{variant:"outline",className:"text-purple-600",children:["+",t.contribution]})]}),e.jsx("div",{className:"text-xs font-mono text-muted-foreground bg-background/50 p-2 rounded",children:t.calculation})]},t.project_id))]}),s.help_requests.helper.enabled&&e.jsxs(y,{value:"help",className:"space-y-3",children:[e.jsxs("div",{className:"bg-muted/30 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"font-medium",children:"Helped Others"}),e.jsxs(R,{variant:"outline",className:"text-green-600",children:["+",s.help_requests.helper.value]})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Completed ",s.help_requests.helper.count," help requests × ",s.help_requests.helper.points_per_help," points each",s.help_requests.helper.capped&&e.jsxs("div",{className:"text-xs text-orange-600 mt-1",children:["(Capped at ",s.help_requests.helper.max_points," points maximum)"]})]})]}),s.help_requests.requester.enabled&&Object.keys(s.help_requests.requester.breakdown).length>0&&e.jsxs("div",{className:"bg-muted/30 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"font-medium",children:"Requested Help"}),e.jsx(R,{variant:"outline",className:"text-red-600",children:s.help_requests.requester.value})]}),e.jsx("div",{className:"space-y-2",children:Object.entries(s.help_requests.requester.breakdown).map(([t,n])=>e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"capitalize",children:t.replace(/_/g," ")}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[n.count," requests × ",n.penalty_per_request," points"]})]}),e.jsx("div",{className:"text-red-600 font-medium",children:n.total})]},t))})]})]}),s.tickets_resolved.enabled&&e.jsx(y,{value:"tickets",className:"space-y-3",children:e.jsxs("div",{className:"bg-muted/30 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"font-medium",children:"Tickets Resolved"}),e.jsxs(R,{variant:"outline",className:"text-indigo-600",children:["+",s.tickets_resolved.value]})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Resolved ",s.tickets_resolved.count," tickets × ",s.tickets_resolved.points_per_ticket," points each",s.tickets_resolved.capped&&e.jsxs("div",{className:"text-xs text-orange-600 mt-1",children:["(Capped at ",s.tickets_resolved.max_points," points maximum)"]})]})]})})]})]})},es=({result:r})=>{const[s,t]=m.useState(null),{exportPdf:n,isExporting:d}=P(),o=l=>{t(s===l?null:l)},g=()=>{n({period_start:r.period.start,period_end:r.period.end,max_points:r.max_points_for_100_percent,config_id:r.config.id})},x=l=>l>=90?"text-green-600":l>=75?"text-blue-600":l>=60?"text-yellow-600":"text-red-600",i=l=>l.split(" ").map(p=>p[0]).join("").toUpperCase().slice(0,2);return r?!r.users||r.users.length===0?e.jsx(S,{className:"bg-card border-border",children:e.jsx(q,{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"text-muted-foreground",children:"No employees found in this period"})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(S,{className:"bg-card border-border",children:[e.jsx(L,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs(T,{className:"flex items-center gap-2",children:[e.jsx($,{className:"w-5 h-5"}),"Rating Results"]}),e.jsxs(H,{className:"flex items-center gap-2",children:[e.jsx(Ue,{className:"w-4 h-4"}),W(new Date(r.period.start),"MMM d, yyyy")," -"," ",W(new Date(r.period.end),"MMM d, yyyy")]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(C,{variant:"outline",onClick:g,disabled:d,children:d?e.jsxs(e.Fragment,{children:[e.jsx(E,{className:"w-4 h-4 mr-2 animate-spin"}),"Exporting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(re,{className:"w-4 h-4 mr-2"}),"Export PDF"]})})})]})}),e.jsx(q,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Employees"}),e.jsx("div",{className:"text-2xl font-bold",children:r.users.length})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Config Used"}),e.jsx("div",{className:"text-lg font-medium",children:r.config.name})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Max Points for 100%"}),e.jsx("div",{className:"text-2xl font-bold",children:r.max_points_for_100_percent})]})]})})]}),e.jsx("div",{className:"space-y-3",children:r.users.sort((l,p)=>p.final_percentage-l.final_percentage).map(l=>e.jsxs(S,{className:"bg-card border-border",children:[e.jsxs(L,{className:"cursor-pointer",onClick:()=>o(l.user_id),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsxs(ye,{className:"h-12 w-12 border-2 border-border",children:[e.jsx(Ce,{src:l.avatar_url||void 0,alt:l.user_name}),e.jsx(we,{className:"bg-primary text-primary-foreground font-semibold",children:i(l.user_name)})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(T,{className:"text-lg",children:l.user_name}),e.jsxs(R,{variant:"outline",className:x(l.final_percentage),children:[l.final_percentage,"%"]})]}),e.jsx(H,{children:l.user_email})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Points"}),e.jsxs("div",{className:"text-lg font-bold",children:[l.total_points," / ",l.max_points]})]}),e.jsx(C,{variant:"ghost",size:"sm",children:s===l.user_id?e.jsx(Fe,{className:"w-4 h-4"}):e.jsx(Se,{className:"w-4 h-4"})})]})]}),e.jsx("div",{className:"mt-4",children:e.jsx(Oe,{value:l.final_percentage,className:"h-2"})})]}),s===l.user_id&&e.jsx(q,{className:"pt-0",children:e.jsx(Ke,{user:l})})]},l.user_id))})]}):e.jsx(S,{className:"bg-card border-border",children:e.jsx(q,{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"text-muted-foreground",children:"No results to display"})})})},ss=({open:r,onOpenChange:s})=>{const{defaultStructure:t,isLoading:n,createConfig:d,fetchDefaultStructure:o}=P(),[g,x]=m.useState({name:"",description:"",is_active:!1}),[i,l]=m.useState(null);m.useEffect(()=>{r&&!t&&o()},[r,t,o]),m.useEffect(()=>{t&&!i&&l(JSON.parse(JSON.stringify(t)))},[t,i]);const p=async a=>{if(a.preventDefault(),!i)return;await d({...g,config:i})&&(s(!1),x({name:"",description:"",is_active:!1}),l(null))},c=(a,_)=>{if(!i)return;const v=JSON.parse(JSON.stringify(i));let b=v;for(let h=0;h<a.length-1;h++)b=b[a[h]];b[a[a.length-1]]=_,l(v)};return i?e.jsx(O,{open:r,onOpenChange:s,children:e.jsxs(U,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(G,{children:[e.jsx(K,{children:"Create New Configuration"}),e.jsx(ee,{children:"Configure how ratings are calculated for different components"})]}),e.jsxs("form",{onSubmit:p,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"name",children:"Configuration Name *"}),e.jsx(N,{id:"name",value:g.name,onChange:a=>x({...g,name:a.target.value}),placeholder:"Q1 2025 Performance Rating",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"description",children:"Description"}),e.jsx(se,{id:"description",value:g.description,onChange:a=>x({...g,description:a.target.value}),placeholder:"Optional description of this configuration",rows:2})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(j,{id:"is_active",checked:g.is_active,onCheckedChange:a=>x({...g,is_active:a})}),e.jsx(u,{htmlFor:"is_active",children:"Set as active configuration"})]})]}),e.jsx(te,{}),e.jsxs(I,{defaultValue:"task_ratings",className:"w-full",children:[e.jsxs(z,{className:"grid w-full grid-cols-3",children:[e.jsx(k,{value:"task_ratings",children:"Tasks"}),e.jsx(k,{value:"stakeholder",children:"Stakeholder"}),e.jsx(k,{value:"other",children:"Other"})]}),e.jsxs(y,{value:"task_ratings",className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(u,{htmlFor:"task_enabled",children:"Enable Task Ratings"}),e.jsx(j,{id:"task_enabled",checked:i.task_ratings.enabled,onCheckedChange:a=>c(["task_ratings","enabled"],a)})]}),i.task_ratings.enabled&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(u,{htmlFor:"task_weight",children:"Include Task Weight"}),e.jsx(j,{id:"task_weight",checked:i.task_ratings.include_task_weight,onCheckedChange:a=>c(["task_ratings","include_task_weight"],a)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(u,{htmlFor:"task_percentage",children:"Include User Assignment Percentage"}),e.jsx(j,{id:"task_percentage",checked:i.task_ratings.include_user_percentage,onCheckedChange:a=>c(["task_ratings","include_user_percentage"],a)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"task_aggregation",children:"Aggregation Method"}),e.jsxs("select",{id:"task_aggregation",className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm",value:i.task_ratings.aggregation,onChange:a=>c(["task_ratings","aggregation"],a.target.value),children:[e.jsx("option",{value:"sum",children:"Sum"}),e.jsx("option",{value:"average",children:"Average"})]})]})]})]}),e.jsxs(y,{value:"stakeholder",className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(u,{htmlFor:"stakeholder_enabled",children:"Enable Stakeholder Ratings"}),e.jsx(j,{id:"stakeholder_enabled",checked:i.stakeholder_ratings.enabled,onCheckedChange:a=>c(["stakeholder_ratings","enabled"],a)})]}),i.stakeholder_ratings.enabled&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(u,{htmlFor:"stakeholder_percentage",children:"Include Project Percentage"}),e.jsx(j,{id:"stakeholder_percentage",checked:i.stakeholder_ratings.include_project_percentage,onCheckedChange:a=>c(["stakeholder_ratings","include_project_percentage"],a)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(u,{htmlFor:"stakeholder_weight",children:"Include Task Weight"}),e.jsx(j,{id:"stakeholder_weight",checked:i.stakeholder_ratings.include_task_weight,onCheckedChange:a=>c(["stakeholder_ratings","include_task_weight"],a)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"stakeholder_aggregation",children:"Aggregation Method"}),e.jsxs("select",{id:"stakeholder_aggregation",className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm",value:i.stakeholder_ratings.aggregation,onChange:a=>c(["stakeholder_ratings","aggregation"],a.target.value),children:[e.jsx("option",{value:"sum",children:"Sum"}),e.jsx("option",{value:"average",children:"Average"})]})]})]})]}),e.jsxs(y,{value:"other",className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4 bg-muted/30 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(u,{htmlFor:"help_helper_enabled",children:"Help Requests (as Helper)"}),e.jsx(j,{id:"help_helper_enabled",checked:i.help_requests_helper.enabled,onCheckedChange:a=>c(["help_requests_helper","enabled"],a)})]}),i.help_requests_helper.enabled&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"points_per_help",children:"Points per Help"}),e.jsx(N,{id:"points_per_help",type:"number",step:"0.01",value:i.help_requests_helper.points_per_help,onChange:a=>c(["help_requests_helper","points_per_help"],parseFloat(a.target.value))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"helper_max_points",children:"Maximum Points"}),e.jsx(N,{id:"helper_max_points",type:"number",step:"0.01",value:i.help_requests_helper.max_points,onChange:a=>c(["help_requests_helper","max_points"],parseFloat(a.target.value))})]})]})]}),e.jsxs("div",{className:"space-y-4 bg-muted/30 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(u,{htmlFor:"help_requester_enabled",children:"Help Requests (as Requester)"}),e.jsx(j,{id:"help_requester_enabled",checked:i.help_requests_requester.enabled,onCheckedChange:a=>c(["help_requests_requester","enabled"],a)})]}),i.help_requests_requester.enabled&&e.jsxs("div",{className:"space-y-3",children:[e.jsx(u,{children:"Penalties by Request Type"}),Object.entries(i.help_requests_requester.penalties).map(([a,_])=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{className:"flex-1 capitalize",children:a.replace(/_/g," ")}),e.jsx(N,{type:"number",step:"0.01",className:"w-24",value:_,onChange:v=>c(["help_requests_requester","penalties",a],parseFloat(v.target.value))})]},a))]})]}),e.jsxs("div",{className:"space-y-4 bg-muted/30 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(u,{htmlFor:"tickets_enabled",children:"Tickets Resolved"}),e.jsx(j,{id:"tickets_enabled",checked:i.tickets_resolved.enabled,onCheckedChange:a=>c(["tickets_resolved","enabled"],a)})]}),i.tickets_resolved.enabled&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"points_per_ticket",children:"Points per Ticket"}),e.jsx(N,{id:"points_per_ticket",type:"number",step:"0.01",value:i.tickets_resolved.points_per_ticket,onChange:a=>c(["tickets_resolved","points_per_ticket"],parseFloat(a.target.value))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"tickets_max_points",children:"Maximum Points"}),e.jsx(N,{id:"tickets_max_points",type:"number",step:"0.01",value:i.tickets_resolved.max_points,onChange:a=>c(["tickets_resolved","max_points"],parseFloat(a.target.value))})]})]})]})]})]}),e.jsxs(ae,{children:[e.jsx(C,{type:"button",variant:"outline",onClick:()=>s(!1),children:"Cancel"}),e.jsx(C,{type:"submit",disabled:n,children:n?e.jsxs(e.Fragment,{children:[e.jsx(E,{className:"w-4 h-4 mr-2 animate-spin"}),"Creating..."]}):"Create Configuration"})]})]})]})}):e.jsx(O,{open:r,onOpenChange:s,children:e.jsx(U,{children:e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(E,{className:"w-8 h-8 animate-spin"})})})})},fs=()=>{const{configs:r,activeConfig:s,calculationResult:t}=P(),[n,d]=m.useState(!1);return e.jsxs("div",{className:"min-h-screen flex flex-col",children:[e.jsxs("div",{className:"flex-1 space-y-6 p-4 md:p-6 max-w-full",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx($,{className:"w-6 h-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground font-sans",children:"Final Ratings"}),e.jsx("p",{className:"text-muted-foreground",children:"Calculate employee performance ratings for any period"})]})]}),e.jsxs(C,{onClick:()=>d(!0),children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),"New Config"]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs(S,{className:"bg-card border-border",children:[e.jsxs(L,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(T,{className:"text-sm font-medium text-muted-foreground",children:"Total Configs"}),e.jsx(M,{className:"w-4 h-4 text-chart-1"})]}),e.jsx(q,{children:e.jsx("div",{className:"text-2xl font-bold text-foreground",children:r.length})})]}),e.jsxs(S,{className:"bg-card border-border",children:[e.jsxs(L,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(T,{className:"text-sm font-medium text-muted-foreground",children:"Active Config"}),e.jsx(re,{className:"w-4 h-4 text-chart-2"})]}),e.jsx(q,{children:e.jsx("div",{className:"text-xl font-bold text-foreground truncate",children:s?.name||"None"})})]})]}),e.jsxs(I,{defaultValue:"calculate",className:"space-y-4",children:[e.jsxs(z,{className:"bg-muted",children:[e.jsxs(k,{value:"calculate",children:[e.jsx(V,{className:"w-4 h-4 mr-2"}),"Calculate Ratings"]}),e.jsxs(k,{value:"configs",children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),"Configurations"]}),t&&e.jsxs(k,{value:"results",children:[e.jsx($,{className:"w-4 h-4 mr-2"}),"Results"]})]}),e.jsx(y,{value:"calculate",children:e.jsx(Be,{})}),e.jsx(y,{value:"configs",children:e.jsx(Ge,{})}),t&&e.jsx(y,{value:"results",children:e.jsx(es,{result:t})})]})]}),e.jsx(ss,{open:n,onOpenChange:d})]})};export{fs as default};
