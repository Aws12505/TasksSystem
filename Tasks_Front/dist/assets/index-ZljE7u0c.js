import{q as S,j as e,D as B,v as L,B as P,w as M,x as i,y as v,n as A,W as E,S as x,p as I,I as _,M as F,N as R,O as H,P as V,Q as m}from"./index-MKnohTjv.js";import{C as h,d as u,a as p,b}from"./card-8_1dzKKu.js";import{u as q}from"./filtersStore-TdX14HxE.js";import{T as Q,a as $,b as T,c as n,d as W,e as c}from"./table-C78cXQxC.js";import{B as k}from"./badge-DqE4KNEo.js";import{T as O,a as z}from"./TaskPriorityBadge-D0NDZWgX.js";import{C as G}from"./calendar-CMBwQV2y.js";import{E as J}from"./ellipsis-4LZY-9Eu.js";import{E as K}from"./eye-DQ_z27sW.js";import{S as U}from"./square-pen-C5jXgUMa.js";import{T as X}from"./trash-2-DAP1IXRA.js";import{P as Y}from"./plus-CDMULtnA.js";const Z=({tasks:j,isLoading:w,onDelete:y,onStatusChange:g})=>{const{hasPermission:a,hasAnyPermission:o}=S();return w?e.jsx("div",{className:"space-y-4",children:Array.from({length:5}).map((s,d)=>e.jsx("div",{className:"h-16 bg-muted animate-pulse rounded-lg"},d))}):j.length===0?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-muted-foreground",children:"No tasks found in this section"})}):e.jsx("div",{className:"border border-border rounded-lg bg-card",children:e.jsxs(Q,{children:[e.jsx($,{children:e.jsxs(T,{className:"border-border",children:[e.jsx(n,{className:"text-foreground",children:"Task"}),e.jsx(n,{className:"text-foreground",children:"Status"}),e.jsx(n,{className:"text-foreground",children:"Priority"}),e.jsx(n,{className:"text-foreground",children:"Weight"}),e.jsx(n,{className:"text-foreground",children:"Due Date"}),e.jsx(n,{className:"text-foreground",children:"Subtasks"}),e.jsx(n,{className:"text-foreground w-[50px]",children:"Actions"})]})}),e.jsx(W,{children:j.map(s=>{const d=a("view tasks"),t=a("edit tasks"),f=a("delete tasks"),N=o(["create task ratings","edit task ratings"]),l=d||t||f||N;return e.jsxs(T,{className:"border-border hover:bg-accent/50",children:[e.jsx(c,{children:e.jsx("div",{className:"space-y-1",children:e.jsx("p",{className:"text-sm font-medium text-foreground",children:s.name})})}),e.jsx(c,{children:e.jsx(O,{status:s.status})}),e.jsx(c,{children:e.jsx(z,{priority:s.priority})}),e.jsx(c,{children:e.jsx(k,{variant:"outline",className:"text-xs",children:s.weight})}),e.jsx(c,{children:e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(G,{className:"w-4 h-4"}),new Date(s.due_date).toLocaleDateString()]})}),e.jsx(c,{children:e.jsxs(k,{variant:"secondary",className:"text-xs",children:[s.subtasks?.length||0," subtasks"]})}),e.jsx(c,{children:l?e.jsxs(B,{children:[e.jsx(L,{asChild:!0,children:e.jsx(P,{variant:"ghost",className:"h-8 w-8 p-0 hover:bg-accent",children:e.jsx(J,{className:"h-4 w-4"})})}),e.jsxs(M,{align:"end",className:"bg-popover border-border",children:[d&&e.jsx(i,{asChild:!0,className:"hover:bg-accent hover:text-accent-foreground",children:e.jsxs(v,{to:`/tasks/${s.id}`,className:"flex items-center",children:[e.jsx(K,{className:"mr-2 h-4 w-4"}),"View"]})}),t&&e.jsx(i,{asChild:!0,className:"hover:bg-accent hover:text-accent-foreground",children:e.jsxs(v,{to:`/tasks/${s.id}/edit`,className:"flex items-center",children:[e.jsx(U,{className:"mr-2 h-4 w-4"}),"Edit"]})}),N&&e.jsx(i,{asChild:!0,className:"hover:bg-accent hover:text-accent-foreground",children:e.jsxs(v,{to:`/ratings/tasks/${s.id}`,className:"flex items-center",children:[e.jsx(A,{className:"mr-2 h-4 w-4"}),"Rate Task"]})}),t&&e.jsxs(e.Fragment,{children:[e.jsx(i,{onClick:()=>g(s.id,"in_progress"),className:"hover:bg-accent hover:text-accent-foreground",disabled:s.status==="in_progress",children:"Mark In Progress"}),e.jsx(i,{onClick:()=>g(s.id,"done"),className:"hover:bg-accent hover:text-accent-foreground",disabled:s.status==="done",children:"Mark Complete"})]}),f&&e.jsxs(i,{onClick:()=>y(s.id),className:"text-destructive hover:bg-destructive hover:text-destructive-foreground",children:[e.jsx(X,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]}):e.jsx("span",{className:"text-muted-foreground text-xs",children:"No actions"})})]},s.id)})})]})})},me=()=>{const{tasks:j,isLoading:w,deleteTask:y,updateTaskStatus:g}=E(),{searchQuery:a,statusFilter:o,setSearchQuery:s,setStatusFilter:d}=q(),{hasPermission:t}=S(),f=async r=>{t("delete tasks")&&window.confirm("Are you sure you want to delete this task?")&&await y(r)},N=async(r,C)=>{t("edit tasks")&&await g(r,{status:C})},l=j.filter(r=>{const C=r.name.toLowerCase().includes(a.toLowerCase())||r.description?.toLowerCase().includes(a.toLowerCase()),D=o==="all"||r.status===o;return C&&D});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(x,{className:"w-6 h-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground font-sans",children:"Tasks"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your tasks and track progress"})]})]}),t("create tasks")&&e.jsx(P,{asChild:!0,className:"bg-primary text-primary-foreground hover:bg-primary/90",children:e.jsxs(v,{to:"/tasks/create",children:[e.jsx(Y,{className:"mr-2 h-4 w-4"}),"New Task"]})})]}),e.jsx(h,{className:"bg-card border-border",children:e.jsx(u,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1 max-w-sm",children:[e.jsx(I,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(_,{placeholder:"Search tasks...",value:a,onChange:r=>s(r.target.value),className:"pl-10 bg-background border-input text-foreground"})]}),e.jsxs(F,{value:o,onValueChange:d,children:[e.jsx(R,{className:"w-48",children:e.jsx(H,{placeholder:"Filter by status"})}),e.jsxs(V,{children:[e.jsx(m,{value:"all",children:"All Status"}),e.jsx(m,{value:"pending",children:"Pending"}),e.jsx(m,{value:"in_progress",children:"In Progress"}),e.jsx(m,{value:"done",children:"Done"}),e.jsx(m,{value:"rated",children:"Rated"})]})]})]})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs(h,{className:"bg-card border-border",children:[e.jsxs(p,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(b,{className:"text-sm font-medium text-muted-foreground",children:"Total Tasks"}),e.jsx(x,{className:"w-4 h-4 text-chart-1"})]}),e.jsx(u,{children:e.jsx("div",{className:"text-2xl font-bold text-foreground",children:l.length})})]}),e.jsxs(h,{className:"bg-card border-border",children:[e.jsxs(p,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(b,{className:"text-sm font-medium text-muted-foreground",children:"In Progress"}),e.jsx(x,{className:"w-4 h-4 text-chart-2"})]}),e.jsx(u,{children:e.jsx("div",{className:"text-2xl font-bold text-foreground",children:l.filter(r=>r.status==="in_progress").length})})]}),e.jsxs(h,{className:"bg-card border-border",children:[e.jsxs(p,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(b,{className:"text-sm font-medium text-muted-foreground",children:"Completed"}),e.jsx(x,{className:"w-4 h-4 text-chart-3"})]}),e.jsx(u,{children:e.jsx("div",{className:"text-2xl font-bold text-foreground",children:l.filter(r=>r.status==="done").length})})]}),e.jsxs(h,{className:"bg-card border-border",children:[e.jsxs(p,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(b,{className:"text-sm font-medium text-muted-foreground",children:"High Priority"}),e.jsx(x,{className:"w-4 h-4 text-chart-4"})]}),e.jsx(u,{children:e.jsx("div",{className:"text-2xl font-bold text-foreground",children:l.filter(r=>r.priority==="high"||r.priority==="critical").length})})]})]}),e.jsx(Z,{tasks:l,isLoading:w,onDelete:f,onStatusChange:N})]})};export{me as default};
