import{g as x,h as c,i as F,t as s}from"./index-Y4t2xSJ4.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=[["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M14 2v2",key:"6buw04"}],["path",{d:"M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1",key:"pwadti"}],["path",{d:"M6 2v2",key:"colzsn"}]],O=x("coffee",P);class ${async getInitialData(){return c.get("/clocking/initial-data")}async clockIn(){return c.post("/clocking/clock-in")}async clockOut(){return c.post("/clocking/clock-out")}async startBreak(){return c.post("/clocking/break/start")}async endBreak(o){return c.post("/clocking/break/end",o)}async getRecords(o){return c.getPaginated("/clocking/records",o)}async exportRecords(o){return c.downloadFile("/clocking/export",o)}async getManagerInitialData(){return c.get("/clocking/manager/initial-data")}async getAllRecords(o){return c.getPaginated("/clocking/manager/all-records",o)}async exportAllRecords(o){return c.downloadFile("/clocking/manager/export-all",o)}async requestCorrection(o){return c.post("/clocking/correction-request",o)}async getPendingCorrections(){return c.get("/clocking/pending-corrections")}async getAllPendingCorrections(){return c.get("/clocking/manager/pending-corrections")}async handleCorrection(o,e){return c.post(`/clocking/manager/correction/${o}/handle`,e)}async directEditClockSession(o,e){return c.put(`/clocking/manager/session/${o}/edit`,e)}async directEditBreakRecord(o,e){return c.put(`/clocking/manager/break/${o}/edit`,e)}}const i=new $,z=F((n,o)=>({session:null,companyTimezone:"UTC",serverTimeUtc:"",records:[],recordsPagination:null,managerSessions:[],managerAllRecords:[],managerAllRecordsPagination:null,isLoading:!1,isExporting:!1,error:null,pendingCorrections:[],allPendingCorrections:[],correctionLoading:!1,correctionError:null,fetchInitialData:async()=>{try{const e=await i.getInitialData();e.success&&n({session:e.data.session,companyTimezone:e.data.company_timezone,serverTimeUtc:e.data.server_time_utc})}catch(e){console.error("Failed to fetch initial data:",e)}},updateSession:e=>{n({session:e.session,companyTimezone:e.company_timezone,serverTimeUtc:e.server_time_utc})},clockIn:async()=>{n({isLoading:!0,error:null});try{const e=await i.clockIn();e.success&&(s.success(e.message),o().updateSession(e.data))}catch(e){const r=e.response?.data?.message||"Failed to clock in";n({error:r}),s.error(r)}finally{n({isLoading:!1})}},clockOut:async()=>{n({isLoading:!0,error:null});try{const e=await i.clockOut();e.success&&(s.success(e.message),o().updateSession(e.data))}catch(e){const r=e.response?.data?.message||"Failed to clock out";n({error:r}),s.error(r)}finally{n({isLoading:!1})}},startBreak:async()=>{n({isLoading:!0,error:null});try{const e=await i.startBreak();e.success&&(s.success(e.message),o().updateSession(e.data))}catch(e){const r=e.response?.data?.message||"Failed to start break";n({error:r}),s.error(r)}finally{n({isLoading:!1})}},endBreak:async e=>{n({isLoading:!0,error:null});try{const r=await i.endBreak(e?{description:e}:void 0);r.success&&(s.success(r.message),o().updateSession(r.data))}catch(r){const t=r.response?.data?.message||"Failed to end break";n({error:t}),s.error(t)}finally{n({isLoading:!1})}},fetchRecords:async e=>{n({isLoading:!0,error:null});try{const r=await i.getRecords(e);r.success&&n({records:r.data,recordsPagination:r.pagination})}catch(r){const t=r.response?.data?.message||"Failed to fetch records";n({error:t}),s.error(t)}finally{n({isLoading:!1})}},exportRecords:async e=>{n({isExporting:!0});try{const r=await i.exportRecords(e),t=window.URL.createObjectURL(r.blob),a=document.createElement("a");a.href=t,a.download=r.filename,document.body.appendChild(a),a.click(),document.body.removeChild(a),window.URL.revokeObjectURL(t),s.success("Export downloaded successfully")}catch(r){s.error(r.response?.data?.message||"Export failed")}finally{n({isExporting:!1})}},fetchManagerInitialData:async()=>{n({isLoading:!0});try{const e=await i.getManagerInitialData();e.success&&n({managerSessions:e.data.sessions,companyTimezone:e.data.company_timezone,serverTimeUtc:e.data.server_time_utc})}catch(e){console.error("Failed to fetch manager data:",e)}finally{n({isLoading:!1})}},updateManagerSession:(e,r)=>{n(t=>{if(!r.session||r.session.status==="completed")return{managerSessions:t.managerSessions.filter(d=>d.session?.user_id!==e),serverTimeUtc:r.server_time_utc};const a=t.managerSessions.findIndex(d=>d.session?.user_id===e);if(a===-1)return{managerSessions:[...t.managerSessions,r],serverTimeUtc:r.server_time_utc};const l=[...t.managerSessions];return l[a]=r,{managerSessions:l,serverTimeUtc:r.server_time_utc}})},fetchManagerAllRecords:async e=>{n({isLoading:!0});try{const r=await i.getAllRecords(e);r.success&&n({managerAllRecords:r.data,managerAllRecordsPagination:r.pagination})}catch(r){console.error("Failed to fetch all records:",r)}finally{n({isLoading:!1})}},exportManagerRecords:async e=>{n({isExporting:!0});try{const r=await i.exportAllRecords(e),t=window.URL.createObjectURL(r.blob),a=document.createElement("a");a.href=t,a.download=r.filename,document.body.appendChild(a),a.click(),document.body.removeChild(a),window.URL.revokeObjectURL(t),s.success("Export downloaded successfully")}catch(r){s.error(r.response?.data?.message||"Export failed")}finally{n({isExporting:!1})}},clearError:()=>n({error:null}),requestCorrection:async e=>{n({correctionLoading:!0,correctionError:null});try{(await i.requestCorrection(e)).success&&(s.success("Correction request submitted"),await o().getPendingCorrections())}catch(r){const t=r.response?.data?.message||"Failed to submit correction";n({correctionError:t}),s.error(t)}finally{n({correctionLoading:!1})}},getPendingCorrections:async()=>{try{const e=await i.getPendingCorrections();e.success&&n({pendingCorrections:e.data})}catch(e){console.error("Failed to fetch corrections:",e)}},getAllPendingCorrections:async()=>{try{const e=await i.getAllPendingCorrections();e.success&&n({allPendingCorrections:e.data})}catch(e){console.error("Failed to fetch all corrections:",e)}},handleCorrection:async(e,r,t)=>{n({correctionLoading:!0,correctionError:null});try{(await i.handleCorrection(e,{action:r,admin_notes:t})).success&&(s.success(`Correction ${r}ed`),await o().getAllPendingCorrections())}catch(a){const l=a.response?.data?.message||"Failed to handle correction";n({correctionError:l}),s.error(l)}finally{n({correctionLoading:!1})}},directEditClockSession:async(e,r)=>{n({correctionLoading:!0,correctionError:null});try{(await i.directEditClockSession(e,r)).success&&(s.success("Session updated"),await o().fetchRecords())}catch(t){const a=t.response?.data?.message||"Failed to update session";n({correctionError:a}),s.error(a)}finally{n({correctionLoading:!1})}},directEditBreakRecord:async(e,r)=>{n({correctionLoading:!0,correctionError:null});try{(await i.directEditBreakRecord(e,r)).success&&(s.success("Break updated"),await o().fetchRecords())}catch(t){const a=t.response?.data?.message||"Failed to update break";n({correctionError:a}),s.error(a)}finally{n({correctionLoading:!1})}},clearCorrectionError:()=>{n({correctionError:null})}})),y=(n,o)=>{const e=new Date(n).getTime(),r=o?new Date(o).getTime():Date.now();return Math.floor((r-e)/1e3)},A=n=>n.reduce((o,e)=>o+y(e.break_start_utc,e.break_end_utc),0),q=(n,o,e)=>{const r=y(n,o),t=A(e);return Math.max(0,r-t)},J=n=>{const o=Math.floor(n/3600),e=Math.floor(n%3600/60),r=n%60;return`${String(o).padStart(2,"0")}:${String(e).padStart(2,"0")}:${String(r).padStart(2,"0")}`},j=(n,o)=>new Date(n).toLocaleString("en-US",{timeZone:o,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0}),N=({sessionDate:n,companyTimezone:o,utcFallback:e,locale:r="en-US"})=>{const t=n?.trim()??"",a=/^(\d{4})-(\d{2})-(\d{2})$/.exec(t);if(a){const[,l,d,p]=a;if(r==="en-US")return`${{"01":"Jan","02":"Feb","03":"Mar","04":"Apr","05":"May","06":"Jun","07":"Jul","08":"Aug","09":"Sep",10:"Oct",11:"Nov",12:"Dec"}[d]??d} ${parseInt(p,10)}, ${l}`;{const g=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],m=Math.max(1,Math.min(12,parseInt(d,10)))-1;return`${parseInt(p,10)} ${g[m]} ${l}`}}if(e){const l=new Date(e);return new Intl.DateTimeFormat(r,{timeZone:o,year:"numeric",month:"short",day:"numeric",hour12:!0}).format(l)}return t||""},Z=(n,o)=>{if(!n)return"";const[e,r]=n.split("T"),[t,a,l]=e.split("-"),[d,p]=r.split(":"),g=new Date(parseInt(t,10),parseInt(a,10)-1,parseInt(l,10),parseInt(d,10),parseInt(p,10),0),m=new Date(g),f=new Intl.DateTimeFormat("en-US",{timeZone:o,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).format(m),[h,k]=f.split(", "),[S,w,C]=h.split("/"),[T,L,D]=k.split(":"),E=new Date(parseInt(C,10),parseInt(S,10)-1,parseInt(w,10),parseInt(T,10),parseInt(L,10),parseInt(D,10)),_=m.getTime()-E.getTime(),u=new Date(g.getTime()+_),I=u.getUTCFullYear(),v=String(u.getUTCMonth()+1).padStart(2,"0"),R=String(u.getUTCDate()).padStart(2,"0"),M=String(u.getUTCHours()).padStart(2,"0"),U=String(u.getUTCMinutes()).padStart(2,"0"),b=String(u.getUTCSeconds()).padStart(2,"0");return`${I}-${v}-${R}T${M}:${U}:${b}Z`};export{O as C,y as a,Z as b,j as c,q as d,A as e,J as f,N as g,z as u};
