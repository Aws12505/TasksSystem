import{h as ve,r as R,a as we,b as ye,o as ke,j as e,F as Ce,c as X,d as Z,e as ee,M as ie,f as se,N as ce,O as de,P as oe,Q as me,g as ae,I as xe,B as j,L as Re,s as he,al as _e,q as Se,n as O,S as k,m as C,U as te,p as ge}from"./index-BoroKU0h.js";import{C as m,a as u,b as f,d as x}from"./card-Dihqd1Tq.js";import{T as Pe,a as Fe,b as re,c as le}from"./tabs-Ckn_9OXK.js";import{P as Te,a as Ae,b as ne,c as Le,d as De,e as Me,f as Ue}from"./pagination-BYrR7XPa.js";import{B as g}from"./badge-B-NgAhQH.js";import{u as Ve}from"./ratingsStore-Bw7XB-jJ.js";import{P as Ee}from"./progress-IEtkPirU.js";import{A as Oe,a as ze}from"./avatar-B2M6DRW0.js";import{C as je}from"./calendar-DVQKPfrD.js";import{T as pe}from"./trending-up-C3HJYFYf.js";import{C as Ie}from"./code-BFmbmxT6.js";import{R as $e,A as ue}from"./refresh-cw-DDdIKO2m.js";import{E as fe}from"./eye-CUJ6OUe8.js";import{C as Be}from"./circle-alert-CUpCIOto.js";import"./ellipsis-Kn7O6V0g.js";import"./ratingConfigService-Bv-NPdeM.js";import"./index-K4eLOgP3.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]],B=ve("calculator",qe),Ye=()=>{const{taskRatings:t,stakeholderRatings:r,finalRatings:n,taskRatingConfigs:p,stakeholderRatingConfigs:N,finalRatingConfigs:i,availableTasks:l,availableProjects:_,availableUsers:h,taskRatingsPagination:o,stakeholderRatingsPagination:b,finalRatingsPagination:c,isLoading:q,error:S,fetchTaskRatings:Y,fetchStakeholderRatings:U,fetchFinalRatings:z,fetchUserFinalRating:Q,fetchTaskRatingConfigs:I,fetchStakeholderRatingConfigs:V,fetchFinalRatingConfigs:v,fetchAvailableTasks:w,fetchAvailableProjects:y,fetchAvailableUsers:d,createTaskRating:P,updateTaskRating:J,createStakeholderRating:$,updateStakeholderRating:F,calculateFinalRating:T}=Ve();R.useEffect(()=>{p.length||I(),N.length||V(),i.length||v(),l.length||w(),_.length||y(),h.length||d()},[p.length,N.length,i.length,l.length,_.length,h.length,I,V,v,w,y,d]);const A=W=>{z(W)};return{taskRatings:t,stakeholderRatings:r,finalRatings:n,taskRatingConfigs:p,stakeholderRatingConfigs:N,finalRatingConfigs:i,availableTasks:l,availableProjects:_,availableUsers:h,taskRatingsPagination:o,stakeholderRatingsPagination:b,finalRatingsPagination:c,isLoading:q,error:S,fetchTaskRatings:Y,fetchStakeholderRatings:U,fetchFinalRatings:z,fetchUserFinalRating:Q,createTaskRating:P,updateTaskRating:J,createStakeholderRating:$,updateStakeholderRating:F,calculateFinalRating:T,goToFinalRatingsPage:A,nextFinalRatingsPage:()=>{c&&c.current_page<c.last_page&&A(c.current_page+1)},prevFinalRatingsPage:()=>{c&&c.current_page>1&&A(c.current_page-1)}}},Qe=ke({user_id:_e().min(1,"User is required"),period_start:he().min(1,"Start date is required"),period_end:he().min(1,"End date is required")}),Je=({availableUsers:t,onCalculate:r,isLoading:n})=>{const p=we({resolver:ye(Qe),defaultValues:{user_id:0,period_start:"",period_end:""}}),N=async i=>{const l={period_start:i.period_start,period_end:i.period_end};await r(i.user_id,l)};return e.jsxs(m,{className:"bg-card border-border",children:[e.jsx(u,{children:e.jsxs(f,{className:"text-foreground flex items-center gap-2",children:[e.jsx(B,{className:"w-5 h-5"}),"Calculate Final Rating"]})}),e.jsx(x,{children:e.jsx(Ce,{...p,children:e.jsxs("form",{onSubmit:p.handleSubmit(N),className:"space-y-4",children:[e.jsx(X,{control:p.control,name:"user_id",render:({field:i})=>e.jsxs(Z,{children:[e.jsx(ee,{className:"text-foreground",children:"User"}),e.jsxs(ie,{onValueChange:l=>i.onChange(Number(l)),value:i.value?.toString()||"",disabled:n,children:[e.jsx(se,{children:e.jsx(ce,{className:"bg-background border-input text-foreground",children:e.jsx(de,{placeholder:"Select user to calculate rating for"})})}),e.jsx(oe,{children:t.map(l=>e.jsx(me,{value:l.id.toString(),children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium",children:l.name}),e.jsx("span",{className:"text-xs text-muted-foreground",children:l.email})]})},l.id))})]}),e.jsx(ae,{className:"text-destructive"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(X,{control:p.control,name:"period_start",render:({field:i})=>e.jsxs(Z,{children:[e.jsx(ee,{className:"text-foreground",children:"Period Start"}),e.jsx(se,{children:e.jsx(xe,{type:"date",...i,disabled:n,className:"bg-background border-input text-foreground"})}),e.jsx(ae,{className:"text-destructive"})]})}),e.jsx(X,{control:p.control,name:"period_end",render:({field:i})=>e.jsxs(Z,{children:[e.jsx(ee,{className:"text-foreground",children:"Period End"}),e.jsx(se,{children:e.jsx(xe,{type:"date",...i,disabled:n,className:"bg-background border-input text-foreground"})}),e.jsx(ae,{className:"text-destructive"})]})})]}),e.jsxs(j,{type:"submit",disabled:n,className:"w-full bg-primary text-primary-foreground hover:bg-primary/90",children:[n&&e.jsx(Re,{className:"mr-2 h-4 w-4 animate-spin"}),"Calculate Final Rating"]})]})})})]})},He=({finalRating:t})=>e.jsxs(m,{className:"bg-card border-border",children:[e.jsx(u,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(f,{className:"text-foreground flex items-center gap-2",children:[e.jsx(B,{className:"w-5 h-5 text-purple-500"}),"Final Rating #",t.id]}),e.jsxs(g,{variant:"outline",className:"text-xl px-4 py-2 bg-purple-50 text-purple-700",children:[t.final_rating,"%"]})]})}),e.jsxs(x,{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Oe,{className:"w-10 h-10",children:e.jsx(ze,{className:"bg-primary text-primary-foreground",children:t.user?.name?.charAt(0).toUpperCase()||"U"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-foreground",children:t.user?.name||"Unknown User"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t.user?.email})]})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(je,{className:"w-4 h-4"}),e.jsxs("span",{children:["From: ",new Date(t.period_start).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(je,{className:"w-4 h-4"}),e.jsxs("span",{children:["To: ",new Date(t.period_end).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium text-foreground",children:"Overall Performance"}),e.jsxs("span",{className:"text-xl font-bold text-foreground",children:[t.final_rating,"%"]})]}),e.jsx(Ee,{value:t.final_rating,className:"h-4"})]}),Object.keys(t.variables_used).length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-foreground mb-3 flex items-center gap-2",children:[e.jsx(pe,{className:"w-4 h-4"}),"Variables Used"]}),e.jsx("div",{className:"space-y-2",children:Object.entries(t.variables_used).map(([r,n])=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-foreground",children:r}),e.jsx(g,{variant:"outline",children:n})]},r))})]}),t.calculation_steps.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-foreground mb-3 flex items-center gap-2",children:[e.jsx(Ie,{className:"w-4 h-4"}),"Calculation Steps"]}),e.jsx("div",{className:"space-y-2",children:t.calculation_steps.map((r,n)=>e.jsxs("div",{className:"p-3 bg-accent/20 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm",children:[e.jsxs("span",{className:"text-muted-foreground",children:["Step ",n+1,":"]}),e.jsx("span",{className:"ml-2 font-mono text-foreground",children:r.expression||r.function||r.variable||`${r.model}.${r.column}`})]}),e.jsx(g,{variant:"outline",children:r.result})]}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["Type: ",r.type,r.operation&&` | Operation: ${r.operation}`]})]},n))})]}),e.jsx("div",{className:"pt-4 border-t border-border",children:e.jsx("div",{className:"flex items-center justify-between text-sm text-muted-foreground",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(B,{className:"w-4 h-4"}),e.jsxs("span",{children:["Calculated on ",new Date(t.calculated_at).toLocaleDateString()]})]})})})]})]}),xs=()=>{const[t,r]=R.useState(""),[n,p]=R.useState(""),[N,i]=R.useState(""),[l,_]=R.useState({tasks:[],projects:[]}),{finalRatings:h,finalRatingsPagination:o,availableTasks:b,availableProjects:c,availableUsers:q,isLoading:S,calculateFinalRating:Y,fetchFinalRatings:U,goToFinalRatingsPage:z,nextFinalRatingsPage:Q,prevFinalRatingsPage:I}=Ye(),{hasPermission:V,hasAnyPermission:v}=Se(),w=v(["create task ratings","edit task ratings"]),y=v(["create stakeholder ratings","edit stakeholder ratings"]),d=V("view final ratings"),P=V("calculate final ratings");R.useEffect(()=>{const s=localStorage.getItem("ratings_recently_viewed");s&&_(JSON.parse(s))},[]),R.useEffect(()=>{d&&!h.length&&U(1)},[d,h.length,U]);const J=async(s,a)=>{P&&await Y(s,a)},$=(s,a,L)=>{const D={id:a,name:L,viewedAt:new Date().toISOString()},M={...l};s==="task"?M.tasks=[D,...M.tasks.filter(G=>G.id!==a)].slice(0,5):M.projects=[D,...M.projects.filter(G=>G.id!==a)].slice(0,5),_(M),localStorage.setItem("ratings_recently_viewed",JSON.stringify(M))},F=(s,a)=>{w&&($("task",s,a),window.open(`/ratings/tasks/${s}`,"_blank"))},T=(s,a)=>{y&&($("project",s,a),window.open(`/ratings/projects/${s}/stakeholder`,"_blank"))},A=b.filter(s=>s.name.toLowerCase().includes(t.toLowerCase())||s.description?.toLowerCase().includes(t.toLowerCase())),H=c.filter(s=>s.name.toLowerCase().includes(t.toLowerCase())||s.description?.toLowerCase().includes(t.toLowerCase())),K=d?o?.total||h.length:0,W=d&&h.length>0?h.reduce((s,a)=>s+a.final_rating,0)/h.length:0,Ne=d?h.filter(s=>new Date(s.calculated_at)>new Date(Date.now()-720*60*60*1e3)).length:0,be=()=>{if(!o)return[];const s=[],{current_page:a,last_page:L}=o;a>3&&(s.push(1),a>4&&s.push("ellipsis-start"));for(let D=Math.max(1,a-2);D<=Math.min(L,a+2);D++)s.push(D);return a<L-2&&(a<L-3&&s.push("ellipsis-end"),s.push(L)),s},E=({message:s})=>e.jsx(m,{className:"bg-card border-border",children:e.jsxs(x,{className:"p-6 text-center",children:[e.jsx(Be,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:s})]})});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(O,{className:"w-6 h-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground font-sans",children:"Ratings Center"}),e.jsx("p",{className:"text-muted-foreground",children:"Performance evaluation and rating management system"})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(j,{variant:"outline",disabled:S,onClick:()=>d&&U(1),children:[e.jsx($e,{className:`w-4 h-4 mr-2 ${S?"animate-spin":""}`}),"Refresh"]})})]}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-6",children:[w?e.jsxs(m,{className:"bg-card border-border",children:[e.jsx(u,{children:e.jsxs(f,{className:"text-foreground flex items-center gap-2",children:[e.jsx(k,{className:"w-5 h-5"}),"Task Ratings"]})}),e.jsxs(x,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-foreground",children:"Select Task"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(ie,{value:n,onValueChange:p,children:[e.jsx(ce,{className:"flex-1",children:e.jsx(de,{placeholder:"Choose a task..."})}),e.jsx(oe,{className:"max-h-60",children:A.map(s=>e.jsx(me,{value:s.id.toString(),children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(k,{className:"w-4 h-4 text-primary"}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"font-medium",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(g,{variant:"outline",className:"text-xs",children:s.status}),e.jsxs(g,{variant:"secondary",className:"text-xs",children:["Weight: ",s.weight]})]})]})]})},s.id))})]}),e.jsxs(j,{disabled:!n,onClick:()=>{const s=b.find(a=>a.id.toString()===n);s&&F(s.id,s.name)},className:"bg-primary text-primary-foreground hover:bg-primary/90",children:[e.jsx(O,{className:"w-4 h-4 mr-2"}),"Rate"]})]})]}),l.tasks.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-foreground",children:"Recently Rated"}),e.jsx("div",{className:"space-y-2",children:l.tasks.map(s=>e.jsxs(j,{variant:"outline",size:"sm",className:"w-full justify-between text-left",onClick:()=>F(s.id,s.name),children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(k,{className:"w-4 h-4"}),s.name]}),e.jsx(ue,{className:"w-4 h-4"})]},s.id))})]})]})]}):e.jsx(E,{message:"You don't have permission to create or edit task ratings"}),y?e.jsxs(m,{className:"bg-card border-border",children:[e.jsx(u,{children:e.jsxs(f,{className:"text-foreground flex items-center gap-2",children:[e.jsx(C,{className:"w-5 h-5"}),"Stakeholder Ratings"]})}),e.jsxs(x,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-foreground",children:"Select Project"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(ie,{value:N,onValueChange:i,children:[e.jsx(ce,{className:"flex-1",children:e.jsx(de,{placeholder:"Choose a project..."})}),e.jsx(oe,{className:"max-h-60",children:H.filter(s=>s.stakeholder_will_rate).map(s=>e.jsx(me,{value:s.id.toString(),children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(C,{className:"w-4 h-4 text-primary"}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"font-medium",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(g,{variant:"outline",className:"text-xs",children:s.status}),e.jsxs(g,{variant:"secondary",className:"text-xs",children:[s.progress_percentage,"% complete"]})]})]})]})},s.id))})]}),e.jsxs(j,{disabled:!N,onClick:()=>{const s=c.find(a=>a.id.toString()===N);s&&T(s.id,s.name)},className:"bg-primary text-primary-foreground hover:bg-primary/90",children:[e.jsx(te,{className:"w-4 h-4 mr-2"}),"Rate"]})]})]}),l.projects.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-foreground",children:"Recently Rated"}),e.jsx("div",{className:"space-y-2",children:l.projects.map(s=>e.jsxs(j,{variant:"outline",size:"sm",className:"w-full justify-between text-left",onClick:()=>T(s.id,s.name),children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(C,{className:"w-4 h-4"}),s.name]}),e.jsx(ue,{className:"w-4 h-4"})]},s.id))})]})]})]}):e.jsx(E,{message:"You don't have permission to create or edit stakeholder ratings"}),v(["create task ratings","edit task ratings","create stakeholder ratings","edit stakeholder ratings"])?e.jsxs(m,{className:"bg-card border-border",children:[e.jsx(u,{children:e.jsxs(f,{className:"text-foreground flex items-center gap-2",children:[e.jsx(ge,{className:"w-5 h-5"}),"Quick Search"]})}),e.jsxs(x,{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(xe,{placeholder:"Search tasks or projects...",value:t,onChange:s=>r(s.target.value),className:"pl-10"})]}),t&&e.jsxs("div",{className:"space-y-3 max-h-60 overflow-y-auto",children:[w&&e.jsxs("div",{children:[e.jsx("h6",{className:"text-xs font-medium text-muted-foreground mb-2",children:"TASKS"}),A.slice(0,3).map(s=>e.jsxs(j,{variant:"outline",size:"sm",className:"w-full justify-between text-left mb-2",onClick:()=>F(s.id,s.name),children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(k,{className:"w-4 h-4 text-blue-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-xs",children:s.name}),e.jsx(g,{variant:"secondary",className:"text-xs",children:"Task"})]})]}),e.jsx(O,{className:"w-4 h-4"})]},`task-${s.id}`))]}),y&&e.jsxs("div",{children:[e.jsx("h6",{className:"text-xs font-medium text-muted-foreground mb-2",children:"PROJECTS"}),H.filter(s=>s.stakeholder_will_rate).slice(0,3).map(s=>e.jsxs(j,{variant:"outline",size:"sm",className:"w-full justify-between text-left mb-2",onClick:()=>T(s.id,s.name),children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(C,{className:"w-4 h-4 text-orange-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-xs",children:s.name}),e.jsx(g,{variant:"secondary",className:"text-xs",children:"Project"})]})]}),e.jsx(te,{className:"w-4 h-4"})]},`project-${s.id}`))]})]})]})]}):e.jsx(E,{message:"You don't have permission to rate tasks or stakeholders"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-6",children:[e.jsxs(m,{className:"bg-card border-border",children:[e.jsxs(u,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(f,{className:"text-sm font-medium text-muted-foreground",children:"Total Final Ratings"}),e.jsx(O,{className:"w-4 h-4 text-chart-1"})]}),e.jsx(x,{children:e.jsx("div",{className:"text-2xl font-bold text-foreground",children:d?K:"—"})})]}),e.jsxs(m,{className:"bg-card border-border",children:[e.jsxs(u,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(f,{className:"text-sm font-medium text-muted-foreground",children:"Average Rating"}),e.jsx(pe,{className:"w-4 h-4 text-chart-2"})]}),e.jsx(x,{children:e.jsx("div",{className:"text-2xl font-bold text-foreground",children:d?`${Math.round(W)}%`:"—"})})]}),e.jsxs(m,{className:"bg-card border-border",children:[e.jsxs(u,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(f,{className:"text-sm font-medium text-muted-foreground",children:"Available Tasks"}),e.jsx(k,{className:"w-4 h-4 text-chart-3"})]}),e.jsx(x,{children:e.jsx("div",{className:"text-2xl font-bold text-foreground",children:w?b.length:"—"})})]}),e.jsxs(m,{className:"bg-card border-border",children:[e.jsxs(u,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(f,{className:"text-sm font-medium text-muted-foreground",children:"Available Projects"}),e.jsx(C,{className:"w-4 h-4 text-chart-4"})]}),e.jsx(x,{children:e.jsx("div",{className:"text-2xl font-bold text-foreground",children:y?c.filter(s=>s.stakeholder_will_rate).length:"—"})})]}),e.jsxs(m,{className:"bg-card border-border",children:[e.jsxs(u,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(f,{className:"text-sm font-medium text-muted-foreground",children:"This Month"}),e.jsx(B,{className:"w-4 h-4 text-chart-5"})]}),e.jsx(x,{children:e.jsx("div",{className:"text-2xl font-bold text-foreground",children:d?Ne:"—"})})]})]}),e.jsxs(Pe,{defaultValue:P?"calculate":d?"history":"browse",className:"space-y-4",children:[e.jsxs(Fe,{className:"bg-muted",children:[P&&e.jsx(re,{value:"calculate",children:"Calculate Final Rating"}),d&&e.jsxs(re,{value:"history",children:["Rating History (",K,")"]}),v(["create task ratings","edit task ratings","create stakeholder ratings","edit stakeholder ratings"])&&e.jsx(re,{value:"browse",children:"Browse Ratings"})]}),P&&e.jsx(le,{value:"calculate",children:e.jsx("div",{className:"max-w-2xl",children:e.jsx(Je,{availableUsers:q,onCalculate:J,isLoading:S})})}),d&&e.jsx(le,{value:"history",className:"space-y-6",children:S?e.jsx("div",{className:"space-y-4",children:Array.from({length:3}).map((s,a)=>e.jsx("div",{className:"h-32 bg-muted animate-pulse rounded-lg"},a))}):h.length===0?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-muted-foreground",children:"No final ratings calculated yet"})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:h.map(s=>e.jsx(He,{finalRating:s},s.id))}),o&&o.last_page>1&&e.jsx(m,{className:"bg-card border-border",children:e.jsx(x,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",o.from||0," to ",o.to||0," of ",o.total," results"]}),e.jsx(Te,{children:e.jsxs(Ae,{children:[e.jsx(ne,{children:e.jsx(Le,{onClick:I,className:o.current_page===1?"pointer-events-none opacity-50":"cursor-pointer"})}),be().map((s,a)=>e.jsx(ne,{children:s==="ellipsis-start"||s==="ellipsis-end"?e.jsx(De,{}):e.jsx(Me,{onClick:()=>z(s),isActive:o.current_page===s,className:"cursor-pointer",children:s})},a)),e.jsx(ne,{children:e.jsx(Ue,{onClick:Q,className:o.current_page===o.last_page?"pointer-events-none opacity-50":"cursor-pointer"})})]})})]})})})]})}),v(["create task ratings","edit task ratings","create stakeholder ratings","edit stakeholder ratings"])&&e.jsx(le,{value:"browse",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[w?e.jsxs(m,{className:"bg-card border-border",children:[e.jsx(u,{children:e.jsxs(f,{className:"text-foreground flex items-center gap-2",children:[e.jsx(k,{className:"w-5 h-5"}),"Browse Tasks"]})}),e.jsx(x,{children:e.jsxs("div",{className:"space-y-4",children:[b.slice(0,5).map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 border border-border rounded-lg hover:bg-accent/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(k,{className:"w-5 h-5 text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-foreground",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(g,{variant:"outline",className:"text-xs",children:s.status}),e.jsxs(g,{variant:"secondary",className:"text-xs",children:["Due: ",new Date(s.due_date).toLocaleDateString()]})]})]})]}),e.jsxs(j,{size:"sm",onClick:()=>F(s.id,s.name),children:[e.jsx(O,{className:"w-4 h-4 mr-1"}),"Rate"]})]},s.id)),b.length>5&&e.jsx("div",{className:"text-center pt-4",children:e.jsxs(j,{variant:"outline",size:"sm",children:[e.jsx(fe,{className:"w-4 h-4 mr-2"}),"View All Tasks (",b.length,")"]})})]})})]}):e.jsx(E,{message:"You don't have permission to rate tasks"}),y?e.jsxs(m,{className:"bg-card border-border",children:[e.jsx(u,{children:e.jsxs(f,{className:"text-foreground flex items-center gap-2",children:[e.jsx(C,{className:"w-5 h-5"}),"Browse Projects"]})}),e.jsx(x,{children:e.jsxs("div",{className:"space-y-4",children:[c.filter(s=>s.stakeholder_will_rate).slice(0,5).map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 border border-border rounded-lg hover:bg-accent/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(C,{className:"w-5 h-5 text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-foreground",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(g,{variant:"outline",className:"text-xs",children:s.status}),e.jsxs(g,{variant:"secondary",className:"text-xs",children:[s.progress_percentage,"% complete"]})]})]})]}),e.jsxs(j,{size:"sm",onClick:()=>T(s.id,s.name),children:[e.jsx(te,{className:"w-4 h-4 mr-1"}),"Rate"]})]},s.id)),c.filter(s=>s.stakeholder_will_rate).length>5&&e.jsx("div",{className:"text-center pt-4",children:e.jsxs(j,{variant:"outline",size:"sm",children:[e.jsx(fe,{className:"w-4 h-4 mr-2"}),"View All Projects (",c.filter(s=>s.stakeholder_will_rate).length,")"]})})]})})]}):e.jsx(E,{message:"You don't have permission to rate stakeholders"})]})})]})]})};export{xs as default};
