import{q as A,j as e,D as _,v as B,B as D,w as E,x as m,y as v,aq as w,p as M,I as L,U as I}from"./index-CJetGwO1.js";import{C as x,d as h,a as f,b as g}from"./card-CM5R7BK3.js";import{T as Q,a as V,b as y,c as C}from"./tabs-fCqYbTIt.js";import{u as F}from"./useHelpRequests-D2cxI4tY.js";import{u as $}from"./filtersStore-DwCfmhQz.js";import{T as R,a as X,b as T,c as t,d as z,e as l}from"./table-aLBClH0g.js";import{A as k,a as H}from"./avatar-3aaxr_vA.js";import{B as U}from"./badge-B-I15EGM.js";import{H as G,a as J}from"./HelpRequestRatingBadge-CTCCEHO1.js";import{E as K}from"./ellipsis-DkHXBEp7.js";import{E as O}from"./eye-WaTqYOYn.js";import{S as W}from"./square-pen-CzmLflYk.js";import{U as Y,a as Z}from"./user-x-l5ss9q_Y.js";import{T as ee}from"./trash-2-DLQ2LF8Y.js";import{P as se}from"./plus-BrZxr_o5.js";import{C as re}from"./clock-C0iQwIun.js";import{C as ae}from"./circle-check-big-DdlP2_c4.js";import"./helpRequestsStore-BhCozPDm.js";import"./index-DrKw1nON.js";const q=({helpRequests:a,isLoading:c,onDelete:u,onClaim:N,onUnclaim:b,showActions:j=!0})=>{const{hasPermission:i}=A();return c?e.jsx("div",{className:"space-y-4",children:Array.from({length:5}).map((s,n)=>e.jsx("div",{className:"h-16 bg-muted animate-pulse rounded-lg"},n))}):a.length===0?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-muted-foreground",children:"No help requests found"})}):e.jsx("div",{className:"border border-border rounded-lg bg-card",children:e.jsxs(R,{children:[e.jsx(X,{children:e.jsxs(T,{className:"border-border",children:[e.jsx(t,{className:"text-foreground",children:"Description"}),e.jsx(t,{className:"text-foreground",children:"Task"}),e.jsx(t,{className:"text-foreground",children:"Requester"}),e.jsx(t,{className:"text-foreground",children:"Helper"}),e.jsx(t,{className:"text-foreground",children:"Status"}),e.jsx(t,{className:"text-foreground",children:"Rating"}),e.jsx(t,{className:"text-foreground",children:"Created"}),j&&e.jsx(t,{className:"text-foreground w-[50px]",children:"Actions"})]})}),e.jsx(z,{children:a.map(s=>{const n=i("view help requests"),d=i("edit help requests"),o=i("delete help requests"),p=n||d||o;return e.jsxs(T,{className:"border-border hover:bg-accent/50",children:[e.jsx(l,{children:e.jsx("div",{className:"max-w-xs",children:e.jsx("p",{className:"text-sm font-medium text-foreground line-clamp-2",children:s.description})})}),e.jsx(l,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:s.task?.name||"Unknown Task"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.task?.section?.project?.name||"Unknown Project"})]})}),e.jsx(l,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(k,{className:"w-6 h-6",children:e.jsx(H,{className:"bg-primary text-primary-foreground text-xs",children:s.requester?.name?.charAt(0).toUpperCase()||"U"})}),e.jsx("span",{className:"text-sm text-foreground",children:s.requester?.name||"Unknown User"})]})}),e.jsx(l,{children:s.helper?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(k,{className:"w-6 h-6",children:e.jsx(H,{className:"bg-chart-2 text-white text-xs",children:s.helper.name?.charAt(0).toUpperCase()||"H"})}),e.jsx("span",{className:"text-sm text-foreground",children:s.helper.name})]}):e.jsx(U,{variant:"outline",className:"text-xs",children:"Unassigned"})}),e.jsx(l,{children:e.jsx(G,{helpRequest:s})}),e.jsx(l,{children:s.rating?e.jsx(J,{rating:s.rating,penaltyMultiplier:s.penalty_multiplier}):e.jsx(U,{variant:"outline",className:"text-xs",children:"Not Rated"})}),e.jsx(l,{className:"text-muted-foreground",children:new Date(s.created_at).toLocaleDateString()}),j&&e.jsx(l,{children:p?e.jsxs(_,{children:[e.jsx(B,{asChild:!0,children:e.jsx(D,{variant:"ghost",className:"h-8 w-8 p-0 hover:bg-accent",children:e.jsx(K,{className:"h-4 w-4"})})}),e.jsxs(E,{align:"end",className:"bg-popover border-border",children:[n&&e.jsx(m,{asChild:!0,className:"hover:bg-accent hover:text-accent-foreground",children:e.jsxs(v,{to:`/help-requests/${s.id}`,className:"flex items-center",children:[e.jsx(O,{className:"mr-2 h-4 w-4"}),"View"]})}),d&&e.jsx(m,{asChild:!0,className:"hover:bg-accent hover:text-accent-foreground",children:e.jsxs(v,{to:`/help-requests/${s.id}/edit`,className:"flex items-center",children:[e.jsx(W,{className:"mr-2 h-4 w-4"}),"Edit"]})}),s.is_available&&e.jsxs(m,{onClick:()=>N(s.id),className:"hover:bg-accent hover:text-accent-foreground",children:[e.jsx(Y,{className:"mr-2 h-4 w-4"}),"Claim"]}),s.is_claimed&&!s.is_completed&&e.jsxs(m,{onClick:()=>b(s.id),className:"hover:bg-accent hover:text-accent-foreground",children:[e.jsx(Z,{className:"mr-2 h-4 w-4"}),"Unclaim"]}),o&&e.jsxs(m,{onClick:()=>u(s.id),className:"text-destructive hover:bg-destructive hover:text-destructive-foreground",children:[e.jsx(ee,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]}):e.jsx("span",{className:"text-muted-foreground text-xs",children:"No actions"})})]},s.id)})})]})})},ye=()=>{const{helpRequests:a,availableHelpRequests:c,isLoading:u,deleteHelpRequest:N,claimHelpRequest:b,unclaimHelpRequest:j}=F(),{searchQuery:i,setSearchQuery:s}=$(),{hasPermission:n}=A(),d=async r=>{n("delete help requests")&&window.confirm("Are you sure you want to delete this help request?")&&await N(r)},o=async r=>{await b(r)},p=async r=>{window.confirm("Are you sure you want to unclaim this help request?")&&await j(r)},P=a.filter(r=>r.is_completed).length,S=a.filter(r=>r.is_claimed&&!r.is_completed).length;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(w,{className:"w-6 h-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground font-sans",children:"Help Requests"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage support requests and provide assistance"})]})]}),n("create help requests")&&e.jsx(D,{asChild:!0,className:"bg-primary text-primary-foreground hover:bg-primary/90",children:e.jsxs(v,{to:"/help-requests/create",children:[e.jsx(se,{className:"mr-2 h-4 w-4"}),"Request Help"]})})]}),e.jsx(x,{className:"bg-card border-border",children:e.jsx(h,{className:"p-4",children:e.jsxs("div",{className:"relative max-w-sm",children:[e.jsx(M,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(L,{placeholder:"Search help requests...",value:i,onChange:r=>s(r.target.value),className:"pl-10 bg-background border-input text-foreground"})]})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs(x,{className:"bg-card border-border",children:[e.jsxs(f,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(g,{className:"text-sm font-medium text-muted-foreground",children:"Total Requests"}),e.jsx(w,{className:"w-4 h-4 text-chart-1"})]}),e.jsx(h,{children:e.jsx("div",{className:"text-2xl font-bold text-foreground",children:a.length})})]}),e.jsxs(x,{className:"bg-card border-border",children:[e.jsxs(f,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(g,{className:"text-sm font-medium text-muted-foreground",children:"Available"}),e.jsx(re,{className:"w-4 h-4 text-chart-2"})]}),e.jsx(h,{children:e.jsx("div",{className:"text-2xl font-bold text-foreground",children:c.length})})]}),e.jsxs(x,{className:"bg-card border-border",children:[e.jsxs(f,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(g,{className:"text-sm font-medium text-muted-foreground",children:"In Progress"}),e.jsx(I,{className:"w-4 h-4 text-chart-3"})]}),e.jsx(h,{children:e.jsx("div",{className:"text-2xl font-bold text-foreground",children:S})})]}),e.jsxs(x,{className:"bg-card border-border",children:[e.jsxs(f,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(g,{className:"text-sm font-medium text-muted-foreground",children:"Completed"}),e.jsx(ae,{className:"w-4 h-4 text-chart-4"})]}),e.jsx(h,{children:e.jsx("div",{className:"text-2xl font-bold text-foreground",children:P})})]})]}),e.jsxs(Q,{defaultValue:"all",className:"space-y-4",children:[e.jsxs(V,{className:"bg-muted",children:[e.jsxs(y,{value:"all",children:["All Requests (",a.length,")"]}),e.jsxs(y,{value:"available",children:["Available (",c.length,")"]})]}),e.jsx(C,{value:"all",children:e.jsx(q,{helpRequests:a,isLoading:u,onDelete:d,onClaim:o,onUnclaim:p})}),e.jsx(C,{value:"available",children:e.jsx(q,{helpRequests:c,isLoading:u,onDelete:d,onClaim:o,onUnclaim:p})})]})]})};export{ye as default};
