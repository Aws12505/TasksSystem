import{g as y,h as t,i as f,t as o}from"./index-By6KAy--.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h=[["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M14 2v2",key:"6buw04"}],["path",{d:"M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1",key:"pwadti"}],["path",{d:"M6 2v2",key:"colzsn"}]],w=y("coffee",h);class k{async getInitialData(){return t.get("/clocking/initial-data")}async clockIn(){return t.post("/clocking/clock-in")}async clockOut(){return t.post("/clocking/clock-out")}async startBreak(){return t.post("/clocking/break/start")}async endBreak(s){return t.post("/clocking/break/end",s)}async getRecords(s){return t.getPaginated("/clocking/records",s)}async exportRecords(s){return t.post("/clocking/export",s)}async getManagerInitialData(){return t.get("/clocking/manager/initial-data")}async getAllRecords(s){return t.getPaginated("/clocking/manager/all-records",s)}async exportAllRecords(s){return t.post("/clocking/manager/export-all",s)}}const c=new k,v=f((a,s)=>({session:null,companyTimezone:"UTC",serverTimeUtc:"",records:[],recordsPagination:null,managerSessions:[],managerAllRecords:[],managerAllRecordsPagination:null,isLoading:!1,isExporting:!1,error:null,fetchInitialData:async()=>{try{const e=await c.getInitialData();e.success&&a({session:e.data.session,companyTimezone:e.data.company_timezone,serverTimeUtc:e.data.server_time_utc})}catch(e){console.error("Failed to fetch initial data:",e)}},updateSession:e=>{a({session:e.session,companyTimezone:e.company_timezone,serverTimeUtc:e.server_time_utc})},clockIn:async()=>{a({isLoading:!0,error:null});try{const e=await c.clockIn();e.success&&(o.success(e.message),s().updateSession(e.data))}catch(e){const r=e.response?.data?.message||"Failed to clock in";a({error:r}),o.error(r)}finally{a({isLoading:!1})}},clockOut:async()=>{a({isLoading:!0,error:null});try{const e=await c.clockOut();e.success&&(o.success(e.message),s().updateSession(e.data))}catch(e){const r=e.response?.data?.message||"Failed to clock out";a({error:r}),o.error(r)}finally{a({isLoading:!1})}},startBreak:async()=>{a({isLoading:!0,error:null});try{const e=await c.startBreak();e.success&&(o.success(e.message),s().updateSession(e.data))}catch(e){const r=e.response?.data?.message||"Failed to start break";a({error:r}),o.error(r)}finally{a({isLoading:!1})}},endBreak:async e=>{a({isLoading:!0,error:null});try{const r=await c.endBreak(e?{description:e}:void 0);r.success&&(o.success(r.message),s().updateSession(r.data))}catch(r){const n=r.response?.data?.message||"Failed to end break";a({error:n}),o.error(n)}finally{a({isLoading:!1})}},fetchRecords:async e=>{a({isLoading:!0,error:null});try{const r=await c.getRecords(e);r.success&&a({records:r.data,recordsPagination:r.pagination})}catch(r){const n=r.response?.data?.message||"Failed to fetch records";a({error:n}),o.error(n)}finally{a({isLoading:!1})}},exportRecords:async e=>{a({isExporting:!0});try{const r=await c.exportRecords(e);r.success&&(window.open(r.data.download_url,"_blank"),o.success(r.message))}catch(r){o.error(r.response?.data?.message||"Export failed")}finally{a({isExporting:!1})}},fetchManagerInitialData:async()=>{a({isLoading:!0});try{const e=await c.getManagerInitialData();e.success&&a({managerSessions:e.data.sessions,companyTimezone:e.data.company_timezone,serverTimeUtc:e.data.server_time_utc})}catch(e){console.error("Failed to fetch manager data:",e)}finally{a({isLoading:!1})}},updateManagerSession:(e,r)=>{a(n=>{if(!r.session||r.session.status==="completed")return{managerSessions:n.managerSessions.filter(l=>l.session?.user_id!==e),serverTimeUtc:r.server_time_utc};const d=n.managerSessions.findIndex(l=>l.session?.user_id===e);if(d===-1)return{managerSessions:[...n.managerSessions,r],serverTimeUtc:r.server_time_utc};const i=[...n.managerSessions];return i[d]=r,{managerSessions:i,serverTimeUtc:r.server_time_utc}})},fetchManagerAllRecords:async e=>{a({isLoading:!0});try{const r=await c.getAllRecords(e);r.success&&a({managerAllRecords:r.data,managerAllRecordsPagination:r.pagination})}catch(r){console.error("Failed to fetch all records:",r)}finally{a({isLoading:!1})}},exportManagerRecords:async e=>{a({isExporting:!0});try{const r=await c.exportAllRecords(e);r.success&&(window.open(r.data.download_url,"_blank"),o.success(r.message))}catch(r){o.error(r.response?.data?.message||"Export failed")}finally{a({isExporting:!1})}},clearError:()=>a({error:null})})),p=(a,s)=>{const e=new Date(a).getTime(),r=s?new Date(s).getTime():Date.now();return Math.floor((r-e)/1e3)},S=a=>a.reduce((s,e)=>s+p(e.break_start_utc,e.break_end_utc),0),M=(a,s,e)=>{const r=p(a,s),n=S(e);return Math.max(0,r-n)},x=a=>{const s=Math.floor(a/3600),e=Math.floor(a%3600/60),r=a%60;return`${String(s).padStart(2,"0")}:${String(e).padStart(2,"0")}:${String(r).padStart(2,"0")}`},D=(a,s)=>new Date(a).toLocaleString("en-US",{timeZone:s,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0}),T=({sessionDate:a,companyTimezone:s,utcFallback:e,locale:r="en-US"})=>{const n=a?.trim()??"",d=/^(\d{4})-(\d{2})-(\d{2})$/.exec(n);if(d){const[,i,l,u]=d;if(r==="en-US")return`${{"01":"Jan","02":"Feb","03":"Mar","04":"Apr","05":"May","06":"Jun","07":"Jul","08":"Aug","09":"Sep",10:"Oct",11:"Nov",12:"Dec"}[l]??l} ${parseInt(u,10)}, ${i}`;{const g=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],m=Math.max(1,Math.min(12,parseInt(l,10)))-1;return`${parseInt(u,10)} ${g[m]} ${i}`}}if(e){const i=new Date(e);return new Intl.DateTimeFormat(r,{timeZone:s,year:"numeric",month:"short",day:"numeric",hour12:!0}).format(i)}return n||""};export{w as C,p as a,M as b,D as c,S as d,T as e,x as f,v as u};
