import{v as c,w as u,x as i,Q as g,a5 as p}from"./index-BAxnQz6X.js";class l{async getTickets(r=1,s=15){return c.getPaginated("/tickets",{page:r,per_page:s})}async getTicket(r){return c.get(`/tickets/${r}`)}async createTicket(r){const s=new FormData;return s.append("title",r.title),s.append("description",r.description),s.append("type",r.type),s.append("priority",r.priority),r.assigned_to&&s.append("assigned_to",r.assigned_to.toString()),r.requester_name&&s.append("requester_name",r.requester_name),r.attachments&&r.attachments.forEach(e=>{s.append("attachments[]",e)}),c.postMultipart("/tickets",s)}async updateTicket(r,s){const e=new FormData;return e.append("title",s.title??""),e.append("description",s.description??""),e.append("type",s.type??""),e.append("priority",s.priority??""),s.assigned_to&&e.append("assigned_to",s.assigned_to.toString()),s.requester_name&&e.append("requester_name",s.requester_name),s.attachments&&s.attachments.forEach(t=>{e.append("attachments[]",t)}),c.postMultipart(`/tickets/${r}`,e)}async deleteTicket(r){return c.delete(`/tickets/${r}`)}async getAvailableTickets(r=1,s=15){return c.getPaginated("/tickets/available",{page:r,per_page:s})}async getTicketsByRequester(r,s=1,e=15){return c.getPaginated(`/users/${r}/tickets/requested`,{page:s,per_page:e})}async getTicketsByAssignee(r,s=1,e=15){return c.getPaginated(`/users/${r}/tickets/assigned`,{page:s,per_page:e})}async getTicketsByStatus(r,s=1,e=15){return c.getPaginated(`/tickets/status/${r}`,{page:s,per_page:e})}async getTicketsByType(r,s=1,e=15){return c.getPaginated(`/tickets/type/${r}`,{page:s,per_page:e})}async claimTicket(r){return c.post(`/tickets/${r}/claim`,{})}async assignTicket(r,s){return c.post(`/tickets/${r}/assign/${s}`,{})}async completeTicket(r){return c.post(`/tickets/${r}/complete`,{})}async unassignTicket(r){return c.post(`/tickets/${r}/unassign`,{})}async updateTicketStatus(r,s){return c.post(`/tickets/${r}/status`,s)}static getTicketStatusOptions(){return[{value:"open",label:"Open",color:"red"},{value:"in_progress",label:"In Progress",color:"yellow"},{value:"resolved",label:"Resolved",color:"green"}]}static getTicketTypeOptions(){return[{value:"quick_fix",label:"Quick Fix",estimatedTime:"1-2 hours"},{value:"bug_investigation",label:"Bug Investigation",estimatedTime:"4-8 hours"},{value:"user_support",label:"User Support",estimatedTime:"30 minutes - 2 hours"}]}}const n=new l,k=u((a,r)=>({tickets:[],availableTickets:[],currentTicket:null,availableUsers:[],statusOptions:l.getTicketStatusOptions(),typeOptions:l.getTicketTypeOptions(),pagination:null,availablePagination:null,isLoading:!1,error:null,fetchTickets:async(s=1)=>{a({isLoading:!0,error:null});try{const e=await n.getTickets(s);e.success?a({tickets:e.data,pagination:e.pagination||{current_page:1,total:e.data.length,per_page:15,last_page:1,from:e.data.length>0?1:null,to:e.data.length},isLoading:!1}):(a({error:e.message,isLoading:!1}),i.error(e.message))}catch(e){const t=e.message||"Failed to fetch tickets";a({error:t,isLoading:!1}),i.error(t)}},fetchAvailableTickets:async(s=1)=>{a({isLoading:!0,error:null});try{const e=await n.getAvailableTickets(s);e.success?a({availableTickets:e.data,availablePagination:e.pagination||{current_page:1,total:e.data.length,per_page:15,last_page:1,from:e.data.length>0?1:null,to:e.data.length},isLoading:!1}):(a({error:e.message,isLoading:!1}),i.error(e.message))}catch(e){const t=e.message||"Failed to fetch available tickets";a({error:t,isLoading:!1}),i.error(t)}},fetchTicket:async s=>{a({isLoading:!0,error:null});try{const e=await n.getTicket(s);e.success?a({currentTicket:e.data,isLoading:!1}):(a({error:e.message,isLoading:!1}),i.error(e.message))}catch(e){const t=e.message||"Failed to fetch ticket";a({error:t,isLoading:!1}),i.error(t)}},fetchTicketsByRequester:async(s,e=1)=>{a({isLoading:!0,error:null});try{const t=await n.getTicketsByRequester(s,e);t.success?a({tickets:t.data,pagination:t.pagination||{current_page:1,total:t.data.length,per_page:15,last_page:1,from:t.data.length>0?1:null,to:t.data.length},isLoading:!1}):(a({error:t.message,isLoading:!1}),i.error(t.message))}catch(t){const o=t.message||"Failed to fetch tickets by requester";a({error:o,isLoading:!1}),i.error(o)}},fetchTicketsByAssignee:async(s,e=1)=>{a({isLoading:!0,error:null});try{const t=await n.getTicketsByAssignee(s,e);t.success?a({tickets:t.data,pagination:t.pagination||{current_page:1,total:t.data.length,per_page:15,last_page:1,from:t.data.length>0?1:null,to:t.data.length},isLoading:!1}):(a({error:t.message,isLoading:!1}),i.error(t.message))}catch(t){const o=t.message||"Failed to fetch tickets by assignee";a({error:o,isLoading:!1}),i.error(o)}},fetchTicketsByStatus:async(s,e=1)=>{a({isLoading:!0,error:null});try{const t=await n.getTicketsByStatus(s,e);t.success?a({tickets:t.data,pagination:t.pagination||{current_page:1,total:t.data.length,per_page:15,last_page:1,from:t.data.length>0?1:null,to:t.data.length},isLoading:!1}):(a({error:t.message,isLoading:!1}),i.error(t.message))}catch(t){const o=t.message||"Failed to fetch tickets by status";a({error:o,isLoading:!1}),i.error(o)}},fetchTicketsByType:async(s,e=1)=>{a({isLoading:!0,error:null});try{const t=await n.getTicketsByType(s,e);t.success?a({tickets:t.data,pagination:t.pagination||{current_page:1,total:t.data.length,per_page:15,last_page:1,from:t.data.length>0?1:null,to:t.data.length},isLoading:!1}):(a({error:t.message,isLoading:!1}),i.error(t.message))}catch(t){const o=t.message||"Failed to fetch tickets by type";a({error:o,isLoading:!1}),i.error(o)}},fetchAvailableUsers:async()=>{try{const s=await p.getUsers(1,100);s.success&&a({availableUsers:s.data})}catch(s){console.error("Failed to fetch users:",s)}},createTicket:async s=>{a({isLoading:!0,error:null});try{const e=await n.createTicket(s);if(e.success){a({isLoading:!1}),i.success("Ticket created successfully");const{isAuthenticated:t}=g.getState();return t&&r().fetchTickets(),e.data}else return a({error:e.message,isLoading:!1}),i.error(e.message),null}catch(e){const t=e.message||"Failed to create ticket";return a({error:t,isLoading:!1}),i.error(t),null}},updateTicket:async(s,e)=>{a({isLoading:!0,error:null});try{const t=await n.updateTicket(s,e);return t.success?(a({currentTicket:t.data,isLoading:!1}),i.success("Ticket updated successfully"),r().fetchTickets(),t.data):(a({error:t.message,isLoading:!1}),i.error(t.message),null)}catch(t){const o=t.message||"Failed to update ticket";return a({error:o,isLoading:!1}),i.error(o),null}},updateTicketStatus:async(s,e)=>{try{const t=await n.updateTicketStatus(s,e);return t.success?(i.success("Ticket status updated"),r().currentTicket?.id===s&&a({currentTicket:t.data}),r().fetchTickets(),t.data):(i.error(t.message),null)}catch(t){return i.error(t.message||"Failed to update ticket status"),null}},deleteTicket:async s=>{a({isLoading:!0,error:null});try{const e=await n.deleteTicket(s);return e.success?(a({isLoading:!1}),i.success("Ticket deleted successfully"),r().fetchTickets(),!0):(a({error:e.message,isLoading:!1}),i.error(e.message),!1)}catch(e){const t=e.message||"Failed to delete ticket";return a({error:t,isLoading:!1}),i.error(t),!1}},claimTicket:async s=>{try{const e=await n.claimTicket(s);return e.success?(i.success("Ticket claimed successfully"),r().currentTicket?.id===s&&a({currentTicket:e.data}),r().fetchTickets(),r().fetchAvailableTickets(),e.data):(i.error(e.message),null)}catch(e){return i.error(e.message||"Failed to claim ticket"),null}},assignTicket:async(s,e)=>{try{const t=await n.assignTicket(s,e);return t.success?(i.success("Ticket assigned successfully"),r().currentTicket?.id===s&&a({currentTicket:t.data}),r().fetchTickets(),r().fetchAvailableTickets(),t.data):(i.error(t.message),null)}catch(t){return i.error(t.message||"Failed to assign ticket"),null}},completeTicket:async s=>{try{const e=await n.completeTicket(s);return e.success?(i.success("Ticket completed successfully"),r().currentTicket?.id===s&&a({currentTicket:e.data}),r().fetchTickets(),e.data):(i.error(e.message),null)}catch(e){return i.error(e.message||"Failed to complete ticket"),null}},unassignTicket:async s=>{try{const e=await n.unassignTicket(s);return e.success?(i.success("Ticket unassigned successfully"),r().currentTicket?.id===s&&a({currentTicket:e.data}),r().fetchTickets(),r().fetchAvailableTickets(),e.data):(i.error(e.message),null)}catch(e){return i.error(e.message||"Failed to unassign ticket"),null}},getStatusOptions:()=>l.getTicketStatusOptions(),getTypeOptions:()=>l.getTicketTypeOptions(),clearCurrentTicket:()=>a({currentTicket:null,error:null})}));export{k as u};
