import{h as u,i as c,t as l,O as p,ap as g}from"./index-BpYXyGyg.js";class o{async getHelpRequests(t=1,r=15){return u.getPaginated("/help-requests",{page:t,per_page:r})}async getHelpRequest(t){return u.get(`/help-requests/${t}`)}async createHelpRequest(t){return u.post("/help-requests",t)}async updateHelpRequest(t,r){return u.put(`/help-requests/${t}`,r)}async deleteHelpRequest(t){return u.delete(`/help-requests/${t}`)}async getAvailableHelpRequests(t=1,r=15){return u.getPaginated("/help-requests/available",{page:t,per_page:r})}async getHelpRequestsByTask(t,r=1,e=15){return u.getPaginated(`/tasks/${t}/help-requests`,{page:r,per_page:e})}async getHelpRequestsByRequester(t,r=1,e=15){return u.getPaginated(`/users/${t}/help-requests/requested`,{page:r,per_page:e})}async getHelpRequestsByHelper(t,r=1,e=15){return u.getPaginated(`/users/${t}/help-requests/helping`,{page:r,per_page:e})}async claimHelpRequest(t){return u.post(`/help-requests/${t}/claim`,{})}async assignHelpRequest(t,r){return u.post(`/help-requests/${t}/assign/${r}`,{})}async completeHelpRequest(t,r){return u.post(`/help-requests/${t}/complete`,r)}async unclaimHelpRequest(t){return u.post(`/help-requests/${t}/unclaim`,{})}static getHelpRequestRatingOptions(){return[{value:"legitimate_learning",label:"Legitimate Learning",penalty:.1},{value:"basic_skill_gap",label:"Basic Skill Gap",penalty:.3},{value:"careless_mistake",label:"Careless Mistake",penalty:.6},{value:"fixing_own_mistakes",label:"Fixing Own Mistakes",penalty:.8}]}}const i=new o,d=c((a,t)=>({helpRequests:[],availableHelpRequests:[],currentHelpRequest:null,availableTasks:[],availableUsers:[],ratingOptions:o.getHelpRequestRatingOptions(),pagination:null,availablePagination:null,taskPagination:{},requesterPagination:{},helperPagination:{},isLoading:!1,error:null,fetchHelpRequests:async(r=1)=>{a({isLoading:!0,error:null});try{const e=await i.getHelpRequests(r);e.success?a({helpRequests:e.data,pagination:e.pagination||{current_page:1,total:e.data.length,per_page:15,last_page:1,from:e.data.length>0?1:null,to:e.data.length},isLoading:!1}):(a({error:e.message,isLoading:!1}),l.error(e.message))}catch(e){const s=e.message||"Failed to fetch help requests";a({error:s,isLoading:!1}),l.error(s)}},fetchAvailableHelpRequests:async(r=1)=>{a({isLoading:!0,error:null});try{const e=await i.getAvailableHelpRequests(r);e.success?a({availableHelpRequests:e.data,availablePagination:e.pagination||{current_page:1,total:e.data.length,per_page:15,last_page:1,from:e.data.length>0?1:null,to:e.data.length},isLoading:!1}):(a({error:e.message,isLoading:!1}),l.error(e.message))}catch(e){const s=e.message||"Failed to fetch available help requests";a({error:s,isLoading:!1}),l.error(s)}},fetchHelpRequest:async r=>{a({isLoading:!0,error:null});try{const e=await i.getHelpRequest(r);e.success?a({currentHelpRequest:e.data,isLoading:!1}):(a({error:e.message,isLoading:!1}),l.error(e.message))}catch(e){const s=e.message||"Failed to fetch help request";a({error:s,isLoading:!1}),l.error(s)}},fetchHelpRequestsByTask:async(r,e=1)=>{a({isLoading:!0,error:null});try{const s=await i.getHelpRequestsByTask(r,e);s.success?a(n=>({helpRequests:s.data,taskPagination:{...n.taskPagination,[r]:s.pagination||{current_page:1,total:s.data.length,per_page:15,last_page:1,from:s.data.length>0?1:null,to:s.data.length}},isLoading:!1})):(a({error:s.message,isLoading:!1}),l.error(s.message))}catch(s){const n=s.message||"Failed to fetch help requests for task";a({error:n,isLoading:!1}),l.error(n)}},fetchHelpRequestsByRequester:async(r,e=1)=>{a({isLoading:!0,error:null});try{const s=await i.getHelpRequestsByRequester(r,e);s.success?a(n=>({helpRequests:s.data,requesterPagination:{...n.requesterPagination,[r]:s.pagination||{current_page:1,total:s.data.length,per_page:15,last_page:1,from:s.data.length>0?1:null,to:s.data.length}},isLoading:!1})):(a({error:s.message,isLoading:!1}),l.error(s.message))}catch(s){const n=s.message||"Failed to fetch help requests by requester";a({error:n,isLoading:!1}),l.error(n)}},fetchHelpRequestsByHelper:async(r,e=1)=>{a({isLoading:!0,error:null});try{const s=await i.getHelpRequestsByHelper(r,e);s.success?a(n=>({helpRequests:s.data,helperPagination:{...n.helperPagination,[r]:s.pagination||{current_page:1,total:s.data.length,per_page:15,last_page:1,from:s.data.length>0?1:null,to:s.data.length}},isLoading:!1})):(a({error:s.message,isLoading:!1}),l.error(s.message))}catch(s){const n=s.message||"Failed to fetch help requests by helper";a({error:n,isLoading:!1}),l.error(n)}},fetchAvailableTasks:async()=>{try{const r=await g.getTasks(1);r.success&&a({availableTasks:r.data})}catch(r){console.error("Failed to fetch tasks:",r)}},fetchAvailableUsers:async()=>{try{const r=await p.getUsers(1,100);r.success&&a({availableUsers:r.data})}catch(r){console.error("Failed to fetch users:",r)}},createHelpRequest:async r=>{a({isLoading:!0,error:null});try{const e=await i.createHelpRequest(r);return e.success?(a({isLoading:!1}),l.success("Help request created successfully"),t().fetchHelpRequests(),e.data):(a({error:e.message,isLoading:!1}),l.error(e.message),null)}catch(e){const s=e.message||"Failed to create help request";return a({error:s,isLoading:!1}),l.error(s),null}},updateHelpRequest:async(r,e)=>{a({isLoading:!0,error:null});try{const s=await i.updateHelpRequest(r,e);return s.success?(a({currentHelpRequest:s.data,isLoading:!1}),l.success("Help request updated successfully"),t().fetchHelpRequests(),s.data):(a({error:s.message,isLoading:!1}),l.error(s.message),null)}catch(s){const n=s.message||"Failed to update help request";return a({error:n,isLoading:!1}),l.error(n),null}},deleteHelpRequest:async r=>{a({isLoading:!0,error:null});try{const e=await i.deleteHelpRequest(r);return e.success?(a({isLoading:!1}),l.success("Help request deleted successfully"),t().fetchHelpRequests(),!0):(a({error:e.message,isLoading:!1}),l.error(e.message),!1)}catch(e){const s=e.message||"Failed to delete help request";return a({error:s,isLoading:!1}),l.error(s),!1}},claimHelpRequest:async r=>{try{const e=await i.claimHelpRequest(r);return e.success?(l.success("Help request claimed successfully"),t().currentHelpRequest?.id===r&&a({currentHelpRequest:e.data}),t().fetchHelpRequests(),t().fetchAvailableHelpRequests(),e.data):(l.error(e.message),null)}catch(e){return l.error(e.message||"Failed to claim help request"),null}},assignHelpRequest:async(r,e)=>{try{const s=await i.assignHelpRequest(r,e);return s.success?(l.success("Help request assigned successfully"),t().currentHelpRequest?.id===r&&a({currentHelpRequest:s.data}),t().fetchHelpRequests(),t().fetchAvailableHelpRequests(),s.data):(l.error(s.message),null)}catch(s){return l.error(s.message||"Failed to assign help request"),null}},completeHelpRequest:async(r,e)=>{try{const s=await i.completeHelpRequest(r,e);return s.success?(l.success("Help request completed successfully"),t().currentHelpRequest?.id===r&&a({currentHelpRequest:s.data}),t().fetchHelpRequests(),s.data):(l.error(s.message),null)}catch(s){return l.error(s.message||"Failed to complete help request"),null}},unclaimHelpRequest:async r=>{try{const e=await i.unclaimHelpRequest(r);return e.success?(l.success("Help request unclaimed successfully"),t().currentHelpRequest?.id===r&&a({currentHelpRequest:e.data}),t().fetchHelpRequests(),t().fetchAvailableHelpRequests(),e.data):(l.error(e.message),null)}catch(e){return l.error(e.message||"Failed to unclaim help request"),null}},getRatingOptions:()=>o.getHelpRequestRatingOptions(),clearCurrentHelpRequest:()=>a({currentHelpRequest:null,error:null})}));export{d as u};
