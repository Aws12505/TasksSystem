import{h as ge,k as he,t as o,ak as pe,r as _,j as e,U as je,B as h,K as J,M as W,N as ee,O as se,P as M,I as E,al as fe,a as be,b as Ne,o as ae,F as ve,c as A,d as L,e as F,f as U,g as B,Q as ke,L as ye,a6 as Se,am as te,s as T,an as we,p as re,D as Ce,q as _e,v as Pe,w as Y,y as Te,S as V,x as O,n as De}from"./index-aIDF15FF.js";import{C as S,a as H,b as K,d as w}from"./card-DegwiSso.js";import{B as D}from"./badge-D7aLlcYV.js";import{s as P,u as Ae}from"./subtaskService-wilrK-a3.js";import{a as ne,T as Le}from"./TaskPriorityBadge-DPJldwh7.js";import{A as Fe,a as Ue}from"./avatar-Dx134Ua-.js";import{P as ie}from"./plus-DsrYCZRf.js";import{C as le}from"./checkbox-B2YSeOWn.js";import{P as Me,a as ze,b as R,c as Be,d as Ee,e as qe,f as $e}from"./pagination-B4XyrHhv.js";import{A as Ie,a as Ve,b as Oe,c as Re,d as He,e as Ke,f as Qe,g as Xe}from"./alert-dialog-ds1JXdri.js";import{L as Ye}from"./list-xt-7shSL.js";import{C as ce}from"./calendar-71jRTDor.js";import{E as Ze}from"./ellipsis-DsHtDR5U.js";import{S as de}from"./square-pen-B8hD18R8.js";import{T as Ge}from"./trash-2-CAuoNeFC.js";import{A as Z}from"./arrow-left-Bs_v8bmx.js";import"./index-CT1d_Ntm.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Je=[["circle",{cx:"12",cy:"5",r:"3",key:"rqqgnr"}],["path",{d:"M6.5 8a2 2 0 0 0-1.905 1.46L2.1 18.5A2 2 0 0 0 4 21h16a2 2 0 0 0 1.925-2.54L19.4 9.5A2 2 0 0 0 17.48 8Z",key:"56o5sh"}]],We=ge("weight",Je),es=he((a,r)=>({subtasks:[],currentSubtask:null,pagination:null,taskPagination:{},currentTaskId:null,isLoading:!1,error:null,fetchSubtasksByTask:async(i,t=1)=>{a({isLoading:!0,error:null,currentTaskId:i});try{const s=await P.getSubtasksByTask(i,t);s.success?a(c=>({subtasks:s.data,taskPagination:{...c.taskPagination,[i]:s.pagination||{current_page:1,total:s.data.length,per_page:15,last_page:1,from:s.data.length>0?1:null,to:s.data.length}},pagination:s.pagination||{current_page:1,total:s.data.length,per_page:15,last_page:1,from:s.data.length>0?1:null,to:s.data.length},isLoading:!1})):(a({error:s.message,isLoading:!1}),o.error(s.message))}catch(s){const c=s.message||"Failed to fetch subtasks";a({error:c,isLoading:!1}),o.error(c)}},fetchSubtask:async i=>{a({isLoading:!0,error:null});try{const t=await P.getSubtask(i);t.success?a({currentSubtask:t.data,isLoading:!1}):(a({error:t.message,isLoading:!1}),o.error(t.message))}catch(t){const s=t.message||"Failed to fetch subtask";a({error:s,isLoading:!1}),o.error(s)}},createSubtask:async i=>{a({isLoading:!0,error:null});try{const t=await P.createSubtask(i);return t.success?(a({isLoading:!1}),o.success("Subtask created successfully"),r().fetchSubtasksByTask(i.task_id),t.data):(a({error:t.message,isLoading:!1}),o.error(t.message),null)}catch(t){const s=t.message||"Failed to create subtask";return a({error:s,isLoading:!1}),o.error(s),null}},updateSubtask:async(i,t)=>{a({isLoading:!0,error:null});try{const s=await P.updateSubtask(i,t);return s.success?(a({currentSubtask:s.data,isLoading:!1}),o.success("Subtask updated successfully"),t.task_id&&r().fetchSubtasksByTask(t.task_id),s.data):(a({error:s.message,isLoading:!1}),o.error(s.message),null)}catch(s){const c=s.message||"Failed to update subtask";return a({error:c,isLoading:!1}),o.error(c),null}},updateTaskStatus:async(i,t)=>{try{const s=await pe.updateTaskStatus(i,t);return s.success?(o.success("Task status updated"),s.data):(o.error(s.message),null)}catch(s){return o.error(s.message||"Failed to update task status"),null}},deleteSubtask:async i=>{a({isLoading:!0,error:null});try{const t=await P.deleteSubtask(i);return t.success?(a({isLoading:!1}),o.success("Subtask deleted successfully"),!0):(a({error:t.message,isLoading:!1}),o.error(t.message),!1)}catch(t){const s=t.message||"Failed to delete subtask";return a({error:s,isLoading:!1}),o.error(s),!1}},toggleSubtaskCompletion:async i=>{try{const t=await P.toggleSubtaskCompletion(i);return t.success?(o.success("Subtask completion toggled"),a(s=>({subtasks:s.subtasks.map(c=>c.id===i?t.data:c)})),t.data):(o.error(t.message),null)}catch(t){return o.error(t.message||"Failed to toggle subtask completion"),null}},clearCurrentSubtask:()=>a({currentSubtask:null,error:null})})),oe=a=>{const{subtasks:r,pagination:i,taskPagination:t,currentTaskId:s,isLoading:c,error:x,fetchSubtasksByTask:g,createSubtask:l,updateSubtask:b,updateTaskStatus:u,deleteSubtask:y,toggleSubtaskCompletion:p}=es();_.useEffect(()=>{a&&s!==a&&g(a,1)},[a,s,g]);const m=a?t[a]||null:i,N=C=>{a&&g(a,C)};return{subtasks:r,pagination:m,isLoading:c,error:x,fetchSubtasks:C=>g(C),createSubtask:l,updateSubtask:b,updateTaskStatus:u,deleteSubtask:y,toggleCompletion:p,goToPage:N,nextPage:()=>{m&&m.current_page<m.last_page&&N(m.current_page+1)},prevPage:()=>{m&&m.current_page>1&&N(m.current_page-1)}}},ss=({taskWithAssignments:a,availableUsers:r,onAddUser:i,onUpdateAssignment:t,onRemoveUser:s,isLoading:c=!1})=>{const[x,g]=_.useState(!1),[l,b]=_.useState(""),[u,y]=_.useState(10);if(!a)return null;const p=a.assigned_users||[],m=p.map(d=>d.id),N=r.filter(d=>!m.includes(d.id)),j=a.total_assigned_percentage||0,f=100-j,C=async()=>{if(!l||u<=0)return;await i(Number(l),u)&&(b(""),y(10),g(!1))},q=async(d,k)=>{k<=0||k>100||await t(d,k)};return e.jsxs(S,{className:"bg-card border-border",children:[e.jsxs(H,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(K,{className:"text-foreground flex items-center gap-2",children:[e.jsx(je,{className:"w-5 h-5"}),"Task Assignments (",p.length,")"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(D,{variant:"outline",className:"text-xs",children:[j,"% assigned"]}),N.length>0&&e.jsxs(h,{size:"sm",onClick:()=>g(!0),className:"bg-primary text-primary-foreground hover:bg-primary/90",disabled:f<=0,children:[e.jsx(ie,{className:"w-4 h-4 mr-2"}),"Assign User"]})]})]}),e.jsx("div",{className:"w-full bg-muted rounded-full h-2",children:e.jsx("div",{className:"bg-primary h-2 rounded-full transition-all duration-300",style:{width:`${Math.min(j,100)}%`}})})]}),e.jsxs(w,{className:"space-y-4",children:[x&&e.jsxs("div",{className:"p-4 border border-border rounded-lg bg-accent/20",children:[e.jsx("h4",{className:"text-sm font-medium text-foreground mb-3",children:"Assign User to Task"}),e.jsxs("div",{className:"flex items-end gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-xs text-muted-foreground",children:"Select User"}),e.jsxs(J,{value:l,onValueChange:b,children:[e.jsx(W,{className:"bg-background border-input",children:e.jsx(ee,{placeholder:"Choose a user"})}),e.jsx(se,{children:N.map(d=>e.jsx(M,{value:d.id.toString(),children:d.name},d.id))})]})]}),e.jsxs("div",{className:"w-24",children:[e.jsx("label",{className:"text-xs text-muted-foreground",children:"Percentage"}),e.jsx(E,{type:"number",value:u,onChange:d=>y(Number(d.target.value)),min:"1",max:f,className:"bg-background border-input text-foreground"})]}),e.jsx(h,{size:"sm",onClick:C,disabled:!l||u<=0||u>f,className:"bg-primary text-primary-foreground hover:bg-primary/90",children:"Add"}),e.jsx(h,{size:"sm",variant:"outline",onClick:()=>g(!1),children:"Cancel"})]}),f<u&&e.jsxs("p",{className:"text-xs text-destructive mt-2",children:["Only ",f,"% remaining to assign"]})]}),c?e.jsx("div",{className:"space-y-3",children:Array.from({length:3}).map((d,k)=>e.jsx("div",{className:"h-16 bg-muted animate-pulse rounded-lg"},k))}):p.length===0?e.jsx("p",{className:"text-muted-foreground text-center py-8",children:"No users assigned to this task yet."}):p.map(d=>e.jsxs("div",{className:"flex items-center justify-between p-3 border border-border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Fe,{className:"w-8 h-8",children:e.jsx(Ue,{className:"bg-primary text-primary-foreground text-sm",children:d.name.charAt(0).toUpperCase()})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:d.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:d.email})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-20",children:e.jsx(E,{type:"number",value:d.pivot.percentage,onChange:k=>q(d.id,Number(k.target.value)),min:"1",max:"100",className:"text-xs h-8 bg-background border-input text-foreground"})}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"%"}),e.jsx(h,{size:"sm",variant:"ghost",onClick:()=>s(d.id),className:"h-8 w-8 p-0 text-destructive hover:bg-destructive hover:text-destructive-foreground",children:e.jsx(fe,{className:"h-4 w-4"})})]})]},d.id)),e.jsxs("div",{className:"pt-2 border-t border-border",children:[e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Total Assigned:"}),e.jsxs("span",{className:`font-medium ${a.is_fully_assigned?"text-chart-3":j>100?"text-destructive":"text-muted-foreground"}`,children:[j,"%"]})]}),j>100&&e.jsx("p",{className:"text-xs text-destructive mt-1",children:"Task is over-assigned. Please adjust percentages."}),a.is_fully_assigned&&e.jsx("p",{className:"text-xs text-chart-3 mt-1",children:"Task is fully assigned."})]})]})]})},as=ae({name:T().min(1,"Subtask name is required").max(255),description:T().optional(),due_date:T().min(1,"Due date is required"),priority:te(["low","medium","high","critical"]),task_id:we()}),ts=ae({name:T().min(1,"Subtask name is required").max(255),description:T().optional(),due_date:T().min(1,"Due date is required"),priority:te(["low","medium","high","critical"]),is_complete:Se().optional()}),G=({subtask:a,taskId:r,onSubmit:i,onCancel:t,isLoading:s})=>{const c=!!a,x=be({resolver:Ne(c?ts:as),defaultValues:{name:a?.name||"",description:a?.description||"",due_date:a?.due_date?new Date(a.due_date).toISOString().split("T")[0]:"",priority:a?.priority||"medium",is_complete:a?.is_complete||!1,task_id:r}}),g=async l=>{const b={...l,...r&&{task_id:r}};await i(b)};return e.jsx(ve,{...x,children:e.jsxs("form",{onSubmit:x.handleSubmit(g),className:"space-y-4",children:[e.jsx(A,{control:x.control,name:"name",render:({field:l})=>e.jsxs(L,{children:[e.jsx(F,{className:"text-foreground",children:"Subtask Name"}),e.jsx(U,{children:e.jsx(E,{placeholder:"Enter subtask name",...l,disabled:s,className:"bg-background border-input text-foreground"})}),e.jsx(B,{className:"text-destructive"})]})}),e.jsx(A,{control:x.control,name:"description",render:({field:l})=>e.jsxs(L,{children:[e.jsx(F,{className:"text-foreground",children:"Description"}),e.jsx(U,{children:e.jsx(ke,{placeholder:"Enter subtask description (optional)",...l,disabled:s,className:"bg-background border-input text-foreground",rows:2})}),e.jsx(B,{className:"text-destructive"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(A,{control:x.control,name:"due_date",render:({field:l})=>e.jsxs(L,{children:[e.jsx(F,{className:"text-foreground",children:"Due Date"}),e.jsx(U,{children:e.jsx(E,{type:"date",...l,disabled:s,className:"bg-background border-input text-foreground"})}),e.jsx(B,{className:"text-destructive"})]})}),e.jsx(A,{control:x.control,name:"priority",render:({field:l})=>e.jsxs(L,{children:[e.jsx(F,{className:"text-foreground",children:"Priority"}),e.jsxs(J,{onValueChange:l.onChange,defaultValue:l.value,disabled:s,children:[e.jsx(U,{children:e.jsx(W,{className:"bg-background border-input text-foreground",children:e.jsx(ee,{placeholder:"Select priority"})})}),e.jsxs(se,{children:[e.jsx(M,{value:"low",children:"Low"}),e.jsx(M,{value:"medium",children:"Medium"}),e.jsx(M,{value:"high",children:"High"}),e.jsx(M,{value:"critical",children:"Critical"})]})]}),e.jsx(B,{className:"text-destructive"})]})})]}),c&&e.jsx(A,{control:x.control,name:"is_complete",render:({field:l})=>e.jsxs(L,{className:"flex flex-row items-start space-x-3 space-y-0",children:[e.jsx(U,{children:e.jsx(le,{checked:l.value,onCheckedChange:l.onChange,disabled:s})}),e.jsxs("div",{className:"space-y-1 leading-none",children:[e.jsx(F,{className:"text-foreground",children:"Mark as completed"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Check this box if the subtask is completed"})]})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(h,{type:"submit",size:"sm",disabled:s,className:"bg-primary text-primary-foreground hover:bg-primary/90",children:[s&&e.jsx(ye,{className:"mr-2 h-3 w-3 animate-spin"}),c?"Update":"Create"]}),e.jsx(h,{type:"button",variant:"outline",size:"sm",onClick:t,disabled:s,children:"Cancel"})]})]})})},rs=({taskId:a})=>{const{subtasks:r,pagination:i,isLoading:t,createSubtask:s,updateSubtask:c,deleteSubtask:x,toggleCompletion:g,goToPage:l,nextPage:b,prevPage:u}=oe(a),[y,p]=_.useState(!1),[m,N]=_.useState(null),[j,f]=_.useState(null),C=async n=>{await s({...n,task_id:a}),p(!1)},q=async n=>{m&&(await c(m.id,n),N(null))},d=async n=>{f(n)},k=async()=>{j!=null&&(await x(j),f(null))},me=async n=>{await g(n)},{hasPermission:$,hasAnyPermission:ue}=re(),Q=r.filter(n=>n.is_complete).length,X=r.length>0?Math.round(Q/r.length*100):0,xe=()=>{if(!i)return[];const n=[],{current_page:v,last_page:z}=i;v>3&&(n.push(1),v>4&&n.push("ellipsis-start"));for(let I=Math.max(1,v-2);I<=Math.min(z,v+2);I++)n.push(I);return v<z-2&&(v<z-3&&n.push("ellipsis-end"),n.push(z)),n};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs(S,{className:"bg-card border-border",children:[e.jsxs(H,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(K,{className:"text-foreground flex items-center gap-2",children:[e.jsx(Ye,{className:"w-5 h-5"}),"Subtasks (",i?.total||r.length,")"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(D,{variant:"outline",className:"text-xs",children:[Q,"/",i?.total||r.length," completed"]}),e.jsxs(D,{variant:"secondary",className:"text-xs",children:[X,"%"]}),$("create subtasks")&&e.jsxs(h,{size:"sm",onClick:()=>p(!0),className:"bg-primary text-primary-foreground hover:bg-primary/90",children:[e.jsx(ie,{className:"w-4 h-4 mr-2"}),"Add Subtask"]})]})]}),r.length>0&&e.jsx("div",{className:"w-full bg-muted rounded-full h-2",children:e.jsx("div",{className:"bg-chart-3 h-2 rounded-full transition-all duration-300",style:{width:`${X}%`}})})]}),e.jsxs(w,{className:"space-y-4",children:[y&&e.jsxs("div",{className:"p-4 border border-border rounded-lg bg-accent/20",children:[e.jsx("h4",{className:"text-sm font-medium text-foreground mb-3",children:"Create New Subtask"}),e.jsx(G,{taskId:a,onSubmit:C,onCancel:()=>p(!1),isLoading:t})]}),t?e.jsx("div",{className:"space-y-3",children:Array.from({length:3}).map((n,v)=>e.jsx("div",{className:"h-20 bg-muted animate-pulse rounded-lg"},v))}):r.length===0?e.jsx("p",{className:"text-muted-foreground text-center py-8",children:"No subtasks yet. Create your first subtask to break down this task."}):r.map(n=>e.jsx("div",{children:m?.id===n.id?e.jsxs("div",{className:"p-4 border border-border rounded-lg bg-accent/20",children:[e.jsx("h4",{className:"text-sm font-medium text-foreground mb-3",children:"Edit Subtask"}),e.jsx(G,{subtask:m,taskId:a,onSubmit:q,onCancel:()=>N(null),isLoading:t})]}):e.jsxs("div",{className:"flex items-start justify-between p-4 border border-border rounded-lg hover:bg-accent/50 transition-colors",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx(le,{checked:n.is_complete,onCheckedChange:()=>me(n.id),className:"mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:`font-medium text-foreground ${n.is_complete?"line-through text-muted-foreground":""}`,children:n.name}),e.jsx(ne,{priority:n.priority})]}),n.description&&e.jsx("p",{className:`text-sm mt-1 ${n.is_complete?"line-through text-muted-foreground":"text-muted-foreground"}`,children:n.description}),e.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[e.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[e.jsx(ce,{className:"w-3 h-3"}),new Date(n.due_date).toLocaleDateString()]}),n.is_complete&&e.jsx(D,{variant:"outline",className:"text-xs text-chart-3",children:"Completed"})]})]})]}),ue(["edit subtasks","delete subtasks"])&&e.jsxs(Ce,{children:[e.jsx(_e,{asChild:!0,children:e.jsx(h,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:e.jsx(Ze,{className:"h-4 w-4"})})}),e.jsxs(Pe,{align:"end",className:"bg-popover border-border",children:[$("edit subtasks")&&e.jsxs(Y,{onClick:()=>N(n),className:"hover:bg-accent hover:text-accent-foreground",children:[e.jsx(de,{className:"mr-2 h-4 w-4"}),"Edit"]}),$("delete subtasks")&&e.jsxs(Y,{onClick:async()=>{await d(n.id)},className:"text-destructive hover:bg-destructive hover:text-destructive-foreground",children:[e.jsx(Ge,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})]})},n.id))]})]}),i&&i.last_page>1&&e.jsx(S,{className:"bg-card border-border",children:e.jsx(w,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",i.from||0," to ",i.to||0," of ",i.total," results"]}),e.jsx(Me,{children:e.jsxs(ze,{children:[e.jsx(R,{children:e.jsx(Be,{onClick:u,className:i.current_page===1?"pointer-events-none opacity-50":"cursor-pointer"})}),xe().map((n,v)=>e.jsx(R,{children:n==="ellipsis-start"||n==="ellipsis-end"?e.jsx(Ee,{}):e.jsx(qe,{onClick:()=>l(n),isActive:i.current_page===n,className:"cursor-pointer",children:n})},v)),e.jsx(R,{children:e.jsx($e,{onClick:b,className:i.current_page===i.last_page?"pointer-events-none opacity-50":"cursor-pointer"})})]})})]})})}),e.jsx(Ie,{open:j!==null,onOpenChange:n=>!n&&f(null),children:e.jsxs(Ve,{className:"sm:max-w-[480px]",children:[e.jsxs(Oe,{children:[e.jsx(Re,{children:"Delete subtask"}),e.jsx(He,{children:"Are you sure you want to delete this subtask? This action cannot be undone."})]}),e.jsxs(Ke,{children:[e.jsx(Qe,{onClick:()=>f(null),children:"Cancel"}),e.jsx(Xe,{onClick:k,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete"})]})]})})]})},ks=()=>{const{id:a}=Te(),{task:r,taskWithAssignments:i,availableUsers:t,isLoading:s,error:c,addUser:x,updateAssignment:g,removeUser:l}=Ae(a),{updateTaskStatus:b}=oe(),{hasPermission:u,hasAnyPermission:y}=re(),p=async m=>{!r||!u("edit tasks")||await b(r.id,{status:m})};return s?e.jsx("div",{className:"min-h-screen flex flex-col",children:e.jsxs("div",{className:"flex-1 space-y-6 p-4 md:p-6 max-w-full",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(V,{className:"w-6 h-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("div",{className:"h-8 bg-muted animate-pulse rounded w-48"}),e.jsx("div",{className:"h-4 bg-muted animate-pulse rounded w-64 mt-2"})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(h,{variant:"outline",size:"sm",disabled:!0,children:[e.jsx(Z,{className:"mr-2 h-4 w-4"}),"Back to Tasks"]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx(S,{className:"bg-card border-border",children:e.jsx(w,{className:"p-6",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"h-5 bg-muted animate-pulse rounded w-28"}),e.jsx("div",{className:"h-4 bg-muted animate-pulse rounded"}),e.jsx("div",{className:"h-4 bg-muted animate-pulse rounded"}),e.jsx("div",{className:"h-4 bg-muted animate-pulse rounded w-40"})]})})}),e.jsx(S,{className:"bg-card border-border lg:col-span-2",children:e.jsx(w,{className:"p-6",children:e.jsx("div",{className:"h-64 bg-muted animate-pulse rounded"})})})]})]})}):c||!r?e.jsx("div",{className:"min-h-screen flex flex-col",children:e.jsx("div",{className:"flex-1 space-y-6 p-4 md:p-6 max-w-full",children:e.jsx(S,{className:"bg-card border-border",children:e.jsx(w,{className:"p-8 text-center",children:e.jsx("p",{className:"text-destructive",children:c||"Task not found"})})})})}):e.jsx("div",{className:"min-h-screen flex flex-col",children:e.jsxs("div",{className:"flex-1 space-y-6 p-4 md:p-6 max-w-full",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(V,{className:"w-6 h-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground font-sans",children:r.name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Le,{status:r.status}),e.jsx(ne,{priority:r.priority})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[u("view tasks")&&e.jsxs(e.Fragment,{children:[e.jsx(h,{variant:"outline",size:"sm",onClick:()=>p("in_progress"),disabled:r.status==="in_progress"||r.status==="rated"||r.status==="done",children:"Mark In Progress"}),e.jsx(h,{variant:"outline",size:"sm",onClick:()=>p("done"),disabled:r.status==="done"||r.status==="rated",children:"Mark Complete"})]}),u("edit tasks")&&e.jsx(h,{asChild:!0,size:"sm",className:"bg-primary text-primary-foreground hover:bg-primary/90",children:e.jsxs(O,{to:`/tasks/${r.id}/edit`,children:[e.jsx(de,{className:"mr-2 h-4 w-4"}),"Edit Task"]})}),y(["create task ratings","edit task ratings"])&&e.jsx(h,{asChild:!0,variant:"outline",size:"sm",children:e.jsxs(O,{to:`/ratings/tasks/${r.id}`,children:[e.jsx(De,{className:"mr-2 h-4 w-4"}),"Rate Task"]})}),e.jsx(h,{variant:"outline",size:"sm",asChild:!0,children:e.jsxs(O,{to:"/tasks",className:"flex items-center",children:[e.jsx(Z,{className:"mr-2 h-4 w-4"}),"Back to Tasks"]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[e.jsxs(S,{className:"bg-card border-border",children:[e.jsx(H,{children:e.jsxs(K,{className:"text-foreground flex items-center gap-2",children:[e.jsx(V,{className:"w-4 h-4"}),"Task Information"]})}),e.jsxs(w,{className:"space-y-4",children:[r.description&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Description"}),e.jsx("p",{className:"text-foreground",children:r.description})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Section"}),e.jsx("p",{className:"text-sm font-medium text-foreground",children:r.section?.name||"Unknown Section"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Project: ",r.section?.project?.name||"Unknown Project"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Weight"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(We,{className:"w-4 h-4 text-muted-foreground"}),e.jsx(D,{variant:"outline",className:"text-sm",children:r.weight})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Due Date"}),e.jsxs("p",{className:"text-sm text-foreground flex items-center gap-2",children:[e.jsx(ce,{className:"w-4 h-4"}),new Date(r.due_date).toLocaleDateString()]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Subtasks"}),e.jsxs(D,{variant:"secondary",className:"text-sm",children:[r.subtasks?.length||0," subtasks"]})]})]})]}),u("edit tasks")&&e.jsx(ss,{taskWithAssignments:i,availableUsers:t,onAddUser:x,onUpdateAssignment:g,onRemoveUser:l,isLoading:s})]}),e.jsx("div",{className:"lg:col-span-2",children:u("view subtasks")?e.jsx(rs,{taskId:r.id}):e.jsx(S,{className:"bg-card border-border",children:e.jsx(w,{className:"p-6 text-center",children:e.jsx("p",{className:"text-muted-foreground",children:"You don't have permission to view subtasks"})})})})]})]})})};export{ks as default};
