import{h as v,j as e,i as N,k as y,t as u,l as f,r as w,U as C,m as S,S as _,n as D,T as k,I as g,B as p}from"./index-DswDhpz2.js";import{C as n,a as x,d,b as T}from"./card-DHEPJeJJ.js";import{a as R}from"./analyticsService-BApgdT-J.js";import{u as j}from"./filtersStore-CKo-nj-z.js";import{T as F}from"./trending-up-IQt5XO4x.js";import{S as L}from"./search-JJls1o8W.js";import{R as I}from"./refresh-cw-DFTmrAoC.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],O=v("rotate-ccw",A);function h({className:s,...a}){return e.jsx("div",{"data-slot":"skeleton",className:N("bg-accent animate-pulse rounded-md",s),...a})}const E=y(s=>({data:null,isLoading:!1,error:null,fetchDashboardData:async(a,t,o)=>{s({isLoading:!0,error:null});try{const r=await R.getDashboardSummary(a,t,o);r.success?s({data:r.data,isLoading:!1}):(s({error:r.message||"Failed to load dashboard",isLoading:!1}),u.error(r.message||"Failed to load dashboard"))}catch(r){const c=r.message||"Failed to load dashboard data";s({error:c,isLoading:!1}),u.error(c)}}})),M=()=>{const{data:s,isLoading:a,error:t,fetchDashboardData:o}=E(),{dateRange:r}=j(),{user:c,isAuthenticated:i}=f(),l=()=>{!i||!c||o(c?.id,r.start?.toISOString().split("T")[0],r.end?.toISOString().split("T")[0])};return w.useEffect(()=>{l()},[r.start,r.end,c?.id,i]),{data:s,isLoading:a,error:t,refresh:l}},b=(s,a=1)=>{if(s==null)return"0";const t=typeof s=="number"?s:Number(s);return Number.isFinite(t)?t.toFixed(a):"0"},U=({data:s,isLoading:a})=>{if(a)return e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8",children:Array.from({length:6}).map((o,r)=>e.jsxs(n,{className:"bg-card border-border",children:[e.jsxs(x,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(h,{className:"h-4 w-20 bg-muted"}),e.jsx(h,{className:"h-8 w-8 rounded-full bg-muted"})]}),e.jsx(d,{children:e.jsx(h,{className:"h-8 w-16 mb-2 bg-muted"})})]},r))});if(!s)return e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8",children:e.jsx(n,{className:"bg-card border-border",children:e.jsx(d,{className:"p-6",children:e.jsx("p",{className:"text-muted-foreground text-center",children:"No data available"})})})});const t=[{title:"Total Users",value:s.system_metrics?.general_stats?.total_users||0,icon:C,color:"text-chart-1",bgColor:"bg-chart-1/10"},{title:"Active Projects",value:s.project_health?.active_projects||0,icon:S,color:"text-chart-2",bgColor:"bg-chart-2/10"},{title:"Tasks Completed",value:s.system_metrics?.activity_stats?.tasks_completed||0,icon:_,color:"text-chart-3",bgColor:"bg-chart-3/10"},{title:"Average Rating",value:b(s.system_metrics?.quality_stats?.avg_task_rating,1),icon:D,color:"text-chart-4",bgColor:"bg-chart-4/10"},{title:"Tickets Resolved",value:s.system_metrics?.activity_stats?.tickets_resolved||0,icon:k,color:"text-chart-5",bgColor:"bg-chart-5/10"},{title:"Performance Score",value:b(s.user_metrics?.performance_score,0),icon:F,color:"text-primary",bgColor:"bg-primary/10"}];return e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8",children:t.map((o,r)=>{const c=o.icon;return e.jsxs(n,{className:"hover:shadow-md transition-shadow bg-card border-border",children:[e.jsxs(x,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(T,{className:"text-sm font-medium text-muted-foreground",children:o.title}),e.jsx("div",{className:`p-2 rounded-lg ${o.bgColor}`,children:e.jsx(c,{className:`w-4 h-4 ${o.color}`})})]}),e.jsx(d,{children:e.jsx("div",{className:"text-2xl font-bold text-foreground font-sans",children:o.value})})]},r)})})},q=()=>{const{dateRange:s,searchQuery:a,setDateRange:t,setSearchQuery:o,resetFilters:r}=j(),c=l=>{const m=l.target.value?new Date(l.target.value):null;t({start:m,end:s.end})},i=l=>{const m=l.target.value?new Date(l.target.value):null;t({start:s.start,end:m})};return e.jsx(n,{className:"mb-6 bg-card border-border",children:e.jsx(d,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-center",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(L,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(g,{placeholder:"Search activities...",value:a,onChange:l=>o(l.target.value),className:"pl-10 bg-background border-input text-foreground placeholder:text-muted-foreground"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(g,{type:"date",value:s.start?.toISOString().split("T")[0]||"",onChange:c,className:"w-40 bg-background border-input text-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:"to"}),e.jsx(g,{type:"date",value:s.end?.toISOString().split("T")[0]||"",onChange:i,className:"w-40 bg-background border-input text-foreground"}),e.jsxs(p,{variant:"outline",size:"sm",onClick:r,className:"border-border hover:bg-accent hover:text-accent-foreground",children:[e.jsx(O,{className:"w-4 h-4 mr-2"}),"Reset"]})]})]})})})},G=()=>{const{data:s,isLoading:a,error:t,refresh:o}=M(),{user:r}=f();return e.jsx("div",{className:"min-h-screen flex flex-col",children:e.jsxs("div",{className:"flex-1 space-y-6 p-4 md:p-6 max-w-full",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground font-sans",children:"Dashboard"}),e.jsxs("p",{className:"text-muted-foreground mt-1 font-sans",children:["Welcome back, ",r?.name,"! Here's your project overview."]})]}),e.jsxs(p,{variant:"outline",onClick:o,disabled:a,className:"border-border hover:bg-accent hover:text-accent-foreground",children:[e.jsx(I,{className:`mr-2 h-4 w-4 ${a?"animate-spin":""}`}),a?"Loadingâ€¦":"Refresh"]})]}),t&&e.jsx(n,{className:"bg-card border-border",children:e.jsx(d,{className:"p-4",children:e.jsx("p",{className:"text-destructive font-medium",children:t})})}),e.jsx(n,{className:"bg-card border-border",children:e.jsx(d,{className:"p-4 space-y-3",children:e.jsx(q,{})})}),e.jsx(U,{data:s,isLoading:a})]})})};export{G as default};
