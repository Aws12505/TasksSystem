import{D as h,j as e,C as u,c as N,d as g,B as v,L as k,I as T,f as p,K as B,n as E,M as j,J as I}from"./index-C2mTv9p6.js";import{T as $,a as z,b as w,c as C}from"./tabs-vorsszdi.js";import{u as A}from"./useRole-CFG9pYbF.js";import{u as J}from"./useRoles-CSQDhz3F.js";import{R as K}from"./RoleForm-BMVWQjTK.js";import{C as D}from"./checkbox-DNx5T86O.js";import{B as F}from"./badge-C3XWsGTz.js";import{S as O}from"./save-C0UztJpP.js";import{S as Q}from"./search-DC0sxH7L.js";import{A as R}from"./arrow-left-DOeGH-FH.js";import{K as U}from"./key-dh5zDO-H.js";import"./rolesStore-Dp7x0-_X.js";import"./permissionService-Br8zi0dJ.js";import"./filtersStore-_C-2VDOv.js";import"./form-DJDRbeo4.js";import"./label-DwWP9Sxo.js";const H=({role:a,availablePermissions:f,onSave:c,isLoading:r=!1})=>{const[i,m]=h.useState(a.permissions?.map(s=>s.name)||[]),[l,o]=h.useState(!1),[t,n]=h.useState("");h.useEffect(()=>{m(a.permissions?.map(s=>s.name)||[])},[a]);const x=(s,d)=>{m(y=>d?[...y,s]:y.filter(L=>L!==s))},S=async()=>{o(!0),await c(a.id,{name:a.name,permissions:i}),o(!1)},b=f.filter(s=>s.name.toLowerCase().includes(t.toLowerCase())),P=JSON.stringify(i.sort())!==JSON.stringify(a.permissions?.map(s=>s.name).sort()||[]);return e.jsxs(u,{className:"bg-card border-border",children:[e.jsxs(N,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(g,{className:"text-foreground",children:"Role Permissions"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(F,{variant:"outline",className:"text-xs",children:[i.length," selected"]}),P&&e.jsxs(v,{size:"sm",onClick:S,disabled:l,className:"bg-primary text-primary-foreground hover:bg-primary/90",children:[l&&e.jsx(k,{className:"mr-2 h-3 w-3 animate-spin"}),e.jsx(O,{className:"mr-1 h-3 w-3"}),"Save"]})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Q,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(T,{placeholder:"Search permissions...",value:t,onChange:s=>n(s.target.value),className:"pl-10 bg-background border-input text-foreground"})]})]}),e.jsx(p,{children:r?e.jsx("div",{className:"space-y-3",children:Array.from({length:5}).map((s,d)=>e.jsx("div",{className:"h-6 bg-muted animate-pulse rounded"},d))}):e.jsxs("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:[b.map(s=>e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(D,{id:`permission-${s.id}`,checked:i.includes(s.name),onCheckedChange:d=>x(s.name,d),disabled:l}),e.jsx("label",{htmlFor:`permission-${s.id}`,className:"text-sm text-foreground cursor-pointer flex-1",children:s.name})]},s.id)),b.length===0&&e.jsx("p",{className:"text-muted-foreground text-sm",children:t?"No permissions found matching your search":"No permissions available"})]})})]})},ne=()=>{const{id:a}=B(),f=E(),{updateRole:c}=J(),{role:r,availablePermissions:i,isLoading:m,error:l}=A(a),o=async n=>{if(!r)return;await c(r.id,n)&&f(`/roles/${r.id}`)},t=async(n,x)=>await c(n,x);return m?e.jsx("div",{className:"min-h-screen flex flex-col",children:e.jsxs("div",{className:"flex-1 space-y-6 p-4 md:p-6 max-w-full",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(j,{className:"w-6 h-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("div",{className:"h-8 bg-muted animate-pulse rounded w-48"}),e.jsx("div",{className:"h-4 bg-muted animate-pulse rounded w-64 mt-2"})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(v,{variant:"outline",size:"sm",disabled:!0,children:[e.jsx(R,{className:"mr-2 h-4 w-4"}),"Back to Role"]})})]}),e.jsxs(u,{className:"bg-card border-border",children:[e.jsx(N,{children:e.jsx(g,{className:"text-foreground",children:"Role Information"})}),e.jsx(p,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"h-10 bg-muted animate-pulse rounded"}),e.jsx("div",{className:"h-10 bg-muted animate-pulse rounded"}),e.jsx("div",{className:"h-24 bg-muted animate-pulse rounded"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"h-10 bg-muted animate-pulse rounded w-32"}),e.jsx("div",{className:"h-10 bg-muted animate-pulse rounded w-24"})]})]})})]})]})}):l||!r?e.jsx("div",{className:"min-h-screen flex flex-col",children:e.jsx("div",{className:"flex-1 space-y-6 p-4 md:p-6 max-w-full",children:e.jsx(u,{className:"bg-card border-border",children:e.jsx(p,{className:"p-8 text-center",children:e.jsx("p",{className:"text-destructive",children:l||"Role not found"})})})})}):e.jsx("div",{className:"min-h-screen flex flex-col",children:e.jsxs("div",{className:"flex-1 space-y-6 p-4 md:p-6 max-w-full",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(j,{className:"w-6 h-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground font-sans",children:"Edit Role"}),e.jsxs("p",{className:"text-muted-foreground",children:["Update ",r.name," and its permissions"]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(v,{variant:"outline",size:"sm",asChild:!0,children:e.jsxs(I,{to:`/roles/${a}`,className:"flex items-center",children:[e.jsx(R,{className:"mr-2 h-4 w-4"}),"Back to Role"]})})})]}),e.jsxs($,{defaultValue:"details",className:"space-y-6",children:[e.jsxs(z,{className:"bg-muted",children:[e.jsxs(w,{value:"details",className:"flex items-center gap-2",children:[e.jsx(j,{className:"w-4 h-4"}),"Role Details"]}),e.jsxs(w,{value:"permissions",className:"flex items-center gap-2",children:[e.jsx(U,{className:"w-4 h-4"}),"Permissions"]})]}),e.jsx(C,{value:"details",children:e.jsxs(u,{className:"bg-card border-border",children:[e.jsx(N,{children:e.jsx(g,{className:"text-foreground",children:"Role Information"})}),e.jsx(p,{children:e.jsx(K,{role:r,onSubmit:o,isLoading:!1})})]})}),e.jsx(C,{value:"permissions",children:e.jsx(H,{role:r,availablePermissions:i,onSave:t,isLoading:!1})})]})]})})};export{ne as default};
