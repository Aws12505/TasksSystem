import{j as e,D as _,q,B as D,v as B,w as c,x as g,an as v,p as M,I as P,U as E}from"./index-Bm-EtB5S.js";import{C as i,d,a as x,b as h}from"./card-AVhO3b2r.js";import{T as L,a as I,b as w,c as y}from"./tabs-BSin3JKZ.js";import{u as Q}from"./useHelpRequests-pnypGEWk.js";import{u as F}from"./filtersStore-C_9sbj5T.js";import{T as V,a as $,b as C,c as t,d as R,e as l}from"./table-C6ju7_t3.js";import{A as T,a as k}from"./avatar-CT6WevJD.js";import{B as H}from"./badge-CeiX6K4U.js";import{H as X,a as z}from"./HelpRequestRatingBadge-Wz4opcQa.js";import{E as G}from"./ellipsis-B3m5u0Mw.js";import{E as J}from"./eye-CT2TLSjo.js";import{S as K}from"./square-pen-DiL2gMIn.js";import{U as O,a as W}from"./user-x-Q3zYIH2d.js";import{T as Y}from"./trash-2-DM568cRP.js";import{P as Z}from"./plus-ClvejrOn.js";import{C as ee}from"./clock-bM7qbJXl.js";import{C as se}from"./circle-check-big-BxEeinY3.js";import"./helpRequestsStore-D2O53TCn.js";import"./index-CZG2v3aK.js";const U=({helpRequests:r,isLoading:n,onDelete:o,onClaim:u,onUnclaim:j,showActions:m=!0})=>n?e.jsx("div",{className:"space-y-4",children:Array.from({length:5}).map((s,f)=>e.jsx("div",{className:"h-16 bg-muted animate-pulse rounded-lg"},f))}):r.length===0?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-muted-foreground",children:"No help requests found"})}):e.jsx("div",{className:"border border-border rounded-lg bg-card",children:e.jsxs(V,{children:[e.jsx($,{children:e.jsxs(C,{className:"border-border",children:[e.jsx(t,{className:"text-foreground",children:"Description"}),e.jsx(t,{className:"text-foreground",children:"Task"}),e.jsx(t,{className:"text-foreground",children:"Requester"}),e.jsx(t,{className:"text-foreground",children:"Helper"}),e.jsx(t,{className:"text-foreground",children:"Status"}),e.jsx(t,{className:"text-foreground",children:"Rating"}),e.jsx(t,{className:"text-foreground",children:"Created"}),m&&e.jsx(t,{className:"text-foreground w-[50px]",children:"Actions"})]})}),e.jsx(R,{children:r.map(s=>e.jsxs(C,{className:"border-border hover:bg-accent/50",children:[e.jsx(l,{children:e.jsx("div",{className:"max-w-xs",children:e.jsx("p",{className:"text-sm font-medium text-foreground line-clamp-2",children:s.description})})}),e.jsx(l,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:s.task?.name||"Unknown Task"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.task?.section?.project?.name||"Unknown Project"})]})}),e.jsx(l,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(T,{className:"w-6 h-6",children:e.jsx(k,{className:"bg-primary text-primary-foreground text-xs",children:s.requester?.name?.charAt(0).toUpperCase()||"U"})}),e.jsx("span",{className:"text-sm text-foreground",children:s.requester?.name||"Unknown User"})]})}),e.jsx(l,{children:s.helper?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(T,{className:"w-6 h-6",children:e.jsx(k,{className:"bg-chart-2 text-white text-xs",children:s.helper.name?.charAt(0).toUpperCase()||"H"})}),e.jsx("span",{className:"text-sm text-foreground",children:s.helper.name})]}):e.jsx(H,{variant:"outline",className:"text-xs",children:"Unassigned"})}),e.jsx(l,{children:e.jsx(X,{helpRequest:s})}),e.jsx(l,{children:s.rating?e.jsx(z,{rating:s.rating,penaltyMultiplier:s.penalty_multiplier}):e.jsx(H,{variant:"outline",className:"text-xs",children:"Not Rated"})}),e.jsx(l,{className:"text-muted-foreground",children:new Date(s.created_at).toLocaleDateString()}),m&&e.jsx(l,{children:e.jsxs(_,{children:[e.jsx(q,{asChild:!0,children:e.jsx(D,{variant:"ghost",className:"h-8 w-8 p-0 hover:bg-accent",children:e.jsx(G,{className:"h-4 w-4"})})}),e.jsxs(B,{align:"end",className:"bg-popover border-border",children:[e.jsx(c,{asChild:!0,className:"hover:bg-accent hover:text-accent-foreground",children:e.jsxs(g,{to:`/help-requests/${s.id}`,className:"flex items-center",children:[e.jsx(J,{className:"mr-2 h-4 w-4"}),"View"]})}),e.jsx(c,{asChild:!0,className:"hover:bg-accent hover:text-accent-foreground",children:e.jsxs(g,{to:`/help-requests/${s.id}/edit`,className:"flex items-center",children:[e.jsx(K,{className:"mr-2 h-4 w-4"}),"Edit"]})}),s.is_available&&e.jsxs(c,{onClick:()=>u(s.id),className:"hover:bg-accent hover:text-accent-foreground",children:[e.jsx(O,{className:"mr-2 h-4 w-4"}),"Claim"]}),s.is_claimed&&!s.is_completed&&e.jsxs(c,{onClick:()=>j(s.id),className:"hover:bg-accent hover:text-accent-foreground",children:[e.jsx(W,{className:"mr-2 h-4 w-4"}),"Unclaim"]}),e.jsxs(c,{onClick:()=>o(s.id),className:"text-destructive hover:bg-destructive hover:text-destructive-foreground",children:[e.jsx(Y,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})})]},s.id))})]})}),ve=()=>{const{helpRequests:r,availableHelpRequests:n,isLoading:o,deleteHelpRequest:u,claimHelpRequest:j,unclaimHelpRequest:m}=Q(),{searchQuery:s,setSearchQuery:f}=F(),p=async a=>{window.confirm("Are you sure you want to delete this help request?")&&await u(a)},N=async a=>{await j(a)},b=async a=>{window.confirm("Are you sure you want to unclaim this help request?")&&await m(a)},A=r.filter(a=>a.is_completed).length,S=r.filter(a=>a.is_claimed&&!a.is_completed).length;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(v,{className:"w-6 h-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground font-sans",children:"Help Requests"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage support requests and provide assistance"})]})]}),e.jsx(D,{asChild:!0,className:"bg-primary text-primary-foreground hover:bg-primary/90",children:e.jsxs(g,{to:"/help-requests/create",children:[e.jsx(Z,{className:"mr-2 h-4 w-4"}),"Request Help"]})})]}),e.jsx(i,{className:"bg-card border-border",children:e.jsx(d,{className:"p-4",children:e.jsxs("div",{className:"relative max-w-sm",children:[e.jsx(M,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(P,{placeholder:"Search help requests...",value:s,onChange:a=>f(a.target.value),className:"pl-10 bg-background border-input text-foreground"})]})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs(i,{className:"bg-card border-border",children:[e.jsxs(x,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(h,{className:"text-sm font-medium text-muted-foreground",children:"Total Requests"}),e.jsx(v,{className:"w-4 h-4 text-chart-1"})]}),e.jsx(d,{children:e.jsx("div",{className:"text-2xl font-bold text-foreground",children:r.length})})]}),e.jsxs(i,{className:"bg-card border-border",children:[e.jsxs(x,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(h,{className:"text-sm font-medium text-muted-foreground",children:"Available"}),e.jsx(ee,{className:"w-4 h-4 text-chart-2"})]}),e.jsx(d,{children:e.jsx("div",{className:"text-2xl font-bold text-foreground",children:n.length})})]}),e.jsxs(i,{className:"bg-card border-border",children:[e.jsxs(x,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(h,{className:"text-sm font-medium text-muted-foreground",children:"In Progress"}),e.jsx(E,{className:"w-4 h-4 text-chart-3"})]}),e.jsx(d,{children:e.jsx("div",{className:"text-2xl font-bold text-foreground",children:S})})]}),e.jsxs(i,{className:"bg-card border-border",children:[e.jsxs(x,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(h,{className:"text-sm font-medium text-muted-foreground",children:"Completed"}),e.jsx(se,{className:"w-4 h-4 text-chart-4"})]}),e.jsx(d,{children:e.jsx("div",{className:"text-2xl font-bold text-foreground",children:A})})]})]}),e.jsxs(L,{defaultValue:"all",className:"space-y-4",children:[e.jsxs(I,{className:"bg-muted",children:[e.jsxs(w,{value:"all",children:["All Requests (",r.length,")"]}),e.jsxs(w,{value:"available",children:["Available (",n.length,")"]})]}),e.jsx(y,{value:"all",children:e.jsx(U,{helpRequests:r,isLoading:o,onDelete:p,onClaim:N,onUnclaim:b})}),e.jsx(y,{value:"available",children:e.jsx(U,{helpRequests:n,isLoading:o,onDelete:p,onClaim:N,onUnclaim:b})})]})]})};export{ve as default};
