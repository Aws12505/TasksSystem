import{p as _,j as e,A as V,q as L,v as R,D as B,w as H,B as T,x as U,y as h,z as j,M as $,R as K,m as u,I as O,N as Q,O as q,P as z,Q as G,V as g}from"./index-DswDhpz2.js";import{C as c,d as i,a as v,b as w}from"./card-DHEPJeJJ.js";import{P as J,a as W,b as k,c as X,d as Y,e as Z,f as ee}from"./pagination-CC2foofY.js";import{A as se,a as re,b as ae,c as te,d as le,e as ne,f as ce,g as ie}from"./alert-dialog-CiQ5mFiM.js";import{u as oe}from"./useProjects-CodIKQx2.js";import{u as de}from"./filtersStore-CKo-nj-z.js";import{T as xe,a as me,b as S,c as d,d as he,e as x}from"./table-Cg8n6fLm.js";import{P as ue}from"./progress-bJXybPhr.js";import{P as ge,K as je}from"./ProjectStatusBadge-C1qbbh-t.js";import{E as pe}from"./ellipsis-HHEpgaFa.js";import{E as fe}from"./eye-CBRvwtnZ.js";import{S as Ne}from"./square-pen-DQqsBbkZ.js";import{T as be}from"./trash-2-JR_tJt8Y.js";import{P as ve}from"./plus-CCocBn2e.js";import{S as we}from"./search-JJls1o8W.js";import"./badge-DzLjXeAx.js";const ye=({projects:t,isLoading:a,onDelete:y})=>{const{hasPermission:o}=_();return a?e.jsx("div",{className:"space-y-4",children:Array.from({length:5}).map((r,n)=>e.jsx("div",{className:"h-16 bg-muted animate-pulse rounded-lg"},n))}):t.length===0?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-muted-foreground",children:"No projects found"})}):e.jsx("div",{className:"border border-border rounded-lg bg-card",children:e.jsxs(xe,{children:[e.jsx(me,{children:e.jsxs(S,{className:"border-border",children:[e.jsx(d,{className:"text-foreground",children:"Project"}),e.jsx(d,{className:"text-foreground",children:"Stakeholder"}),e.jsx(d,{className:"text-foreground",children:"Status"}),e.jsx(d,{className:"text-foreground",children:"Progress"}),e.jsx(d,{className:"text-foreground",children:"Created"}),e.jsx(d,{className:"text-foreground w-[50px]",children:"Actions"})]})}),e.jsx(he,{children:t.map(r=>{const n=o("view projects"),p=o("edit projects"),f=o("delete projects"),N=o("view analytics"),P=n||p||f||N;return e.jsxs(S,{className:"border-border hover:bg-accent/50",children:[e.jsx(x,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:r.name}),r.description&&e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-1",children:r.description})]})}),e.jsx(x,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(V,{className:"w-6 h-6",children:[typeof r.stakeholder?.avatar_url=="string"&&r.stakeholder?.avatar_url.trim()!==""&&e.jsx(L,{src:r.stakeholder?.avatar_url,alt:r.stakeholder?.name||"User avatar",className:"object-cover"}),e.jsx(R,{className:"bg-primary text-primary-foreground text-xs",children:r.stakeholder?.name?.charAt(0).toUpperCase()||"U"})]}),e.jsx("span",{className:"text-sm text-foreground",children:r.stakeholder?.name||"Unassigned"})]})}),e.jsx(x,{children:e.jsx(ge,{status:r.status})}),e.jsx(x,{className:"w-32",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ue,{value:r.progress_percentage,className:"flex-1"}),e.jsxs("span",{className:"text-xs text-muted-foreground min-w-[3ch]",children:[r.progress_percentage,"%"]})]})}),e.jsx(x,{className:"text-muted-foreground",children:new Date(r.created_at).toLocaleDateString()}),e.jsx(x,{children:P?e.jsxs(B,{children:[e.jsx(H,{asChild:!0,children:e.jsx(T,{variant:"ghost",className:"h-8 w-8 p-0 hover:bg-accent",children:e.jsx(pe,{className:"h-4 w-4"})})}),e.jsxs(U,{align:"end",className:"bg-popover border-border",children:[n&&e.jsx(h,{asChild:!0,className:"hover:bg-accent hover:text-accent-foreground",children:e.jsxs(j,{to:`/projects/${r.id}`,className:"flex items-center",children:[e.jsx(fe,{className:"mr-2 h-4 w-4"}),"View"]})}),N&&e.jsx(h,{asChild:!0,className:"hover:bg-accent hover:text-accent-foreground",children:e.jsxs(j,{to:`/analytics/projects/${r.id}`,className:"flex items-center",children:[e.jsx($,{className:"mr-2 h-4 w-4"}),"Analytics"]})}),n&&e.jsx(h,{asChild:!0,className:"hover:bg-accent hover:text-accent-foreground",children:e.jsxs(j,{to:`/projects/${r.id}/kanban`,className:"flex items-center",children:[e.jsx(je,{className:"mr-2 h-4 w-4"}),"Kanban"]})}),p&&e.jsx(h,{asChild:!0,className:"hover:bg-accent hover:text-accent-foreground",children:e.jsxs(j,{to:`/projects/${r.id}/edit`,className:"flex items-center",children:[e.jsx(Ne,{className:"mr-2 h-4 w-4"}),"Edit"]})}),f&&e.jsxs(h,{onClick:()=>y(r.id),className:"text-destructive hover:bg-destructive hover:text-destructive-foreground",children:[e.jsx(be,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]}):e.jsx("span",{className:"text-muted-foreground text-xs",children:"No actions"})})]},r.id)})})]})})},He=()=>{const{projects:t,pagination:a,isLoading:y,deleteProject:o,goToPage:r,nextPage:n,prevPage:p}=oe(),{searchQuery:f,statusFilter:N,setSearchQuery:P,setStatusFilter:I}=de(),{hasPermission:C}=_(),[D,m]=K.useState(null),M=async s=>{C("delete projects")&&m(s)},E=async()=>{if(!C("delete projects")){m(null);return}D!=null&&(await o(D),m(null))},F=()=>{if(!a)return[];const s=[],{current_page:l,last_page:b}=a;l>3&&(s.push(1),l>4&&s.push("ellipsis-start"));for(let A=Math.max(1,l-2);A<=Math.min(b,l+2);A++)s.push(A);return l<b-2&&(l<b-3&&s.push("ellipsis-end"),s.push(b)),s};return e.jsxs("div",{className:"min-h-screen flex flex-col",children:[e.jsxs("div",{className:"flex-1 space-y-6 p-4 md:p-6 max-w-full",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(u,{className:"w-6 h-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground font-sans",children:"Projects"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your projects and track progress"})]})]}),C("create projects")&&e.jsx(T,{asChild:!0,className:"bg-primary text-primary-foreground hover:bg-primary/90",children:e.jsxs(j,{to:"/projects/create",children:[e.jsx(ve,{className:"mr-2 h-4 w-4"}),"New Project"]})})]}),e.jsx(c,{className:"bg-card border-border",children:e.jsx(i,{className:"p-4 space-y-3",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"relative lg:col-span-2",children:[e.jsx(we,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(O,{placeholder:"Search projectsâ€¦",value:f,onChange:s=>P(s.target.value),className:"pl-10 bg-background border-input text-foreground"})]}),e.jsxs(Q,{value:N,onValueChange:I,children:[e.jsx(q,{children:e.jsx(z,{placeholder:"Filter by status"})}),e.jsxs(G,{children:[e.jsx(g,{value:"all",children:"All Status"}),e.jsx(g,{value:"pending",children:"Pending"}),e.jsx(g,{value:"in_progress",children:"In Progress"}),e.jsx(g,{value:"done",children:"Done"}),e.jsx(g,{value:"rated",children:"Rated"})]})]}),e.jsx("div",{className:"hidden lg:block"})]})})}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs(c,{className:"bg-card border-border",children:[e.jsxs(v,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium text-muted-foreground",children:"Total Projects"}),e.jsx(u,{className:"w-4 h-4 text-chart-1"})]}),e.jsx(i,{children:e.jsx("div",{className:"text-2xl font-bold text-foreground",children:a?.total||t.length||0})})]}),e.jsxs(c,{className:"bg-card border-border",children:[e.jsxs(v,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium text-muted-foreground",children:"In Progress (page)"}),e.jsx(u,{className:"w-4 h-4 text-chart-2"})]}),e.jsx(i,{children:e.jsx("div",{className:"text-2xl font-bold text-foreground",children:t.filter(s=>s.status==="in_progress").length})})]}),e.jsxs(c,{className:"bg-card border-border",children:[e.jsxs(v,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium text-muted-foreground",children:"Completed (page)"}),e.jsx(u,{className:"w-4 h-4 text-chart-3"})]}),e.jsx(i,{children:e.jsx("div",{className:"text-2xl font-bold text-foreground",children:t.filter(s=>s.status==="done").length})})]}),e.jsxs(c,{className:"bg-card border-border",children:[e.jsxs(v,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium text-muted-foreground",children:"Avg Progress (page)"}),e.jsx(u,{className:"w-4 h-4 text-chart-4"})]}),e.jsx(i,{children:e.jsxs("div",{className:"text-2xl font-bold text-foreground",children:[t.length>0?Math.round(t.reduce((s,l)=>s+l.progress_percentage,0)/t.length):0,"%"]})})]})]}),e.jsx(c,{className:"bg-card border-border flex-1 flex flex-col min-h-0",children:e.jsx(i,{className:"p-0 flex-1 flex flex-col min-h-0",children:e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsx(ye,{projects:t,isLoading:y,onDelete:async s=>{await M(s)}})})})}),a&&a.last_page>1&&e.jsx(c,{className:"bg-card border-border",children:e.jsx(i,{className:"p-3",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4",children:[e.jsxs("div",{className:"text-sm text-muted-foreground text-center sm:text-left",children:["Showing ",a.from||0," to ",a.to||0," of ",a.total||0," results"]}),e.jsx(J,{children:e.jsxs(W,{children:[e.jsx(k,{children:e.jsx(X,{onClick:p,className:a.current_page===1?"pointer-events-none opacity-50":"cursor-pointer"})}),F().map((s,l)=>e.jsx(k,{children:s==="ellipsis-start"||s==="ellipsis-end"?e.jsx(Y,{}):e.jsx(Z,{onClick:()=>r(s),isActive:a.current_page===s,className:"cursor-pointer",children:s})},l)),e.jsx(k,{children:e.jsx(ee,{onClick:n,className:a.current_page===a.last_page?"pointer-events-none opacity-50":"cursor-pointer"})})]})})]})})})]}),e.jsx(se,{open:D!==null,onOpenChange:s=>!s&&m(null),children:e.jsxs(re,{className:"sm:max-w-[480px]",children:[e.jsxs(ae,{children:[e.jsx(te,{children:"Delete project"}),e.jsx(le,{children:"Are you sure you want to delete this project? This action cannot be undone."})]}),e.jsxs(ne,{children:[e.jsx(ce,{onClick:()=>m(null),children:"Cancel"}),e.jsx(ie,{onClick:E,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete"})]})]})})]})};export{He as default};
