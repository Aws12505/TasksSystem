import{r as u,j as e,B as N,L as P,p as L,I as k,z as T,C as B,y as E,A}from"./index-C-8X4UdE.js";import{C as v,a as b,b as y,d as C}from"./card-C5R7LjTr.js";import{T as $,a as z,b as j,c as g}from"./tabs-COt602WY.js";import{u as I}from"./useRole-B9nQJF7C.js";import{u as F}from"./useRoles-BRC97KPN.js";import{R as J}from"./RoleForm-C2BRkzfj.js";import{C as K}from"./checkbox-D12p2ruF.js";import{B as O}from"./badge-CdenegGE.js";import{S as Q}from"./save-DzXPd_ps.js";import{A as U}from"./arrow-left-Dv9e9ei1.js";import{K as D}from"./key-SZWtNzC6.js";import"./rolesStore--6tzdaMK.js";import"./permissionService-BKZe_R6t.js";import"./filtersStore-CmTAamXP.js";const H=({role:a,availablePermissions:h,onSave:c,isLoading:r=!1})=>{const[t,n]=u.useState(a.permissions?.map(s=>s.name)||[]),[i,m]=u.useState(!1),[l,o]=u.useState("");u.useEffect(()=>{n(a.permissions?.map(s=>s.name)||[])},[a]);const x=(s,d)=>{n(f=>d?[...f,s]:f.filter(w=>w!==s))},S=async()=>{m(!0),await c(a.id,{name:a.name,permissions:t}),m(!1)},p=h.filter(s=>s.name.toLowerCase().includes(l.toLowerCase())),R=JSON.stringify(t.sort())!==JSON.stringify(a.permissions?.map(s=>s.name).sort()||[]);return e.jsxs(v,{className:"bg-card border-border",children:[e.jsxs(b,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(y,{className:"text-foreground",children:"Role Permissions"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(O,{variant:"outline",className:"text-xs",children:[t.length," selected"]}),R&&e.jsxs(N,{size:"sm",onClick:S,disabled:i,className:"bg-primary text-primary-foreground hover:bg-primary/90",children:[i&&e.jsx(P,{className:"mr-2 h-3 w-3 animate-spin"}),e.jsx(Q,{className:"mr-1 h-3 w-3"}),"Save"]})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(L,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(k,{placeholder:"Search permissions...",value:l,onChange:s=>o(s.target.value),className:"pl-10 bg-background border-input text-foreground"})]})]}),e.jsx(C,{children:r?e.jsx("div",{className:"space-y-3",children:Array.from({length:5}).map((s,d)=>e.jsx("div",{className:"h-6 bg-muted animate-pulse rounded"},d))}):e.jsxs("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:[p.map(s=>e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(K,{id:`permission-${s.id}`,checked:t.includes(s.name),onCheckedChange:d=>x(s.name,d),disabled:i}),e.jsx("label",{htmlFor:`permission-${s.id}`,className:"text-sm text-foreground cursor-pointer flex-1",children:s.name})]},s.id)),p.length===0&&e.jsx("p",{className:"text-muted-foreground text-sm",children:l?"No permissions found matching your search":"No permissions available"})]})})]})},ie=()=>{const{id:a}=T(),h=B(),{updateRole:c}=F(),{role:r,availablePermissions:t,isLoading:n,error:i}=I(a),m=async o=>{if(!r)return;await c(r.id,o)&&h(`/roles/${r.id}`)},l=async(o,x)=>await c(o,x);return n?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"h-8 bg-muted animate-pulse rounded w-48"}),e.jsx("div",{className:"h-96 bg-muted animate-pulse rounded-lg"})]}):i||!r?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-destructive",children:i||"Role not found"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(N,{variant:"outline",size:"sm",asChild:!0,children:e.jsxs(E,{to:`/roles/${a}`,children:[e.jsx(U,{className:"mr-2 h-4 w-4"}),"Back to Role"]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-foreground font-sans",children:"Edit Role"}),e.jsxs("p",{className:"text-muted-foreground",children:["Update ",r.name," and its permissions"]})]})]})}),e.jsxs($,{defaultValue:"details",className:"space-y-6",children:[e.jsxs(z,{className:"bg-muted",children:[e.jsxs(j,{value:"details",className:"flex items-center gap-2",children:[e.jsx(A,{className:"w-4 h-4"}),"Role Details"]}),e.jsxs(j,{value:"permissions",className:"flex items-center gap-2",children:[e.jsx(D,{className:"w-4 h-4"}),"Permissions"]})]}),e.jsx(g,{value:"details",children:e.jsxs(v,{className:"bg-card border-border",children:[e.jsx(b,{children:e.jsx(y,{className:"text-foreground",children:"Role Information"})}),e.jsx(C,{children:e.jsx(J,{role:r,onSubmit:m,isLoading:!1})})]})}),e.jsx(g,{value:"permissions",children:e.jsx(H,{role:r,availablePermissions:t,onSave:l,isLoading:n})})]})]})};export{ie as default};
